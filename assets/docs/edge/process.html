<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Processes &mdash; Nextflow 22.07.1-edge documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Channels" href="channel.html" />
    <link rel="prev" title="Nextflow scripting" href="script.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Nextflow
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getstarted.html">Get started</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic.html">Basic concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="script.html">Nextflow scripting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Processes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#script">Script</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#scripts-a-la-carte">Scripts <cite>à la carte</cite></a></li>
<li class="toctree-l3"><a class="reference internal" href="#conditional-scripts">Conditional scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#template">Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="#shell">Shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="#native-execution">Native execution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#stub">Stub</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inputs">Inputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#input-of-generic-values">Input of generic values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-of-files">Input of files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-input-files">Multiple input files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-input-file-names">Dynamic input file names</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-of-type-path">Input of type ‘path’</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-of-type-stdin">Input of type ‘stdin’</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-of-type-env">Input of type ‘env’</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-of-type-set">Input of type ‘set’</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-of-type-tuple">Input of type ‘tuple’</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-repeaters">Input repeaters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#understand-how-multiple-input-channels-work">Understand how multiple input channels work</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#outputs">Outputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#output-values">Output values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-files">Output files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-output-files">Multiple output files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-output-file-names">Dynamic output file names</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-path">Output path</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-stdout-special-file">Output ‘stdout’ special file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-env">Output ‘env’</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-set-of-values">Output ‘set’ of values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-tuple-of-values">Output ‘tuple’ of values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional-output">Optional Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#when">When</a></li>
<li class="toctree-l2"><a class="reference internal" href="#directives">Directives</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#accelerator">accelerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#afterscript">afterScript</a></li>
<li class="toctree-l3"><a class="reference internal" href="#beforescript">beforeScript</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cache">cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clusteroptions">clusterOptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conda">conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="#container">container</a></li>
<li class="toctree-l3"><a class="reference internal" href="#containeroptions">containerOptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cpus">cpus</a></li>
<li class="toctree-l3"><a class="reference internal" href="#debug">debug</a></li>
<li class="toctree-l3"><a class="reference internal" href="#disk">disk</a></li>
<li class="toctree-l3"><a class="reference internal" href="#echo">echo</a></li>
<li class="toctree-l3"><a class="reference internal" href="#errorstrategy">errorStrategy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#executor">executor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ext">ext</a></li>
<li class="toctree-l3"><a class="reference internal" href="#label">label</a></li>
<li class="toctree-l3"><a class="reference internal" href="#machinetype">machineType</a></li>
<li class="toctree-l3"><a class="reference internal" href="#maxerrors">maxErrors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#maxforks">maxForks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#maxretries">maxRetries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#memory">memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module">module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#penv">penv</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pod">pod</a></li>
<li class="toctree-l3"><a class="reference internal" href="#publishdir">publishDir</a></li>
<li class="toctree-l3"><a class="reference internal" href="#queue">queue</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scratch">scratch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#storedir">storeDir</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stageinmode">stageInMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stageoutmode">stageOutMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tag">tag</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time">time</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-directives">Dynamic directives</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-computing-resources">Dynamic computing resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-retry-with-backoff">Dynamic Retry with backoff</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="channel.html">Channels</a></li>
<li class="toctree-l1"><a class="reference internal" href="operator.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="executor.html">Executors</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="dsl2.html">DSL 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command line interface (CLI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="container.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="conda.html">Conda environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws.html">Amazon Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="amazons3.html">Amazon S3 storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="azure.html">Azure Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="google.html">Google Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="ignite.html">Apache Ignite</a></li>
<li class="toctree-l1"><a class="reference internal" href="kubernetes.html">Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracing.html">Tracing &amp; visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="sharing.html">Pipeline sharing</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Workflow introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="mail.html">Mail &amp; Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="secrets.html">Secrets</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Nextflow</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Processes</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/nextflow-io/nextflow/blob/master/docs/process.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="processes">
<span id="process-page"></span><h1>Processes<a class="headerlink" href="#processes" title="Permalink to this headline"></a></h1>
<p>In Nextflow a <cite>process</cite> is the basic processing <cite>primitive</cite> to execute a user script.</p>
<p>The process definition starts with the keyword <code class="docutils literal notranslate"><span class="pre">process</span></code>, followed by process name and finally the process <cite>body</cite>
delimited by curly brackets. The process body must contain a string which represents the command or, more generally,
a script that is executed by it. A basic process looks like the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">sayHello</span> <span class="p">{</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    echo &#39;Hello world!&#39; &gt; file</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A process may contain five definition blocks, respectively: directives,
inputs, outputs, when clause and finally the process script. The syntax is defined as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="o">&lt;</span> <span class="n">name</span> <span class="o">&gt;</span> <span class="p">{</span>

   <span class="p">[</span> <span class="n">directives</span> <span class="p">]</span>

   <span class="nb">input</span><span class="p">:</span>
    <span class="o">&lt;</span> <span class="n">process</span> <span class="n">inputs</span> <span class="o">&gt;</span>

   <span class="n">output</span><span class="p">:</span>
    <span class="o">&lt;</span> <span class="n">process</span> <span class="n">outputs</span> <span class="o">&gt;</span>

   <span class="n">when</span><span class="p">:</span>
    <span class="o">&lt;</span> <span class="n">condition</span> <span class="o">&gt;</span>

   <span class="p">[</span><span class="n">script</span><span class="o">|</span><span class="n">shell</span><span class="o">|</span><span class="n">exec</span><span class="p">]:</span>
   <span class="o">&lt;</span> <span class="n">user</span> <span class="n">script</span> <span class="n">to</span> <span class="n">be</span> <span class="n">executed</span> <span class="o">&gt;</span>

<span class="p">}</span>
</pre></div>
</div>
<section id="script">
<span id="process-script"></span><h2>Script<a class="headerlink" href="#script" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">script</span></code> block is a string statement that defines the command that is executed by the process to carry out its task.</p>
<p>A process contains one and only one script block, and it must be the last statement when the process contains
input and output declarations.</p>
<p>The entered string is executed as a <a class="reference external" href="http://en.wikipedia.org/wiki/Bash_(Unix_shell)">Bash</a> script in the
<cite>host</cite> system. It can be any command, script or combination of them, that you would normally use in terminal shell
or in a common Bash script.</p>
<p>The only limitation to the commands that can be used in the script statement is given by the availability of those
programs in the target execution system.</p>
<p>The script block can be a simple string or multi-line string. The latter simplifies the writing of non trivial scripts
composed by multiple commands spanning over multiple lines. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">doMoreThings</span> <span class="p">{</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  blastp -db $db -query query.fa -outfmt 6 &gt; blast_result</span>
<span class="sd">  cat blast_result | head -n 10 | cut -f 2 &gt; top_hits</span>
<span class="sd">  blastdbcmd -db $db -entry_batch top_hits &gt; sequences</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As explained in the script tutorial section, strings can be defined by using a single-quote
or a double-quote, and multi-line strings are defined by three single-quote or three double-quote characters.</p>
<p>There is a subtle but important difference between them. Like in Bash, strings delimited by a <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> character support
variable substitutions, while strings delimited by <code class="docutils literal notranslate"><span class="pre">'</span></code> do not.</p>
<p>In the above code fragment the <code class="docutils literal notranslate"><span class="pre">$db</span></code> variable is replaced by the actual value defined somewhere in the
pipeline script.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since Nextflow uses the same Bash syntax for variable substitutions in strings, you must manage them
carefully depending on whether you want to evaluate a <em>Nextflow</em> variable or a <em>Bash</em> variable.</p>
</div>
<p>When you need to access a system environment variable in your script you have two options. The first choice is as
easy as defining your script block by using a single-quote string. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">printPath</span> <span class="p">{</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  echo The path is: $PATH</span>
<span class="sd">  &#39;&#39;&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The drawback of this solution is that you will not able to access variables defined in the pipeline script context,
in your script block.</p>
<p>To fix this, define your script by using a double-quote string and <cite>escape</cite> the system environment variables by
prefixing them with a back-slash <code class="docutils literal notranslate"><span class="pre">\</span></code> character, as shown in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">doOtherThings</span> <span class="p">{</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  blastp -db \$DB -query query.fa -outfmt 6 &gt; blast_result</span>
<span class="sd">  cat blast_result | head -n $MAX | cut -f 2 &gt; top_hits</span>
<span class="sd">  blastdbcmd -db \$DB -entry_batch top_hits &gt; sequences</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this example the <code class="docutils literal notranslate"><span class="pre">$MAX</span></code> variable has to be defined somewhere before, in the pipeline script.
<cite>Nextflow</cite> replaces it with the actual value before executing the script. Instead, the <code class="docutils literal notranslate"><span class="pre">$DB</span></code> variable
must exist in the script execution environment and the Bash interpreter will replace it with the actual value.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Alternatively you can use the <a class="reference internal" href="#process-shell"><span class="std std-ref">Shell</span></a> block definition which allows a script to contain both
Bash and Nextflow variables without having to escape the first.</p>
</div>
<section id="scripts-a-la-carte">
<h3>Scripts <cite>à la carte</cite><a class="headerlink" href="#scripts-a-la-carte" title="Permalink to this headline"></a></h3>
<p>The process script is interpreted by Nextflow as a Bash script by default, but you are not limited to it.</p>
<p>You can use your favourite scripting language (e.g. Perl, Python, Ruby, R, etc), or even mix them in the same pipeline.</p>
<p>A pipeline may be composed by processes that execute very different tasks. Using <cite>Nextflow</cite> you can choose the scripting
language that better fits the task carried out by a specified process. For example for some processes <cite>R</cite> could be
more useful than <cite>Perl</cite>, in other you may need to use <cite>Python</cite> because it provides better access to a library or an API, etc.</p>
<p>To use a scripting other than Bash, simply start your process script with the corresponding
<a class="reference external" href="http://en.wikipedia.org/wiki/Shebang_(Unix)">shebang</a> declaration. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">perlStuff</span> <span class="p">{</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    #!/usr/bin/perl</span>

<span class="sd">    print &#39;Hi there!&#39; . &#39;\n&#39;;</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>

<span class="n">process</span> <span class="n">pythonStuff</span> <span class="p">{</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    #!/usr/bin/python</span>

<span class="sd">    x = &#39;Hello&#39;</span>
<span class="sd">    y = &#39;world!&#39;</span>
<span class="sd">    print &quot;%s - %s&quot; % (x,y)</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Since the actual location of the interpreter binary file can differ across platforms,
it is wise to use the <code class="docutils literal notranslate"><span class="pre">env</span></code> command followed by the interpreter name, e.g.
<code class="docutils literal notranslate"><span class="pre">#!/usr/bin/env</span> <span class="pre">perl</span></code>, instead of the absolute path, in order to make your script
more portable.</p>
</div>
</section>
<section id="conditional-scripts">
<h3>Conditional scripts<a class="headerlink" href="#conditional-scripts" title="Permalink to this headline"></a></h3>
<p>Complex process scripts may need to evaluate conditions on the input parameters or use traditional flow control
statements (i.e. <code class="docutils literal notranslate"><span class="pre">if</span></code>, <code class="docutils literal notranslate"><span class="pre">switch</span></code>, etc) in order to execute specific script commands, depending on the current
inputs configuration.</p>
<p>Process scripts can contain conditional statements by simply prefixing the script block with the keyword <code class="docutils literal notranslate"><span class="pre">script:</span></code>.
By doing that the interpreter will evaluate all the following statements as a code block that must return the
script string to be executed. It’s much easier to use than to explain, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seq_to_align</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;tcoffee&#39;</span>

<span class="n">process</span> <span class="n">align</span> <span class="p">{</span>
    <span class="nb">input</span><span class="p">:</span>
    <span class="n">file</span> <span class="n">seq_to_aln</span> <span class="kn">from</span> <span class="nn">sequences</span>

    <span class="n">script</span><span class="p">:</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;tcoffee&#39;</span> <span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        t_coffee -in $seq_to_aln &gt; out_file</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">else</span> <span class="k">if</span><span class="p">(</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;mafft&#39;</span> <span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        mafft --anysymbol --parttree --quiet $seq_to_aln &gt; out_file</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">else</span> <span class="k">if</span><span class="p">(</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;clustalo&#39;</span> <span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        clustalo -i $seq_to_aln -o out_file</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">else</span>
        <span class="n">error</span> <span class="s2">&quot;Invalid alignment mode: $</span><span class="si">{mode}</span><span class="s2">&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above example the process will execute the script fragment depending on the value of the <code class="docutils literal notranslate"><span class="pre">mode</span></code> parameter.
By default it will execute the <code class="docutils literal notranslate"><span class="pre">tcoffee</span></code> command, changing the <code class="docutils literal notranslate"><span class="pre">mode</span></code> variable to <code class="docutils literal notranslate"><span class="pre">mafft</span></code> or <code class="docutils literal notranslate"><span class="pre">clustalo</span></code> value,
the other branches will be executed.</p>
</section>
<section id="template">
<span id="process-template"></span><h3>Template<a class="headerlink" href="#template" title="Permalink to this headline"></a></h3>
<p>Process script can be externalised by using <em>template</em> files which can be reused across different processes and tested
independently from the overall pipeline execution.</p>
<p>A template is simply a shell script file that Nextflow is able to execute by using the <code class="docutils literal notranslate"><span class="pre">template</span></code> function
as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">template_example</span> <span class="p">{</span>
    <span class="nb">input</span><span class="p">:</span>
    <span class="n">val</span> <span class="n">STR</span> <span class="kn">from</span> <span class="s1">&#39;this&#39;</span><span class="p">,</span> <span class="s1">&#39;that&#39;</span>

    <span class="n">script</span><span class="p">:</span>
    <span class="n">template</span> <span class="s1">&#39;my_script.sh&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Nextflow looks for the <code class="docutils literal notranslate"><span class="pre">my_script.sh</span></code> template file in the directory <code class="docutils literal notranslate"><span class="pre">templates</span></code> that must exist in the same folder
where the Nextflow script file is located (any other location can be provided by using an absolute template path).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using <a class="reference internal" href="dsl2.html#dsl2-page"><span class="std std-ref">DSL2</span></a>, Nextflow also looks in the <code class="docutils literal notranslate"><span class="pre">templates</span></code> directory
located in the same folder as module. See <a class="reference internal" href="dsl2.html#module-templates"><span class="std std-ref">module templates</span></a>.</p>
</div>
<p>The template script can contain any piece of code that can be executed by the underlying system. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
echo &quot;process started at `date`&quot;
echo $STR
:
echo &quot;process completed&quot;
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The dollar character (<code class="docutils literal notranslate"><span class="pre">$</span></code>) is interpreted as a Nextflow variable placeholder when the script is run as a
Nextflow template, whereas it is evaluated as a Bash variable when run as a Bash script. This can be very useful to test
your script autonomously, i.e. independently from Nextflow execution. You only need to provide a Bash environment
variable for each the Nextflow variable existing in your script. For example, it would be possible to execute the above
script with the following command in the terminal: <code class="docutils literal notranslate"><span class="pre">STR='foo'</span> <span class="pre">bash</span> <span class="pre">templates/my_script.sh</span></code></p>
</div>
</section>
<section id="shell">
<span id="process-shell"></span><h3>Shell<a class="headerlink" href="#shell" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">shell</span></code> block is a string statement that defines the <em>shell</em> command executed by the process to carry out its task.
It is an alternative to the <a class="reference internal" href="#process-script"><span class="std std-ref">Script</span></a> definition with an important difference, it uses
the exclamation mark <code class="docutils literal notranslate"><span class="pre">!</span></code> character as the variable placeholder for Nextflow variables in place of the usual dollar character.</p>
<p>In this way it is possible to use both Nextflow and Bash variables in the same piece of code without having to escape
the latter and making process scripts more readable and easy to maintain. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">myTask</span> <span class="p">{</span>
    <span class="nb">input</span><span class="p">:</span>
    <span class="n">val</span> <span class="nb">str</span> <span class="kn">from</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="s1">&#39;Hola&#39;</span><span class="p">,</span> <span class="s1">&#39;Bonjour&#39;</span>

    <span class="n">shell</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    echo User $USER says !{str}</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above trivial example the <code class="docutils literal notranslate"><span class="pre">$USER</span></code> variable is managed by the Bash interpreter, while <code class="docutils literal notranslate"><span class="pre">!{str}</span></code> is handled
as a process input variable managed by Nextflow.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Shell script definitions require the use of single-quote <code class="docutils literal notranslate"><span class="pre">'</span></code> delimited strings. When using double-quote <code class="docutils literal notranslate"><span class="pre">&quot;</span></code>
delimited strings, dollar variables are interpreted as Nextflow variables as usual. See <a class="reference internal" href="script.html#string-interpolation"><span class="std std-ref">String interpolation</span></a>.</p></li>
<li><p>Variables prefixed with <code class="docutils literal notranslate"><span class="pre">!</span></code> must always be enclosed in curly brackets, i.e. <code class="docutils literal notranslate"><span class="pre">!{str}</span></code> is a valid
variable whereas <code class="docutils literal notranslate"><span class="pre">!str</span></code> is ignored.</p></li>
<li><p>Shell scripts support the use of the file <a class="reference internal" href="#process-template"><span class="std std-ref">Template</span></a> mechanism. The same rules are applied to the variables
defined in the script template.</p></li>
</ul>
</div>
</section>
<section id="native-execution">
<span id="process-native"></span><h3>Native execution<a class="headerlink" href="#native-execution" title="Permalink to this headline"></a></h3>
<p>Nextflow processes can execute native code other than system scripts as shown in the previous paragraphs.</p>
<p>This means that instead of specifying the process command to be executed as a string script, you can
define it by providing one or more language statements, as you would do in the rest of the pipeline script.
Simply starting the script definition block with the <code class="docutils literal notranslate"><span class="pre">exec:</span></code> keyword, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="n">process</span> <span class="n">simpleSum</span> <span class="p">{</span>
    <span class="nb">input</span><span class="p">:</span>
    <span class="n">val</span> <span class="n">x</span>

    <span class="n">exec</span><span class="p">:</span>
    <span class="n">println</span> <span class="s2">&quot;Hello Mr. $x&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Will display:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hello</span> <span class="n">Mr</span><span class="o">.</span> <span class="n">b</span>
<span class="n">Hello</span> <span class="n">Mr</span><span class="o">.</span> <span class="n">a</span>
<span class="n">Hello</span> <span class="n">Mr</span><span class="o">.</span> <span class="n">c</span>
</pre></div>
</div>
</section>
</section>
<section id="stub">
<span id="process-stub"></span><h2>Stub<a class="headerlink" href="#stub" title="Permalink to this headline"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This feature is experimental. It may change in future versions.</p>
</div>
<p>As of version 20.11.0-edge it’s possible to define a command <em>stub</em> that replaces the actual process command, when
the <cite>-stub-run</cite> or <cite>-stub</cite> command line option.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">INDEX</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
    <span class="n">path</span> <span class="n">transcriptome</span>

  <span class="n">output</span><span class="p">:</span>
    <span class="n">path</span> <span class="s1">&#39;index&#39;</span>

  <span class="n">script</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    salmon index --threads $task.cpus -t $transcriptome -i index</span>
<span class="sd">    &quot;&quot;&quot;</span>

  <span class="n">stub</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    mkdir index</span>
<span class="sd">    touch index/seq.bin</span>
<span class="sd">    touch index/info.json</span>
<span class="sd">    touch index/refseq.bin</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This feature is meant to allow the fast prototyping and test of the workflow logic without using the real
commands. The developer can use it to provide a dummy command which is expected to mimic the execution
of the real one in a quicker manner. This can also be used as an alternative for the <em>dry-run</em> feature.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <code class="docutils literal notranslate"><span class="pre">stub</span></code> block can be defined before or after the <code class="docutils literal notranslate"><span class="pre">script</span></code> block.
When the pipeline is executed with the <code class="docutils literal notranslate"><span class="pre">-stub-run</span></code> option and a process’s <code class="docutils literal notranslate"><span class="pre">stub</span></code>
is not defined, the <code class="docutils literal notranslate"><span class="pre">script</span></code> block is executed.</p>
</div>
</section>
<section id="inputs">
<span id="process-input"></span><h2>Inputs<a class="headerlink" href="#inputs" title="Permalink to this headline"></a></h2>
<p>Nextflow processes are isolated from each other but can communicate between themselves sending values through channels.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">input</span></code> block defines from which channels the process expects to receive data. You can only define one
input block at a time and it must contain one or more input declarations.</p>
<p>The input block follows the syntax shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">input</span><span class="p">:</span>
  <span class="o">&lt;</span><span class="nb">input</span> <span class="n">qualifier</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">input</span> <span class="n">name</span><span class="o">&gt;</span> <span class="p">[</span><span class="kn">from</span> <span class="o">&lt;</span><span class="n">source</span> <span class="n">channel</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="n">attributes</span><span class="p">]</span>
</pre></div>
</div>
<p>An input definition starts with an input <cite>qualifier</cite> and the input <cite>name</cite>, followed by the keyword <code class="docutils literal notranslate"><span class="pre">from</span></code> and
the actual channel over which inputs are received. Finally some input optional attributes can be specified.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When the input name is the same as the channel name, the <code class="docutils literal notranslate"><span class="pre">from</span></code> part of the declaration can be omitted.</p>
</div>
<p>The input qualifier declares the <cite>type</cite> of data to be received. This information is used by Nextflow to apply the
semantic rules associated to each qualifier and handle it properly depending on the target execution platform
(grid, cloud, etc).</p>
<p>The qualifiers available are the ones listed in the following table:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Qualifier</p></th>
<th class="head"><p>Semantic</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>val</p></td>
<td><p>Lets you access the received input value by its name in the process script.</p></td>
</tr>
<tr class="row-odd"><td><p>env</p></td>
<td><p>Lets you use the received value to set an environment variable named
as the specified input name.</p></td>
</tr>
<tr class="row-even"><td><p>file</p></td>
<td><p>Lets you handle the received value as a file, staging it properly in the execution context.</p></td>
</tr>
<tr class="row-odd"><td><p>path</p></td>
<td><p>Lets you handle the received value as a path, staging the file properly in the execution context.</p></td>
</tr>
<tr class="row-even"><td><p>stdin</p></td>
<td><p>Lets you forward the received value to the process <code class="docutils literal notranslate"><span class="pre">stdin</span></code> special file.</p></td>
</tr>
<tr class="row-odd"><td><p>tuple</p></td>
<td><p>Lets you handle a group of input values having one of the above qualifiers.</p></td>
</tr>
<tr class="row-even"><td><p>each</p></td>
<td><p>Lets you execute the process for each entry in the input collection.</p></td>
</tr>
</tbody>
</table>
<section id="input-of-generic-values">
<h3>Input of generic values<a class="headerlink" href="#input-of-generic-values" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">val</span></code> qualifier allows you to receive data of any type as input. It can be accessed in the process script
by using the specified input name, as shown in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">num</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>

<span class="n">process</span> <span class="n">basicExample</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">val</span> <span class="n">x</span> <span class="kn">from</span> <span class="nn">num</span>

  <span class="s2">&quot;echo process job $x&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above example the process is executed three times, each time a value is received from the channel <code class="docutils literal notranslate"><span class="pre">num</span></code>
and used to process the script. Thus, it results in an output similar to the one shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">job</span> <span class="mi">3</span>
<span class="n">process</span> <span class="n">job</span> <span class="mi">1</span>
<span class="n">process</span> <span class="n">job</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>channel</cite> guarantees that items are delivered in the same order as they were received - but -
since the process is executed in a parallel manner, there is no guarantee that they are processed in the
same order as they are received. In fact, in the above example, the value <code class="docutils literal notranslate"><span class="pre">3</span></code> is processed before the others.</p>
</div>
<p>When the <code class="docutils literal notranslate"><span class="pre">val</span></code> has the same name as the channel from where the data is received, the <code class="docutils literal notranslate"><span class="pre">from</span></code> part can be omitted.
Thus the above example can be written as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">num</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span>

<span class="n">process</span> <span class="n">basicExample</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">val</span> <span class="n">num</span>

  <span class="s2">&quot;echo process job $num&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="input-of-files">
<h3>Input of files<a class="headerlink" href="#input-of-files" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">file</span></code> qualifier allows the handling of file values in the process execution context. This means that
Nextflow will stage it in the process execution directory, and it can be accessed in the script by using the name
specified in the input declaration. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proteins</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPath</span><span class="p">(</span> <span class="s1">&#39;/some/path/*.fa&#39;</span> <span class="p">)</span>

<span class="n">process</span> <span class="n">blastThemAll</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">path</span> <span class="n">query_file</span> <span class="kn">from</span> <span class="nn">proteins</span>

  <span class="s2">&quot;blastp -query $</span><span class="si">{query_file}</span><span class="s2"> -db nr&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above example all the files ending with the suffix <code class="docutils literal notranslate"><span class="pre">.fa</span></code> are sent over the channel <code class="docutils literal notranslate"><span class="pre">proteins</span></code>.
Then, these files are received by the process which will execute a <cite>BLAST</cite> query on each of them.</p>
<p>When the file input name is the same as the channel name, the <code class="docutils literal notranslate"><span class="pre">from</span></code> part of the input declaration can be omitted.
Thus, the above example could be written as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proteins</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPath</span><span class="p">(</span> <span class="s1">&#39;/some/path/*.fa&#39;</span> <span class="p">)</span>

<span class="n">process</span> <span class="n">blastThemAll</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">path</span> <span class="n">proteins</span>

  <span class="s2">&quot;blastp -query $proteins -db nr&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It’s worth noting that in the above examples, the name of the file in the file-system is not touched, you can
access the file even without knowing its name because you can reference it in the process script by using the
variable whose name is specified in the input file parameter declaration.</p>
<p>There may be cases where your task needs to use a file whose name is fixed, it does not have to change along
with the actual provided file. In this case you can specify its name by specifying the <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute in the
input file parameter declaration, as shown in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">input</span><span class="p">:</span>
    <span class="n">path</span> <span class="n">query_file</span> <span class="n">name</span> <span class="s1">&#39;query.fa&#39;</span> <span class="kn">from</span> <span class="nn">proteins</span>
</pre></div>
</div>
<p>Or alternatively using a shorter syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">input</span><span class="p">:</span>
    <span class="n">path</span> <span class="s1">&#39;query.fa&#39;</span> <span class="kn">from</span> <span class="nn">proteins</span>
</pre></div>
</div>
<p>Using this, the previous example can be re-written as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proteins</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPath</span><span class="p">(</span> <span class="s1">&#39;/some/path/*.fa&#39;</span> <span class="p">)</span>

<span class="n">process</span> <span class="n">blastThemAll</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">path</span> <span class="s1">&#39;query.fa&#39;</span> <span class="kn">from</span> <span class="nn">proteins</span>

  <span class="s2">&quot;blastp -query query.fa -db nr&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>What happens in this example is that each file, that the process receives, is staged with the name <code class="docutils literal notranslate"><span class="pre">query.fa</span></code>
in a different execution context (i.e. the folder where the job is executed) and an independent process
execution is launched.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This feature allows you to execute the process command multiple times without worrying about the file names changing.
In other words, <cite>Nextflow</cite> helps you write pipeline tasks that are self-contained and decoupled from the execution
environment. This is also the reason why you should avoid whenever possible using absolute or relative paths
when referencing files in your pipeline processes.</p>
</div>
</section>
<section id="multiple-input-files">
<h3>Multiple input files<a class="headerlink" href="#multiple-input-files" title="Permalink to this headline"></a></h3>
<p>A process can declare as input file a channel that emits a collection of values, instead of a simple value.</p>
<p>In this case, the script variable defined by the input file parameter will hold a list of files. You can
use it as shown before, referring to all the files in the list, or by accessing a specific entry using the
usual square brackets notation.</p>
<p>When a target file name is defined in the input parameter and a collection of files is received by the process,
the file name will be appended by a numerical suffix representing its ordinal position in the list. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fasta</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPath</span><span class="p">(</span> <span class="s2">&quot;/some/path/*.fa&quot;</span> <span class="p">)</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">size</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>

<span class="n">process</span> <span class="n">blastThemAll</span> <span class="p">{</span>
    <span class="nb">input</span><span class="p">:</span>
    <span class="n">path</span> <span class="s1">&#39;seq&#39;</span> <span class="kn">from</span> <span class="nn">fasta</span>

    <span class="s2">&quot;echo seq*&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Will output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seq1</span> <span class="n">seq2</span> <span class="n">seq3</span>
<span class="n">seq1</span> <span class="n">seq2</span> <span class="n">seq3</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The target input file name can contain the <code class="docutils literal notranslate"><span class="pre">*</span></code> and <code class="docutils literal notranslate"><span class="pre">?</span></code> wildcards, that can be used
to control the name of staged files. The following table shows how the wildcards are
replaced depending on the cardinality of the received input collection.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 9%" />
<col style="width: 10%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Cardinality</p></th>
<th class="head"><p>Name pattern</p></th>
<th class="head"><p>Staged file names</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>any</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">*</span></code></p></td>
<td><p>named as the source file</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file*.ext</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file.ext</span></code></p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file?.ext</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file1.ext</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file??.ext</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file01.ext</span></code></p></td>
</tr>
<tr class="row-even"><td><p>many</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file*.ext</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file1.ext</span></code>, <code class="docutils literal notranslate"><span class="pre">file2.ext</span></code>, <code class="docutils literal notranslate"><span class="pre">file3.ext</span></code>, ..</p></td>
</tr>
<tr class="row-odd"><td><p>many</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file?.ext</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file1.ext</span></code>, <code class="docutils literal notranslate"><span class="pre">file2.ext</span></code>, <code class="docutils literal notranslate"><span class="pre">file3.ext</span></code>, ..</p></td>
</tr>
<tr class="row-even"><td><p>many</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file??.ext</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file01.ext</span></code>, <code class="docutils literal notranslate"><span class="pre">file02.ext</span></code>, <code class="docutils literal notranslate"><span class="pre">file03.ext</span></code>, ..</p></td>
</tr>
<tr class="row-odd"><td><p>many</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dir/*</span></code></p></td>
<td><p>named as the source file, created in <code class="docutils literal notranslate"><span class="pre">dir</span></code> subdirectory</p></td>
</tr>
<tr class="row-even"><td><p>many</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dir??/*</span></code></p></td>
<td><p>named as the source file, created in a progressively indexed subdirectory e.g. <code class="docutils literal notranslate"><span class="pre">dir01/</span></code>, <code class="docutils literal notranslate"><span class="pre">dir02/</span></code>, etc.</p></td>
</tr>
<tr class="row-odd"><td><p>many</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dir*/*</span></code></p></td>
<td><p>(as above)</p></td>
</tr>
</tbody>
</table>
<p>The following fragment shows how a wildcard can be used in the input file declaration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fasta</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPath</span><span class="p">(</span> <span class="s2">&quot;/some/path/*.fa&quot;</span> <span class="p">)</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">size</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>

<span class="n">process</span> <span class="n">blastThemAll</span> <span class="p">{</span>
    <span class="nb">input</span><span class="p">:</span>
    <span class="n">path</span> <span class="s1">&#39;seq?.fa&#39;</span> <span class="kn">from</span> <span class="nn">fasta</span>

    <span class="s2">&quot;cat seq1.fa seq2.fa seq3.fa&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Rewriting input file names according to a named pattern is an extra feature and not at all obligatory.
The normal file input constructs introduced in the <a class="reference internal" href="#input-of-files">Input of files</a> section are valid for collections of
multiple files as well. To handle multiple input files preserving the original file names, use the <code class="docutils literal notranslate"><span class="pre">*</span></code> wildcard as
name pattern or a variable identifier.</p>
</div>
</section>
<section id="dynamic-input-file-names">
<h3>Dynamic input file names<a class="headerlink" href="#dynamic-input-file-names" title="Permalink to this headline"></a></h3>
<p>When the input file name is specified by using the <code class="docutils literal notranslate"><span class="pre">name</span></code> file clause or the short <cite>string</cite> notation, you
are allowed to use other input values as variables in the file name string. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">simpleCount</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">val</span> <span class="n">x</span> <span class="kn">from</span> <span class="nn">species</span>
  <span class="n">path</span> <span class="s2">&quot;$</span><span class="si">{x}</span><span class="s2">.fa&quot;</span> <span class="kn">from</span> <span class="nn">genomes</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  cat ${x}.fa | grep &#39;&gt;&#39;</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above example, the input file name is set by using the current value of the <code class="docutils literal notranslate"><span class="pre">x</span></code> input value.</p>
<p>This allows the input files to be staged in the script working directory with a name that is coherent
with the current execution context.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In most cases, you won’t need to use dynamic file names, because each process is executed in its
own temporary directory, and input files are automatically staged into this directory by Nextflow.
This guarantees that input files with the same name won’t overwrite each other.</p>
</div>
</section>
<section id="input-of-type-path">
<h3>Input of type ‘path’<a class="headerlink" href="#input-of-type-path" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">path</span></code> input qualifier was introduced by Nextflow version 19.10.0 and it’s a drop-in replacement
for the <code class="docutils literal notranslate"><span class="pre">file</span></code> qualifier, therefore it’s backward compatible with the syntax
and the semantic for the input <code class="docutils literal notranslate"><span class="pre">file</span></code> described above.</p>
<p>The important difference between <code class="docutils literal notranslate"><span class="pre">file</span></code> and <code class="docutils literal notranslate"><span class="pre">path</span></code> qualifier is that the first expects the
values received as input to be <em>file</em> objects. When inputs is a different type, it automatically
coverts to a string and saves it to a temporary files. This can be useful in some uses cases,
but it turned out to be tricky in most common cases.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">path</span></code> qualifier instead interprets string values as the path location of the input file
and automatically converts to a file object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
    <span class="n">path</span> <span class="n">x</span> <span class="kn">from</span> <span class="s1">&#39;/some/data/file.txt&#39;</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  your_command --in $x</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The input value should represent an absolute path location, i.e. the string value
<strong>must</strong> be prefixed with a <code class="docutils literal notranslate"><span class="pre">/</span></code> character or with a supported URI protocol (<code class="docutils literal notranslate"><span class="pre">file://</span></code>,
<code class="docutils literal notranslate"><span class="pre">http://</span></code>, <code class="docutils literal notranslate"><span class="pre">s3://</span></code>, etc) and it cannot contain special characters (<code class="docutils literal notranslate"><span class="pre">\n</span></code>, etc).</p>
</div>
<p>The option <code class="docutils literal notranslate"><span class="pre">stageAs</span></code> allow you to control how the file should be named in the task work
directory, providing a specific name or a name pattern as described in the <a class="reference internal" href="#multiple-input-files">Multiple input files</a>
section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
    <span class="n">path</span> <span class="n">x</span><span class="p">,</span> <span class="n">stageAs</span><span class="p">:</span> <span class="s1">&#39;data.txt&#39;</span> <span class="kn">from</span> <span class="s1">&#39;/some/data/file.txt&#39;</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  your_command --in data.txt</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <code class="docutils literal notranslate"><span class="pre">path</span></code> qualifier should be preferred over <code class="docutils literal notranslate"><span class="pre">file</span></code> to handle process input files
when using Nextflow 19.10.0 or later.</p>
</div>
</section>
<section id="input-of-type-stdin">
<h3>Input of type ‘stdin’<a class="headerlink" href="#input-of-type-stdin" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">stdin</span></code> input qualifier allows you the forwarding of the value received from a channel to the
<a class="reference external" href="http://en.wikipedia.org/wiki/Standard_streams#Standard_input_.28stdin.29">standard input</a>
of the command executed by the process. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;hola&#39;</span><span class="p">,</span> <span class="s1">&#39;bonjour&#39;</span><span class="p">,</span> <span class="s1">&#39;ciao&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">it</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="p">}</span>

<span class="n">process</span> <span class="n">printAll</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">stdin</span> <span class="nb">str</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  cat -</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It will output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hola</span>
<span class="n">bonjour</span>
<span class="n">ciao</span>
<span class="n">hello</span>
</pre></div>
</div>
</section>
<section id="input-of-type-env">
<h3>Input of type ‘env’<a class="headerlink" href="#input-of-type-env" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">env</span></code> qualifier allows you to define an environment variable in the process execution context based
on the value received from the channel. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;hola&#39;</span><span class="p">,</span> <span class="s1">&#39;bonjour&#39;</span><span class="p">,</span> <span class="s1">&#39;ciao&#39;</span><span class="p">)</span>

<span class="n">process</span> <span class="n">printEnv</span> <span class="p">{</span>
    <span class="nb">input</span><span class="p">:</span>
    <span class="n">env</span> <span class="n">HELLO</span> <span class="kn">from</span> <span class="nn">str</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    echo $HELLO world!</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>hello world!
ciao world!
bonjour world!
hola world!
</pre></div>
</div>
</section>
<section id="input-of-type-set">
<span id="process-input-set"></span><h3>Input of type ‘set’<a class="headerlink" href="#input-of-type-set" title="Permalink to this headline"></a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">set</span></code> input type has been deprecated. Use <code class="docutils literal notranslate"><span class="pre">tuple</span></code> instead.</p>
</div>
</section>
<section id="input-of-type-tuple">
<span id="process-input-tuple"></span><h3>Input of type ‘tuple’<a class="headerlink" href="#input-of-type-tuple" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">tuple</span></code> qualifier allows you to group multiple parameters in a single parameter definition. It can be useful
when a process receives, in input, tuples of values that need to be handled separately. Each element in the tuple
is associated to a corresponding element with the <code class="docutils literal notranslate"><span class="pre">tuple</span></code> definition. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">of</span><span class="p">(</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;delta&#39;</span><span class="p">]</span> <span class="p">)</span>

<span class="n">process</span> <span class="n">tupleExample</span> <span class="p">{</span>
    <span class="nb">input</span><span class="p">:</span>
    <span class="nb">tuple</span> <span class="n">val</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">path</span><span class="p">(</span><span class="s1">&#39;latin.txt&#39;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">values</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    echo Processing $x</span>
<span class="sd">    cat - latin.txt &gt; copy</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above example the <code class="docutils literal notranslate"><span class="pre">tuple</span></code> parameter is used to define the value <code class="docutils literal notranslate"><span class="pre">x</span></code> and the file <code class="docutils literal notranslate"><span class="pre">latin.txt</span></code>,
which will receive a value from the same channel.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">tuple</span></code> declaration items can be defined by using the following qualifiers: <code class="docutils literal notranslate"><span class="pre">val</span></code>, <code class="docutils literal notranslate"><span class="pre">env</span></code>, <code class="docutils literal notranslate"><span class="pre">path</span></code> and <code class="docutils literal notranslate"><span class="pre">stdin</span></code>.</p>
<p>File names can be defined in <em>dynamic</em> manner as explained in the <a class="reference internal" href="#dynamic-input-file-names">Dynamic input file names</a> section.</p>
</section>
<section id="input-repeaters">
<h3>Input repeaters<a class="headerlink" href="#input-repeaters" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">each</span></code> qualifier allows you to repeat the execution of a process for each item in a collection,
every time a new data is received. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sequences</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="s1">&#39;*.fa&#39;</span><span class="p">)</span>
<span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;regular&#39;</span><span class="p">,</span> <span class="s1">&#39;expresso&#39;</span><span class="p">,</span> <span class="s1">&#39;psicoffee&#39;</span><span class="p">]</span>

<span class="n">process</span> <span class="n">alignSequences</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">path</span> <span class="n">seq</span> <span class="kn">from</span> <span class="nn">sequences</span>
  <span class="n">each</span> <span class="n">mode</span> <span class="kn">from</span> <span class="nn">methods</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  t_coffee -in $seq -mode $mode &gt; result</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above example every time a file of sequences is received as input by the process,
it executes <em>three</em> tasks running a T-coffee alignment with a different value for the <code class="docutils literal notranslate"><span class="pre">mode</span></code> parameter.
This is useful when you need to <cite>repeat</cite> the same task for a given set of parameters.</p>
<p>Input repeaters can be applied to files as well. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sequences</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="s1">&#39;*.fa&#39;</span><span class="p">)</span>
<span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;regular&#39;</span><span class="p">,</span> <span class="s1">&#39;expresso&#39;</span><span class="p">]</span>
<span class="n">libraries</span> <span class="o">=</span> <span class="p">[</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;PQ001.lib&#39;</span><span class="p">),</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;PQ002.lib&#39;</span><span class="p">),</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;PQ003.lib&#39;</span><span class="p">)</span> <span class="p">]</span>

<span class="n">process</span> <span class="n">alignSequences</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">path</span> <span class="n">seq</span> <span class="kn">from</span> <span class="nn">sequences</span>
  <span class="n">each</span> <span class="n">mode</span> <span class="kn">from</span> <span class="nn">methods</span>
  <span class="n">each</span> <span class="n">path</span><span class="p">(</span><span class="n">lib</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">libraries</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  t_coffee -in $seq -mode $mode -lib $lib &gt; result</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When multiple repeaters are declared, the process is executed for each <em>combination</em> of them.</p>
</div>
<p>In the latter example for any sequence input file emitted by the <code class="docutils literal notranslate"><span class="pre">sequences</span></code> channel are executed 6 alignments,
3 using the <code class="docutils literal notranslate"><span class="pre">regular</span></code> method against each library files, and other 3 by using the <code class="docutils literal notranslate"><span class="pre">expresso</span></code> method always
against the same library files.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you need to repeat the execution of a process over an n-tuple of elements instead of simple values or files,
create a channel combining the input values as needed to trigger the process execution multiple times.
Refer to the <a class="reference internal" href="operator.html#operator-combine"><span class="std std-ref">combine</span></a>, <a class="reference internal" href="operator.html#operator-cross"><span class="std std-ref">cross</span></a> and <a class="reference internal" href="operator.html#operator-phase"><span class="std std-ref">phase</span></a> operators for more details.</p>
</div>
</section>
<section id="understand-how-multiple-input-channels-work">
<span id="process-understand-how-multiple-input-channels-work"></span><h3>Understand how multiple input channels work<a class="headerlink" href="#understand-how-multiple-input-channels-work" title="Permalink to this headline"></a></h3>
<p>A key feature of processes is the ability to handle inputs from multiple channels.</p>
<p>When two or more channels are declared as process inputs, the process stops until
there’s a complete input configuration ie. it receives an input value from all the channels declared
as input.</p>
<p>When this condition is verified, it consumes the input values coming from the respective channels,
and spawns a task execution, then repeat the same logic until one or more channels have no more content.</p>
<p>This means channel values are consumed serially one after another and the first empty channel
cause the process execution to stop even if there are other values in other channels.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
  <span class="n">debug</span> <span class="n">true</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">val</span> <span class="n">x</span> <span class="kn">from</span> <span class="nn">Channel.from</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">val</span> <span class="n">y</span> <span class="kn">from</span> <span class="nn">Channel.from</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

  <span class="n">script</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  echo $x and $y</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The process <code class="docutils literal notranslate"><span class="pre">foo</span></code> is executed two times because the first input channel only provides two values and therefore
the <code class="docutils literal notranslate"><span class="pre">c</span></code> element is discarded. It prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="ow">and</span> <span class="n">a</span>
<span class="mi">2</span> <span class="ow">and</span> <span class="n">b</span>
</pre></div>
</div>
<p>A different semantic is applied when using a <em>value channel</em> (a.k.a. <em>singleton channel</em>).
This kind of channel is created by the <a class="reference internal" href="channel.html#channel-value"><span class="std std-ref">Channel.value</span></a> factory method or implicitly
when a process input specifies a simple value in the <code class="docutils literal notranslate"><span class="pre">from</span></code> clause.
By definition, a value channel is bound to a single value and it can be read an unlimited
number of times without consuming its content.</p>
<p>These properties make that when mixing a value channel with one or more (queue) channels,
it does not affect the process termination because its content is applied repeatedly.</p>
<p>To better understand this behavior, compare the previous example with the following one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">bar</span> <span class="p">{</span>
  <span class="n">debug</span> <span class="n">true</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">val</span> <span class="n">x</span> <span class="kn">from</span> <span class="nn">Channel.value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">val</span> <span class="n">y</span> <span class="kn">from</span> <span class="nn">Channel.from</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

  <span class="n">script</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  echo $x and $y</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above snippet executes the <code class="docutils literal notranslate"><span class="pre">bar</span></code> process three times because the first input is a <em>value channel</em>, therefore
its content can be read as many times as needed. The process termination is determined by the content of the second
channel. It prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="ow">and</span> <span class="n">a</span>
<span class="mi">1</span> <span class="ow">and</span> <span class="n">b</span>
<span class="mi">1</span> <span class="ow">and</span> <span class="n">c</span>
</pre></div>
</div>
<p>See also: <a class="reference internal" href="channel.html#channel-types"><span class="std std-ref">Channel types</span></a>.</p>
</section>
</section>
<section id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">output</span></code> declaration block allows you to define the channels used by the process to send out the results produced.
You can only define one output block at a time and it must contain one or more output declarations.</p>
<p>The output block follows the syntax shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span><span class="p">:</span>
  <span class="o">&lt;</span><span class="n">output</span> <span class="n">qualifier</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">name</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">into</span> <span class="o">&lt;</span><span class="n">target</span> <span class="n">channel</span><span class="o">&gt;</span><span class="p">[,</span><span class="n">channel</span><span class="p">,</span><span class="o">..</span><span class="p">]]</span> <span class="p">[</span><span class="n">attribute</span> <span class="p">[,</span><span class="o">..</span><span class="p">]]</span>
</pre></div>
</div>
<p>Output definitions start by an output <cite>qualifier</cite> and the output <cite>name</cite>, followed by the keyword <code class="docutils literal notranslate"><span class="pre">into</span></code> and
one or more channels over which outputs are sent. Finally some optional attributes can be specified.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When the output name is the same as the channel name, the <code class="docutils literal notranslate"><span class="pre">into</span></code> part of the declaration can be omitted.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If an output channel has not been previously declared in the pipeline script, it
will be implicitly created by the output declaration itself.</p>
</div>
<p>The qualifiers that can be used in the output declaration block are the ones listed in the following table:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 9%" />
<col style="width: 91%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Qualifier</p></th>
<th class="head"><p>Semantic</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>val</p></td>
<td><p>Sends variables with the name specified over the output channel.</p></td>
</tr>
<tr class="row-odd"><td><p>file</p></td>
<td><p>Sends a file produced by the process with the name specified over the output channel.</p></td>
</tr>
<tr class="row-even"><td><p>path</p></td>
<td><p>Sends a file produced by the process with the name specified over the output channel (replaces <code class="docutils literal notranslate"><span class="pre">file</span></code>).</p></td>
</tr>
<tr class="row-odd"><td><p>env</p></td>
<td><p>Sends the variable defined in the process environment with the name specified over the output channel.</p></td>
</tr>
<tr class="row-even"><td><p>stdout</p></td>
<td><p>Sends the executed process <code class="docutils literal notranslate"><span class="pre">stdout</span></code> over the output channel.</p></td>
</tr>
<tr class="row-odd"><td><p>tuple</p></td>
<td><p>Sends multiple values over the same output channel.</p></td>
</tr>
</tbody>
</table>
<section id="output-values">
<h3>Output values<a class="headerlink" href="#output-values" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">val</span></code> qualifier allows you to output a <cite>value</cite> defined in the script context. In a common usage scenario,
this is a value which has been defined in the <code class="docutils literal notranslate"><span class="pre">input</span></code> declaration block, as shown in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;prot&#39;</span><span class="p">,</span><span class="s1">&#39;dna&#39;</span><span class="p">,</span> <span class="s1">&#39;rna&#39;</span><span class="p">]</span>

<span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">val</span> <span class="n">x</span> <span class="kn">from</span> <span class="nn">methods</span>

  <span class="n">output</span><span class="p">:</span>
  <span class="n">val</span> <span class="n">x</span> <span class="n">into</span> <span class="n">receiver</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  echo $x &gt; file</span>
<span class="sd">  &quot;&quot;&quot;</span>

<span class="p">}</span>

<span class="n">receiver</span><span class="o">.</span><span class="n">view</span> <span class="p">{</span> <span class="s2">&quot;Received: $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>Valid output values are value literals, input value identifiers, variables accessible in the process scope and
value expressions. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">path</span> <span class="n">fasta</span> <span class="kn">from</span> <span class="s1">&#39;dummy&#39;</span>

  <span class="n">output</span><span class="p">:</span>
  <span class="n">val</span> <span class="n">x</span> <span class="n">into</span> <span class="n">var_channel</span>
  <span class="n">val</span> <span class="s1">&#39;BB11&#39;</span> <span class="n">into</span> <span class="n">str_channel</span>
  <span class="n">val</span> <span class="s2">&quot;$</span><span class="si">{fasta.baseName}</span><span class="s2">.out&quot;</span> <span class="n">into</span> <span class="n">exp_channel</span>

  <span class="n">script</span><span class="p">:</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">fasta</span><span class="o">.</span><span class="n">name</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  cat $x &gt; file</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="output-files">
<h3>Output files<a class="headerlink" href="#output-files" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">file</span></code> qualifier allows you to output one or more files, produced by the process, over the specified channel.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">randomNum</span> <span class="p">{</span>
  <span class="n">output</span><span class="p">:</span>
  <span class="n">path</span> <span class="s1">&#39;result.txt&#39;</span> <span class="n">into</span> <span class="n">numbers</span>

  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  echo $RANDOM &gt; result.txt</span>
<span class="sd">  &#39;&#39;&#39;</span>
<span class="p">}</span>

<span class="n">numbers</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;Received: &quot;</span> <span class="o">+</span> <span class="n">it</span><span class="o">.</span><span class="n">text</span> <span class="p">}</span>
</pre></div>
</div>
<p>In the above example the process, when executed, creates a file named <code class="docutils literal notranslate"><span class="pre">result.txt</span></code> containing a random number.
Since a file parameter using the same name is declared between the outputs, when the task is completed that
file is sent over the <code class="docutils literal notranslate"><span class="pre">numbers</span></code> channel. A downstream process declaring the same channel as <code class="docutils literal notranslate"><span class="pre">input</span></code> will
be able to receive it.</p>
</section>
<section id="multiple-output-files">
<h3>Multiple output files<a class="headerlink" href="#multiple-output-files" title="Permalink to this headline"></a></h3>
<p>When an output file name contains a <code class="docutils literal notranslate"><span class="pre">*</span></code> or <code class="docutils literal notranslate"><span class="pre">?</span></code> wildcard character it is interpreted as a <a class="reference external" href="http://docs.oracle.com/javase/tutorial/essential/io/fileOps.html#glob">glob</a> path matcher.
This allows you to <em>capture</em> multiple files into a list object and output them as a sole emission. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">splitLetters</span> <span class="p">{</span>
    <span class="n">output</span><span class="p">:</span>
    <span class="n">path</span> <span class="s1">&#39;chunk_*&#39;</span> <span class="n">into</span> <span class="n">letters</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    printf &#39;Hola&#39; | split -b 1 - chunk_</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="p">}</span>

<span class="n">letters</span>
    <span class="o">.</span><span class="n">flatMap</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;File: $</span><span class="si">{it.name}</span><span class="s2"> =&gt; $</span><span class="si">{it.text}</span><span class="s2">&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>It prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span><span class="p">:</span> <span class="n">chunk_aa</span> <span class="o">=&gt;</span> <span class="n">H</span>
<span class="n">File</span><span class="p">:</span> <span class="n">chunk_ab</span> <span class="o">=&gt;</span> <span class="n">o</span>
<span class="n">File</span><span class="p">:</span> <span class="n">chunk_ac</span> <span class="o">=&gt;</span> <span class="n">l</span>
<span class="n">File</span><span class="p">:</span> <span class="n">chunk_ad</span> <span class="o">=&gt;</span> <span class="n">a</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the above example, the operator <a class="reference internal" href="operator.html#operator-flatmap"><span class="std std-ref">flatMap</span></a> is used to transform the list of files emitted by
the <code class="docutils literal notranslate"><span class="pre">letters</span></code> channel into a channel that emits each file object separately.</p>
</div>
<p>Some caveats on glob pattern behavior:</p>
<ul class="simple">
<li><p>Input files are not included (unless <code class="docutils literal notranslate"><span class="pre">includeInputs</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>)</p></li>
<li><p>Directories are included, unless the <code class="docutils literal notranslate"><span class="pre">**</span></code> pattern is used to recurse through directories</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Although the input files matching a glob output declaration are not included in the
resulting output channel, these files may still be transferred from the task scratch directory
to the original task work directory. Therefore, to avoid unnecessary file copies, avoid using
loose wildcards when defining output files, e.g. <code class="docutils literal notranslate"><span class="pre">file</span> <span class="pre">'*'</span></code>. Instead, use a prefix or a suffix
to restrict the set of matching files to only the expected ones, e.g. <code class="docutils literal notranslate"><span class="pre">file</span> <span class="pre">'prefix_*.sorted.bam'</span></code>.</p>
</div>
<p>By default all the files matching the specified glob pattern are emitted by the channel as a sole (list) item.
It is also possible to emit each file as a sole item by adding the <code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">flatten</span></code> attribute in the output file
declaration.</p>
<p>By using the <code class="docutils literal notranslate"><span class="pre">mode</span></code> attribute the previous example can be re-written as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">splitLetters</span> <span class="p">{</span>
    <span class="n">output</span><span class="p">:</span>
    <span class="n">path</span> <span class="s1">&#39;chunk_*&#39;</span> <span class="n">into</span> <span class="n">letters</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    printf &#39;Hola&#39; | split -b 1 - chunk_</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="p">}</span>

<span class="n">letters</span>
    <span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">println</span> <span class="s2">&quot;File: $</span><span class="si">{it.name}</span><span class="s2"> =&gt; $</span><span class="si">{it.text}</span><span class="s2">&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>Read more about glob syntax at the following link <a class="reference external" href="http://docs.oracle.com/javase/tutorial/essential/io/fileOps.html#glob">What is a glob?</a></p>
</section>
<section id="dynamic-output-file-names">
<span id="process-dynoutname"></span><h3>Dynamic output file names<a class="headerlink" href="#dynamic-output-file-names" title="Permalink to this headline"></a></h3>
<p>When an output file name needs to be expressed dynamically, it is possible to define it using a dynamic evaluated
string which references values defined in the input declaration block or in the script global context.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">align</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">val</span> <span class="n">x</span> <span class="kn">from</span> <span class="nn">species</span>
  <span class="n">path</span> <span class="n">seq</span> <span class="kn">from</span> <span class="nn">sequences</span>

  <span class="n">output</span><span class="p">:</span>
  <span class="n">path</span> <span class="s2">&quot;$</span><span class="si">{x}</span><span class="s2">.aln&quot;</span> <span class="n">into</span> <span class="n">genomes</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  t_coffee -in $seq &gt; ${x}.aln</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above example, each time the process is executed an alignment file is produced whose name depends
on the actual value of the <code class="docutils literal notranslate"><span class="pre">x</span></code> input.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The management of output files in Nextflow is often misunderstood.
With other tools it is generally necessary to organize the output files into some kind of directory
structure or to guarantee a unique file name scheme, so that result files don’t overwrite each other
and so they can be referenced unequivocally by downstream tasks.</p>
<p>With Nextflow, in most cases, you don’t need to manage the naming of output files, because each task is executed
in its own unique directory, so files produced by different tasks can not override each other.
Also, metadata can be associated with outputs by using the <a class="reference internal" href="#process-out-tuple"><span class="std std-ref">tuple output</span></a> qualifier, instead of
including them in the output file name.</p>
<p>To sum up, the use of output files with static names over dynamic ones is preferable whenever possible,
because it will result in simpler and more portable code.</p>
</div>
</section>
<section id="output-path">
<span id="process-out-path"></span><h3>Output path<a class="headerlink" href="#output-path" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">path</span></code> output qualifier was introduced by Nextflow version 19.10.0 and it’s a drop-in replacement
for the <code class="docutils literal notranslate"><span class="pre">file</span></code> output qualifier, therefore it’s backward compatible with the syntax
and the semantic for the input <code class="docutils literal notranslate"><span class="pre">file</span></code> described above.</p>
<p>The main advantage of <code class="docutils literal notranslate"><span class="pre">path</span></code> over the <code class="docutils literal notranslate"><span class="pre">file</span></code> qualifier is that it allows the specification
of a number of outputs to fine-control the output files.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8%" />
<col style="width: 92%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>glob</p></td>
<td><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> the specified name is interpreted as a glob pattern (default: <code class="docutils literal notranslate"><span class="pre">true</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p>hidden</p></td>
<td><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> hidden files are included in the matching output files (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p>followLinks</p></td>
<td><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> target files are return in place of any matching symlink (default: <code class="docutils literal notranslate"><span class="pre">true</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td><p>Type of paths returned, either <code class="docutils literal notranslate"><span class="pre">file</span></code>, <code class="docutils literal notranslate"><span class="pre">dir</span></code> or <code class="docutils literal notranslate"><span class="pre">any</span></code> (default: <code class="docutils literal notranslate"><span class="pre">any</span></code>, or <code class="docutils literal notranslate"><span class="pre">file</span></code> if the specified file name pattern contains a <cite>**</cite> - double star - symbol)</p></td>
</tr>
<tr class="row-even"><td><p>maxDepth</p></td>
<td><p>Maximum number of directory levels to visit (default: <cite>no limit</cite>)</p></td>
</tr>
<tr class="row-odd"><td><p>includeInputs</p></td>
<td><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> any input files matching an output file glob pattern are included.</p></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">file</span></code> qualifier interprets <code class="docutils literal notranslate"><span class="pre">:</span></code> as a path separator, therefore <code class="docutils literal notranslate"><span class="pre">file</span> <span class="pre">'foo:bar'</span></code>
captures two files named <code class="docutils literal notranslate"><span class="pre">foo</span></code> and <code class="docutils literal notranslate"><span class="pre">bar</span></code>. The <code class="docutils literal notranslate"><span class="pre">path</span></code> qualifier, on the other hand, does not,
so the output definition <code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">'foo:bar'</span></code> captures a single file named <code class="docutils literal notranslate"><span class="pre">foo:bar</span></code>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <code class="docutils literal notranslate"><span class="pre">path</span></code> qualifier should be preferred over <code class="docutils literal notranslate"><span class="pre">file</span></code> to handle process output files
when using Nextflow 19.10.0 or later.</p>
</div>
</section>
<section id="output-stdout-special-file">
<span id="process-stdout"></span><h3>Output ‘stdout’ special file<a class="headerlink" href="#output-stdout-special-file" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">stdout</span></code> qualifier allows you to <cite>capture</cite> the <code class="docutils literal notranslate"><span class="pre">stdout</span></code> output of the executed process and send it over
the channel specified in the output parameter declaration. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">sayHello</span> <span class="p">{</span>
    <span class="n">output</span><span class="p">:</span>
    <span class="n">stdout</span> <span class="n">ch</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    echo Hello world!</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>

<span class="n">ch</span><span class="o">.</span><span class="n">view</span> <span class="p">{</span> <span class="nb">print</span> <span class="s2">&quot;I say..  $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>In the above example <code class="docutils literal notranslate"><span class="pre">ch</span></code> represents an arbitrary channel variable that holds the process outputs.</p>
</section>
<section id="output-env">
<span id="process-env"></span><h3>Output ‘env’<a class="headerlink" href="#output-env" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">env</span></code> qualifier allows you to capture a variable defined in the process execution environment
and send it over the channel specified in the output parameter declaration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">myTask</span> <span class="p">{</span>
    <span class="n">output</span><span class="p">:</span>
    <span class="n">env</span> <span class="n">FOO</span> <span class="n">into</span> <span class="n">target</span>

    <span class="n">script</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    FOO=$(ls -la)</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="p">}</span>

<span class="n">target</span><span class="o">.</span><span class="n">view</span> <span class="p">{</span> <span class="s2">&quot;directory content: $it&quot;</span> <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="output-set-of-values">
<span id="process-set"></span><h3>Output ‘set’ of values<a class="headerlink" href="#output-set-of-values" title="Permalink to this headline"></a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">set</span></code> output type has been deprecated. Use <code class="docutils literal notranslate"><span class="pre">tuple</span></code> instead.</p>
</div>
</section>
<section id="output-tuple-of-values">
<span id="process-out-tuple"></span><h3>Output ‘tuple’ of values<a class="headerlink" href="#output-tuple-of-values" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">tuple</span></code> qualifier allows you to send multiple values into a single channel. This feature is useful
when you need to <cite>group together</cite> the results of multiple executions of the same process, as shown in the following
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">query_ch</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPath</span> <span class="s1">&#39;*.fa&#39;</span>
<span class="n">species_ch</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="kn">from</span> <span class="s1">&#39;human&#39;</span><span class="p">,</span> <span class="s1">&#39;cow&#39;</span><span class="p">,</span> <span class="s1">&#39;horse&#39;</span>

<span class="n">process</span> <span class="n">blast</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
    <span class="n">val</span> <span class="n">species</span> <span class="kn">from</span> <span class="nn">query_ch</span>
    <span class="n">path</span> <span class="n">query</span> <span class="kn">from</span> <span class="nn">species_ch</span>

  <span class="n">output</span><span class="p">:</span>
    <span class="nb">tuple</span> <span class="n">val</span><span class="p">(</span><span class="n">species</span><span class="p">),</span> <span class="n">path</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span> <span class="n">into</span> <span class="n">blastOuts</span>

  <span class="n">script</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    blast -db nr -query $query &gt; result</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above example a <code class="docutils literal notranslate"><span class="pre">blast</span></code> task is executed for each pair of <code class="docutils literal notranslate"><span class="pre">species</span></code> and <code class="docutils literal notranslate"><span class="pre">query</span></code> that are received.
When the task completes a new tuple containing the value for <code class="docutils literal notranslate"><span class="pre">species</span></code> and the file <code class="docutils literal notranslate"><span class="pre">result</span></code> is sent to the <code class="docutils literal notranslate"><span class="pre">blastOuts</span></code> channel.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">tuple</span></code> declaration can contain any combination of the following qualifiers, previously described: <code class="docutils literal notranslate"><span class="pre">val</span></code>, <code class="docutils literal notranslate"><span class="pre">path</span></code>, <code class="docutils literal notranslate"><span class="pre">env</span></code> and <code class="docutils literal notranslate"><span class="pre">stdout</span></code>.</p>
<p>File names can be defined in a dynamic manner as explained in the <a class="reference internal" href="#process-dynoutname"><span class="std std-ref">Dynamic output file names</span></a> section.</p>
</section>
<section id="optional-output">
<h3>Optional Output<a class="headerlink" href="#optional-output" title="Permalink to this headline"></a></h3>
<p>In most cases a process is expected to generate output that is added to the output channel. However, there are situations where it is valid for a process to <cite>not</cite> generate output. In these cases <code class="docutils literal notranslate"><span class="pre">optional</span> <span class="pre">true</span></code> may be added to the output declaration, which tells Nextflow not to fail the process if the declared output is not created.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span><span class="p">:</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;output.txt&quot;</span><span class="p">)</span> <span class="n">optional</span> <span class="n">true</span> <span class="n">into</span> <span class="n">outChannel</span>
</pre></div>
</div>
<p>In this example, the process is normally expected to generate an <code class="docutils literal notranslate"><span class="pre">output.txt</span></code> file, but in the cases where the file is legitimately missing, the process does not fail. <code class="docutils literal notranslate"><span class="pre">outChannel</span></code> is only populated by those processes that do generate <code class="docutils literal notranslate"><span class="pre">output.txt</span></code>.</p>
</section>
</section>
<section id="when">
<h2>When<a class="headerlink" href="#when" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">when</span></code> declaration allows you to define a condition that must be verified in order to execute the process.
This can be any expression that evaluates a boolean value.</p>
<p>It is useful to enable/disable the process execution depending on the state of various inputs and parameters. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">find</span> <span class="p">{</span>
  <span class="nb">input</span><span class="p">:</span>
  <span class="n">path</span> <span class="n">proteins</span>
  <span class="n">val</span> <span class="nb">type</span> <span class="kn">from</span> <span class="nn">dbtype</span>

  <span class="n">when</span><span class="p">:</span>
  <span class="n">proteins</span><span class="o">.</span><span class="n">name</span> <span class="o">=~</span> <span class="o">/^</span><span class="n">BB11</span><span class="o">.*/</span> <span class="o">&amp;&amp;</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;nr&#39;</span>

  <span class="n">script</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  blastp -query $proteins -db nr</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="directives">
<span id="process-directives"></span><h2>Directives<a class="headerlink" href="#directives" title="Permalink to this headline"></a></h2>
<p>Directives are optional settings that affect the execution of the current process.</p>
<p>They must be entered at the top of the process body, before any other declaration blocks (<code class="docutils literal notranslate"><span class="pre">input</span></code>, <code class="docutils literal notranslate"><span class="pre">output</span></code>, etc),
and have the following syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="n">value</span> <span class="p">[,</span> <span class="n">value2</span> <span class="p">[,</span><span class="o">..</span><span class="p">]]</span>
</pre></div>
</div>
<p>Some directives are generally available to all processes, while others depend on the <cite>executor</cite> currently defined.</p>
<p>The directives are:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#accelerator">accelerator</a></p></li>
<li><p><a class="reference internal" href="#afterscript">afterScript</a></p></li>
<li><p><a class="reference internal" href="#beforescript">beforeScript</a></p></li>
<li><p><a class="reference internal" href="#cache">cache</a></p></li>
<li><p><a class="reference internal" href="#clusteroptions">clusterOptions</a></p></li>
<li><p><a class="reference external" href="https://conda.io">conda</a></p></li>
<li><p><a class="reference internal" href="#container">container</a></p></li>
<li><p><a class="reference internal" href="#containeroptions">containerOptions</a></p></li>
<li><p><a class="reference internal" href="#cpus">cpus</a></p></li>
<li><p><a class="reference internal" href="#debug">debug</a></p></li>
<li><p><a class="reference internal" href="#disk">disk</a></p></li>
<li><p><a class="reference internal" href="#echo">echo</a></p></li>
<li><p><a class="reference internal" href="#errorstrategy">errorStrategy</a></p></li>
<li><p><a class="reference internal" href="#executor">executor</a></p></li>
<li><p><a class="reference internal" href="#ext">ext</a></p></li>
<li><p><a class="reference internal" href="#label">label</a></p></li>
<li><p><a class="reference internal" href="#machinetype">machineType</a></p></li>
<li><p><a class="reference internal" href="#maxerrors">maxErrors</a></p></li>
<li><p><a class="reference internal" href="#maxforks">maxForks</a></p></li>
<li><p><a class="reference internal" href="#maxretries">maxRetries</a></p></li>
<li><p><a class="reference internal" href="#memory">memory</a></p></li>
<li><p><a class="reference internal" href="#module">module</a></p></li>
<li><p><a class="reference internal" href="#penv">penv</a></p></li>
<li><p><a class="reference internal" href="#pod">pod</a></p></li>
<li><p><a class="reference internal" href="#publishdir">publishDir</a></p></li>
<li><p><a class="reference internal" href="#queue">queue</a></p></li>
<li><p><a class="reference internal" href="#scratch">scratch</a></p></li>
<li><p><a class="reference internal" href="#stageinmode">stageInMode</a></p></li>
<li><p><a class="reference internal" href="#stageoutmode">stageOutMode</a></p></li>
<li><p><a class="reference internal" href="#storedir">storeDir</a></p></li>
<li><p><a class="reference internal" href="#tag">tag</a></p></li>
<li><p><a class="reference internal" href="#time">time</a></p></li>
</ul>
<section id="accelerator">
<span id="process-accelerator"></span><h3>accelerator<a class="headerlink" href="#accelerator" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">accelerator</span></code> directive allows you to specify the hardware accelerator requirement for the task execution
e.g. <em>GPU</em> processor. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
    <span class="n">accelerator</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="s1">&#39;nvidia-tesla-k80&#39;</span>

    <span class="n">script</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    your_gpu_enabled --command --line</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above examples will request 4 GPUs of type <code class="docutils literal notranslate"><span class="pre">nvidia-tesla-k80</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This directive is only used by certain executors. Refer to the
<a class="reference internal" href="executor.html#executor-page"><span class="std std-ref">Executors</span></a> page to see which executors support this directive.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The accelerator <code class="docutils literal notranslate"><span class="pre">type</span></code> option depends on the target execution platform. Refer to the
platform-specific documentation for details on the available accelerators:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://aws.amazon.com/batch/faqs/?#GPU_Scheduling_">AWS</a></p></li>
<li><p><a class="reference external" href="https://cloud.google.com/compute/docs/gpus/">Google Cloud</a></p></li>
<li><p><a class="reference external" href="https://kubernetes.io/docs/tasks/manage-gpus/scheduling-gpus/#clusters-containing-different-types-of-gpus">Kubernetes</a></p></li>
</ul>
</div>
</section>
<section id="afterscript">
<span id="process-afterscript"></span><h3>afterScript<a class="headerlink" href="#afterscript" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">afterScript</span></code> directive allows you to execute a custom (Bash) snippet immediately <em>after</em> the main process has run.
This may be useful to clean up your staging area.</p>
</section>
<section id="beforescript">
<span id="process-beforescript"></span><h3>beforeScript<a class="headerlink" href="#beforescript" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">beforeScript</span></code> directive allows you to execute a custom (Bash) snippet <em>before</em> the main process script is run.
This may be useful to initialise the underlying cluster environment or for other custom initialisation.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
  <span class="n">beforeScript</span> <span class="s1">&#39;source /cluster/bin/setup&#39;</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  echo bar</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="cache">
<span id="process-cache"></span><h3>cache<a class="headerlink" href="#cache" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cache</span></code> directive allows you to store the process results to a local cache. When the cache is enabled <em>and</em>
the pipeline is launched with the <a class="reference internal" href="getstarted.html#getstarted-resume"><span class="std std-ref">resume</span></a> option, any following attempt to execute the process,
along with the same inputs, will cause the process execution to be skipped, producing the stored data as
the actual results.</p>
<p>The caching feature generates a unique <cite>key</cite> by indexing the process script and inputs. This key is used
to identify univocally the outputs produced by the process execution.</p>
<p>The cache is enabled by default, you can disable it for a specific process by setting the <code class="docutils literal notranslate"><span class="pre">cache</span></code>
directive to <code class="docutils literal notranslate"><span class="pre">false</span></code>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">noCacheThis</span> <span class="p">{</span>
  <span class="n">cache</span> <span class="n">false</span>

  <span class="n">script</span><span class="p">:</span>
  <span class="o">&lt;</span><span class="n">your</span> <span class="n">command</span> <span class="n">string</span> <span class="n">here</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">cache</span></code> directive possible values are shown in the following table:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 9%" />
<col style="width: 91%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
<td><p>Disable cache feature.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">true</span></code> (default)</p></td>
<td><p>Enable caching. Cache keys are created indexing input files meta-data information (name, size and last update timestamp attributes).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'deep'</span></code></p></td>
<td><p>Enable caching. Cache keys are created indexing input files content.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'lenient'</span></code></p></td>
<td><p>Enable caching. Cache keys are created indexing input files path and size attributes (this policy provides a workaround for incorrect caching invalidation observed on shared file systems due to inconsistent files timestamps).</p></td>
</tr>
</tbody>
</table>
</section>
<section id="clusteroptions">
<span id="process-clusteroptions"></span><h3>clusterOptions<a class="headerlink" href="#clusteroptions" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">clusterOptions</span></code> directive allows the usage of any <cite>native</cite> configuration option accepted by your cluster submit command.
You can use it to request non-standard resources or use settings that are specific to your cluster and not supported
out of the box by Nextflow.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This directive is only used by grid executors. Refer to the
<a class="reference internal" href="executor.html#executor-page"><span class="std std-ref">Executors</span></a> page to see which executors support this directive.</p>
</div>
</section>
<section id="conda">
<span id="process-conda"></span><h3>conda<a class="headerlink" href="#conda" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">conda</span></code> directive allows for the definition of the process dependencies using the <a class="reference external" href="https://conda.io">Conda</a>
package manager.</p>
<p>Nextflow automatically sets up an environment for the given package names listed by in the <code class="docutils literal notranslate"><span class="pre">conda</span></code> directive.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
  <span class="n">conda</span> <span class="s1">&#39;bwa=0.7.15&#39;</span>

  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  your_command --here</span>
<span class="sd">  &#39;&#39;&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Multiple packages can be specified separating them with a blank space eg. <code class="docutils literal notranslate"><span class="pre">bwa=0.7.15</span> <span class="pre">fastqc=0.11.5</span></code>.
The name of the channel from where a specific package needs to be downloaded can be specified using the usual
Conda notation i.e. prefixing the package with the channel name as shown here <code class="docutils literal notranslate"><span class="pre">bioconda::bwa=0.7.15</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">conda</span></code> directory also allows the specification of a Conda environment file
path or the path of an existing environment directory. See the <a class="reference internal" href="conda.html#conda-page"><span class="std std-ref">Conda environments</span></a> page for further details.</p>
</section>
<section id="container">
<span id="process-container"></span><h3>container<a class="headerlink" href="#container" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">container</span></code> directive allows you to execute the process script in a <a class="reference external" href="http://docker.io">Docker</a> container.</p>
<p>It requires the Docker daemon to be running in machine where the pipeline is executed, i.e. the local machine when using the
<em>local</em> executor or the cluster nodes when the pipeline is deployed through a <em>grid</em> executor.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">runThisInDocker</span> <span class="p">{</span>
  <span class="n">container</span> <span class="s1">&#39;dockerbox:tag&#39;</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &lt;your holy script here&gt;</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Simply replace in the above script <code class="docutils literal notranslate"><span class="pre">dockerbox:tag</span></code> with the name of the Docker image you want to use.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Containers are a very useful way to execute your scripts in a reproducible self-contained environment or to run your pipeline in the cloud.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This directive is ignored for processes that are <a class="reference internal" href="#process-native"><span class="std std-ref">executed natively</span></a>.</p>
</div>
</section>
<section id="containeroptions">
<span id="process-containeroptions"></span><h3>containerOptions<a class="headerlink" href="#containeroptions" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">containerOptions</span></code> directive allows you to specify any container execution option supported by the underlying
container engine (ie. Docker, Singularity, etc). This can be useful to provide container settings
only for a specific process e.g. mount a custom path:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">runThisWithDocker</span> <span class="p">{</span>
    <span class="n">container</span> <span class="s1">&#39;busybox:latest&#39;</span>
    <span class="n">containerOptions</span> <span class="s1">&#39;--volume /data/db:/db&#39;</span>

    <span class="n">output</span><span class="p">:</span>
    <span class="n">path</span> <span class="s1">&#39;output.txt&#39;</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    your_command --data /db &gt; output.txt</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This feature is not supported by the <a class="reference internal" href="executor.html#k8s-executor"><span class="std std-ref">Kubernetes</span></a> and <a class="reference internal" href="executor.html#google-lifesciences-executor"><span class="std std-ref">Google Life Sciences</span></a> executors.</p>
</div>
</section>
<section id="cpus">
<span id="process-cpus"></span><h3>cpus<a class="headerlink" href="#cpus" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cpus</span></code> directive allows you to define the number of (logical) CPU required by the process’ task.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">big_job</span> <span class="p">{</span>
  <span class="n">cpus</span> <span class="mi">8</span>
  <span class="n">executor</span> <span class="s1">&#39;sge&#39;</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  blastp -query input_sequence -num_threads ${task.cpus}</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This directive is required for tasks that execute multi-process or multi-threaded commands/tools and it is meant
to reserve enough CPUs when a pipeline task is executed through a cluster resource manager.</p>
<p>See also: <a class="reference internal" href="#penv">penv</a>, <a class="reference internal" href="#memory">memory</a>, <a class="reference internal" href="#time">time</a>, <a class="reference internal" href="#queue">queue</a>, <a class="reference internal" href="#maxforks">maxForks</a></p>
</section>
<section id="debug">
<span id="process-debug"></span><h3>debug<a class="headerlink" href="#debug" title="Permalink to this headline"></a></h3>
<p>By default the <code class="docutils literal notranslate"><span class="pre">stdout</span></code> produced by the commands executed in all processes is ignored.
By setting the <code class="docutils literal notranslate"><span class="pre">debug</span></code> directive to <code class="docutils literal notranslate"><span class="pre">true</span></code>, you can forward the process <code class="docutils literal notranslate"><span class="pre">stdout</span></code> to the current top
running process <code class="docutils literal notranslate"><span class="pre">stdout</span></code> file, showing it in the shell terminal.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">sayHello</span> <span class="p">{</span>
  <span class="n">debug</span> <span class="n">true</span>

  <span class="n">script</span><span class="p">:</span>
  <span class="s2">&quot;echo Hello&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hello</span>
</pre></div>
</div>
<p>Without specifying <code class="docutils literal notranslate"><span class="pre">debug</span> <span class="pre">true</span></code>, you won’t see the <code class="docutils literal notranslate"><span class="pre">Hello</span></code> string printed out when executing the above example.</p>
</section>
<section id="disk">
<span id="process-disk"></span><h3>disk<a class="headerlink" href="#disk" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">disk</span></code> directive allows you to define how much local disk storage the process is allowed to use. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">big_job</span> <span class="p">{</span>
    <span class="n">disk</span> <span class="s1">&#39;2 GB&#39;</span>
    <span class="n">executor</span> <span class="s1">&#39;cirrus&#39;</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    your task script here</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following memory unit suffix can be used when specifying the disk value:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>B</p></td>
<td><p>Bytes</p></td>
</tr>
<tr class="row-odd"><td><p>KB</p></td>
<td><p>Kilobytes</p></td>
</tr>
<tr class="row-even"><td><p>MB</p></td>
<td><p>Megabytes</p></td>
</tr>
<tr class="row-odd"><td><p>GB</p></td>
<td><p>Gigabytes</p></td>
</tr>
<tr class="row-even"><td><p>TB</p></td>
<td><p>Terabytes</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This directive is only used by certain executors. Refer to the
<a class="reference internal" href="executor.html#executor-page"><span class="std std-ref">Executors</span></a> page to see which executors support this directive.</p>
</div>
<p>See also: <a class="reference internal" href="#cpus">cpus</a>, <a class="reference internal" href="#memory">memory</a> <a class="reference internal" href="#time">time</a>, <a class="reference internal" href="#queue">queue</a> and <a class="reference internal" href="#dynamic-computing-resources">Dynamic computing resources</a>.</p>
</section>
<section id="echo">
<span id="process-echo"></span><h3>echo<a class="headerlink" href="#echo" title="Permalink to this headline"></a></h3>
<p>As of version 22.04.0, <code class="docutils literal notranslate"><span class="pre">echo</span></code> has been deprecated and replaced by <code class="docutils literal notranslate"><span class="pre">debug</span></code>.</p>
</section>
<section id="errorstrategy">
<span id="process-error-strategy"></span><h3>errorStrategy<a class="headerlink" href="#errorstrategy" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">errorStrategy</span></code> directive allows you to define how an error condition is managed by the process. By default when
an error status is returned by the executed script, the process stops immediately. This in turn forces the entire pipeline
to terminate.</p>
<p>Table of available error strategies:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 89%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Executor</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">terminate</span></code></p></td>
<td><p>Terminates the execution as soon as an error condition is reported. Pending jobs are killed (default)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">finish</span></code></p></td>
<td><p>Initiates an orderly pipeline shutdown when an error condition is raised, waiting the completion of any submitted job.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ignore</span></code></p></td>
<td><p>Ignores processes execution errors.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">retry</span></code></p></td>
<td><p>Re-submit for execution a process returning an error condition.</p></td>
</tr>
</tbody>
</table>
<p>When setting the <code class="docutils literal notranslate"><span class="pre">errorStrategy</span></code> directive to <code class="docutils literal notranslate"><span class="pre">ignore</span></code> the process doesn’t stop on an error condition,
it just reports a message notifying you of the error event.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">ignoreAnyError</span> <span class="p">{</span>
  <span class="n">errorStrategy</span> <span class="s1">&#39;ignore&#39;</span>

  <span class="n">script</span><span class="p">:</span>
  <span class="o">&lt;</span><span class="n">your</span> <span class="n">command</span> <span class="n">string</span> <span class="n">here</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By definition, a command script fails when it ends with a non-zero exit status.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">retry</span></code> error strategy allows you to re-submit for execution a process
returning an error condition. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">retryIfFail</span> <span class="p">{</span>
  <span class="n">errorStrategy</span> <span class="s1">&#39;retry&#39;</span>

  <span class="n">script</span><span class="p">:</span>
  <span class="o">&lt;</span><span class="n">your</span> <span class="n">command</span> <span class="n">string</span> <span class="n">here</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The number of times a failing process is re-executed is defined by the <a class="reference internal" href="#maxretries">maxRetries</a> and <a class="reference internal" href="#maxerrors">maxErrors</a> directives.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>More complex strategies depending on the task exit status
or other parametric values can be defined using a dynamic <code class="docutils literal notranslate"><span class="pre">errorStrategy</span></code>.
See the <a class="reference internal" href="#dynamic-directives">Dynamic directives</a> section for details.</p>
</div>
<p>See also: <a class="reference internal" href="#maxerrors">maxErrors</a>, <a class="reference internal" href="#maxretries">maxRetries</a> and <a class="reference internal" href="#dynamic-computing-resources">Dynamic computing resources</a>.</p>
</section>
<section id="executor">
<span id="process-executor"></span><h3>executor<a class="headerlink" href="#executor" title="Permalink to this headline"></a></h3>
<p>The <cite>executor</cite> defines the underlying system where processes are executed. By default a process uses the executor
defined globally in the <code class="docutils literal notranslate"><span class="pre">nextflow.config</span></code> file.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">executor</span></code> directive allows you to configure what executor has to be used by the process, overriding the default
configuration. The following values can be used:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Executor</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">awsbatch</span></code></p></td>
<td><p>The process is executed using the <a class="reference external" href="https://aws.amazon.com/batch/">AWS Batch</a> service.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">azurebatch</span></code></p></td>
<td><p>The process is executed using the <a class="reference external" href="https://azure.microsoft.com/en-us/services/batch/">Azure Batch</a> service.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">condor</span></code></p></td>
<td><p>The process is executed using the <a class="reference external" href="https://research.cs.wisc.edu/htcondor/">HTCondor</a> job scheduler.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">google-lifesciences</span></code></p></td>
<td><p>The process is executed using the <a class="reference external" href="https://cloud.google.com/life-sciences">Google Genomics Pipelines</a> service.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ignite</span></code></p></td>
<td><p>The process is executed using the <a class="reference external" href="https://ignite.apache.org/">Apache Ignite</a> cluster.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">k8s</span></code></p></td>
<td><p>The process is executed using the <a class="reference external" href="https://kubernetes.io/">Kubernetes</a> cluster.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">local</span></code></p></td>
<td><p>The process is executed in the computer where <cite>Nextflow</cite> is launched.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lsf</span></code></p></td>
<td><p>The process is executed using the <a class="reference external" href="http://en.wikipedia.org/wiki/Platform_LSF">Platform LSF</a> job scheduler.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">moab</span></code></p></td>
<td><p>The process is executed using the <a class="reference external" href="http://www.adaptivecomputing.com/moab-hpc-basic-edition/">Moab</a> job scheduler.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">nqsii</span></code></p></td>
<td><p>The process is executed using the <a class="reference external" href="https://www.rz.uni-kiel.de/en/our-portfolio/hiperf/nec-linux-cluster">NQSII</a> job scheduler.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">oge</span></code></p></td>
<td><p>Alias for the <code class="docutils literal notranslate"><span class="pre">sge</span></code> executor.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pbs</span></code></p></td>
<td><p>The process is executed using the <a class="reference external" href="http://en.wikipedia.org/wiki/Portable_Batch_System">PBS/Torque</a> job scheduler.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pbspro</span></code></p></td>
<td><p>The process is executed using the <a class="reference external" href="https://www.pbsworks.com/">PBS Pro</a> job scheduler.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sge</span></code></p></td>
<td><p>The process is executed using the Sun Grid Engine / <a class="reference external" href="http://gridscheduler.sourceforge.net/">Open Grid Engine</a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">slurm</span></code></p></td>
<td><p>The process is executed using the SLURM job scheduler.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">tes</span></code></p></td>
<td><p>The process is executed using the <a class="reference external" href="https://github.com/ga4gh/task-execution-schemas">GA4GH TES</a> service.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">uge</span></code></p></td>
<td><p>Alias for the <code class="docutils literal notranslate"><span class="pre">sge</span></code> executor.</p></td>
</tr>
</tbody>
</table>
<p>The following example shows how to set the process’s executor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">doSomething</span> <span class="p">{</span>
  <span class="n">executor</span> <span class="s1">&#39;sge&#39;</span>

  <span class="n">script</span><span class="p">:</span>
  <span class="o">&lt;</span><span class="n">your</span> <span class="n">script</span> <span class="n">here</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Each executor supports additional directives and <code class="docutils literal notranslate"><span class="pre">executor</span></code> configuration options. Refer to the
<a class="reference internal" href="executor.html#executor-page"><span class="std std-ref">Executors</span></a> page to see what each executor supports.</p>
</div>
</section>
<section id="ext">
<span id="process-ext"></span><h3>ext<a class="headerlink" href="#ext" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">ext</span></code> is a special directive used as <em>namespace</em> for user custom process directives. This can be useful for
advanced configuration options. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">mapping</span> <span class="p">{</span>
  <span class="n">container</span> <span class="s2">&quot;biocontainers/star:$</span><span class="si">{task.ext.version}</span><span class="s2">&quot;</span>

  <span class="nb">input</span><span class="p">:</span>
  <span class="n">path</span> <span class="n">genome</span> <span class="kn">from</span> <span class="nn">genome_file</span>
  <span class="nb">tuple</span> <span class="n">val</span><span class="p">(</span><span class="n">sampleId</span><span class="p">),</span> <span class="n">path</span><span class="p">(</span><span class="n">reads</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">reads_ch</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  STAR --genomeDir $genome --readFilesIn $reads</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above example, the process uses a container whose version is controlled by the <code class="docutils literal notranslate"><span class="pre">ext.version</span></code> property.
This can be defined in the <code class="docutils literal notranslate"><span class="pre">nextflow.config</span></code> file as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;2.5.3&#39;</span>
</pre></div>
</div>
</section>
<section id="label">
<span id="process-label"></span><h3>label<a class="headerlink" href="#label" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">label</span></code> directive allows the annotation of processes with mnemonic identifier of your choice.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">bigTask</span> <span class="p">{</span>
  <span class="n">label</span> <span class="s1">&#39;big_mem&#39;</span>

  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  &lt;task script&gt;</span>
<span class="sd">  &#39;&#39;&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The same label can be applied to more than a process and multiple labels can be applied to the same
process using the <code class="docutils literal notranslate"><span class="pre">label</span></code> directive more than one time.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A label must consist of alphanumeric characters or <code class="docutils literal notranslate"><span class="pre">_</span></code>, must start with an alphabetic character
and must end with an alphanumeric character.</p>
</div>
<p>Labels are useful to organise workflow processes in separate groups which can be referenced
in the configuration file to select and configure subset of processes having similar computing requirements.</p>
<p>See the <a class="reference internal" href="config.html#config-process-selectors"><span class="std std-ref">Process selectors</span></a> documentation for details.</p>
</section>
<section id="machinetype">
<span id="process-machinetype"></span><h3>machineType<a class="headerlink" href="#machinetype" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">machineType</span></code> can be used to specify a predefined Google Compute Platform <a class="reference external" href="https://cloud.google.com/compute/docs/machine-types">machine type</a>
when running using the <a class="reference internal" href="executor.html#google-lifesciences-executor"><span class="std std-ref">Google Life Sciences</span></a> executor.</p>
<p>This directive is optional and if specified overrides the cpus and memory directives:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
  <span class="n">machineType</span> <span class="s1">&#39;n1-highmem-8&#39;</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &lt;your script here&gt;</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This feature requires Nextflow 19.07.0 or later.</p>
</div>
<p>See also: <a class="reference internal" href="#cpus">cpus</a> and <a class="reference internal" href="#memory">memory</a>.</p>
</section>
<section id="maxerrors">
<span id="process-maxerrors"></span><h3>maxErrors<a class="headerlink" href="#maxerrors" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">maxErrors</span></code> directive allows you to specify the maximum number of times a process can fail when using the <code class="docutils literal notranslate"><span class="pre">retry</span></code> <cite>error strategy</cite>.
By default this directive is disabled, you can set it as shown in the example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">retryIfFail</span> <span class="p">{</span>
  <span class="n">errorStrategy</span> <span class="s1">&#39;retry&#39;</span>
  <span class="n">maxErrors</span> <span class="mi">5</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  echo &#39;do this as that .. &#39;</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This setting considers the <strong>total</strong> errors accumulated for a given process, across all instances. If you want
to control the number of times a process <strong>instance</strong> (aka task) can fail, use <code class="docutils literal notranslate"><span class="pre">maxRetries</span></code>.</p>
</div>
<p>See also: <a class="reference internal" href="#errorstrategy">errorStrategy</a> and <a class="reference internal" href="#maxretries">maxRetries</a>.</p>
</section>
<section id="maxforks">
<span id="process-maxforks"></span><h3>maxForks<a class="headerlink" href="#maxforks" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">maxForks</span></code> directive allows you to define the maximum number of process instances that can be executed in parallel.
By default this value is equals to the number of CPU cores available minus 1.</p>
<p>If you want to execute a process in a sequential manner, set this directive to one. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">doNotParallelizeIt</span> <span class="p">{</span>
  <span class="n">maxForks</span> <span class="mi">1</span>

  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  &lt;your script here&gt;</span>
<span class="sd">  &#39;&#39;&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="maxretries">
<span id="process-maxretries"></span><h3>maxRetries<a class="headerlink" href="#maxretries" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">maxRetries</span></code> directive allows you to define the maximum number of times a process instance can be
re-submitted in case of failure. This value is applied only when using the <code class="docutils literal notranslate"><span class="pre">retry</span></code> <cite>error strategy</cite>. By default
only one retry is allowed, you can increase this value as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">retryIfFail</span> <span class="p">{</span>
    <span class="n">errorStrategy</span> <span class="s1">&#39;retry&#39;</span>
    <span class="n">maxRetries</span> <span class="mi">3</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    echo &#39;do this as that .. &#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a subtle but important difference between <code class="docutils literal notranslate"><span class="pre">maxRetries</span></code> and the <code class="docutils literal notranslate"><span class="pre">maxErrors</span></code> directive.
The latter defines the total number of errors that are allowed during the process execution (the same process can
launch different execution instances), while the <code class="docutils literal notranslate"><span class="pre">maxRetries</span></code> defines the maximum number of times the same process
execution can be retried in case of an error.</p>
</div>
<p>See also: <a class="reference internal" href="#errorstrategy">errorStrategy</a> and <a class="reference internal" href="#maxerrors">maxErrors</a>.</p>
</section>
<section id="memory">
<span id="process-memory"></span><h3>memory<a class="headerlink" href="#memory" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">memory</span></code> directive allows you to define how much memory the process is allowed to use. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">big_job</span> <span class="p">{</span>
    <span class="n">memory</span> <span class="s1">&#39;2 GB&#39;</span>
    <span class="n">executor</span> <span class="s1">&#39;sge&#39;</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    your task script here</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following memory unit suffix can be used when specifying the memory value:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>B</p></td>
<td><p>Bytes</p></td>
</tr>
<tr class="row-odd"><td><p>KB</p></td>
<td><p>Kilobytes</p></td>
</tr>
<tr class="row-even"><td><p>MB</p></td>
<td><p>Megabytes</p></td>
</tr>
<tr class="row-odd"><td><p>GB</p></td>
<td><p>Gigabytes</p></td>
</tr>
<tr class="row-even"><td><p>TB</p></td>
<td><p>Terabytes</p></td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#cpus">cpus</a>, <a class="reference internal" href="#time">time</a>, <a class="reference internal" href="#queue">queue</a> and <a class="reference internal" href="#dynamic-computing-resources">Dynamic computing resources</a>.</p>
</section>
<section id="module">
<span id="process-module"></span><h3>module<a class="headerlink" href="#module" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="http://modules.sourceforge.net/">Environment Modules</a> is a package manager that allows you to dynamically configure
your execution environment and easily switch between multiple versions of the same software tool.</p>
<p>If it is available in your system you can use it with Nextflow in order to configure the processes execution
environment in your pipeline.</p>
<p>In a process definition you can use the <code class="docutils literal notranslate"><span class="pre">module</span></code> directive to load a specific module version to be used in the
process execution environment. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">basicExample</span> <span class="p">{</span>
  <span class="n">module</span> <span class="s1">&#39;ncbi-blast/2.2.27&#39;</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  blastp -query &lt;etc..&gt;</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can repeat the <code class="docutils literal notranslate"><span class="pre">module</span></code> directive for each module you need to load. Alternatively multiple modules
can be specified in a single <code class="docutils literal notranslate"><span class="pre">module</span></code> directive by separating all the module names by using a <code class="docutils literal notranslate"><span class="pre">:</span></code>
(colon) character as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">process</span> <span class="n">manyModules</span> <span class="p">{</span>

   <span class="n">module</span> <span class="s1">&#39;ncbi-blast/2.2.27:t_coffee/10.0:clustalw/2.1&#39;</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   blastp -query &lt;etc..&gt;</span>
<span class="sd">   &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="penv">
<span id="process-penv"></span><h3>penv<a class="headerlink" href="#penv" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">penv</span></code> directive  allows you to define the <cite>parallel environment</cite> to be used when submitting a parallel task to the
<a class="reference internal" href="executor.html#sge-executor"><span class="std std-ref">SGE</span></a> resource manager. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">big_job</span> <span class="p">{</span>
  <span class="n">cpus</span> <span class="mi">4</span>
  <span class="n">penv</span> <span class="s1">&#39;smp&#39;</span>
  <span class="n">executor</span> <span class="s1">&#39;sge&#39;</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  blastp -query input_sequence -num_threads ${task.cpus}</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This configuration depends on the parallel environment provided by your grid engine installation. Refer to your
cluster documentation or contact your admin to learn more about this.</p>
<p>See also: <a class="reference internal" href="#cpus">cpus</a>, <a class="reference internal" href="#memory">memory</a>, <a class="reference internal" href="#time">time</a></p>
</section>
<section id="pod">
<span id="process-pod"></span><h3>pod<a class="headerlink" href="#pod" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">pod</span></code> directive allows the definition of pods specific settings, such as environment variables, secrets
and config maps when using the <a class="reference internal" href="executor.html#k8s-executor"><span class="std std-ref">Kubernetes</span></a> executor.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">your_task</span> <span class="p">{</span>
  <span class="n">pod</span> <span class="n">env</span><span class="p">:</span> <span class="s1">&#39;FOO&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span>

  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  echo $FOO</span>
<span class="sd">  &#39;&#39;&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above snippet defines an environment variable named <code class="docutils literal notranslate"><span class="pre">FOO</span></code> which value is <code class="docutils literal notranslate"><span class="pre">bar</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pod</span></code> directive allows the definition of the following options:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">label:</span> <span class="pre">&lt;K&gt;,</span> <span class="pre">value:</span> <span class="pre">&lt;V&gt;</span></code></p></td>
<td><p>Defines a pod label with key <code class="docutils literal notranslate"><span class="pre">K</span></code> and value <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">annotation:</span> <span class="pre">&lt;K&gt;,</span> <span class="pre">value:</span> <span class="pre">&lt;V&gt;</span></code></p></td>
<td><p>Defines a pod annotation with key <code class="docutils literal notranslate"><span class="pre">K</span></code> and value <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">env:</span> <span class="pre">&lt;E&gt;,</span> <span class="pre">value:</span> <span class="pre">&lt;V&gt;</span></code></p></td>
<td><p>Defines an environment variable with name <code class="docutils literal notranslate"><span class="pre">E</span></code> and whose value is given by the <code class="docutils literal notranslate"><span class="pre">V</span></code> string.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">env:</span> <span class="pre">&lt;E&gt;,</span> <span class="pre">fieldPath:</span> <span class="pre">&lt;V&gt;</span></code></p></td>
<td><p>Defines an environment variable with name <code class="docutils literal notranslate"><span class="pre">E</span></code> and whose value is given by the <code class="docutils literal notranslate"><span class="pre">V</span></code> <a class="reference external" href="https://kubernetes.io/docs/tasks/inject-data-application/environment-variable-expose-pod-information/">field path</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">env:</span> <span class="pre">&lt;E&gt;,</span> <span class="pre">config:</span> <span class="pre">&lt;C/K&gt;</span></code></p></td>
<td><p>Defines an environment variable with name <code class="docutils literal notranslate"><span class="pre">E</span></code> and whose value is given by the entry associated to the key with name <code class="docutils literal notranslate"><span class="pre">K</span></code> in the <a class="reference external" href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/">ConfigMap</a> with name <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">env:</span> <span class="pre">&lt;E&gt;,</span> <span class="pre">secret:</span> <span class="pre">&lt;S/K&gt;</span></code></p></td>
<td><p>Defines an environment variable with name <code class="docutils literal notranslate"><span class="pre">E</span></code> and whose value is given by the entry associated to the key with name <code class="docutils literal notranslate"><span class="pre">K</span></code> in the <a class="reference external" href="https://kubernetes.io/docs/concepts/configuration/secret/">Secret</a> with name <code class="docutils literal notranslate"><span class="pre">S</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">config:</span> <span class="pre">&lt;C/K&gt;,</span> <span class="pre">mountPath:</span> <span class="pre">&lt;/absolute/path&gt;</span></code></p></td>
<td><p>The content of the <a class="reference external" href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/">ConfigMap</a> with name <code class="docutils literal notranslate"><span class="pre">C</span></code> with key <code class="docutils literal notranslate"><span class="pre">K</span></code> is made available to the path <code class="docutils literal notranslate"><span class="pre">/absolute/path</span></code>. When the key component is omitted the path is interpreted as a directory and all the <code class="docutils literal notranslate"><span class="pre">ConfigMap</span></code> entries are exposed in that path.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">secret:</span> <span class="pre">&lt;S/K&gt;,</span> <span class="pre">mountPath:</span> <span class="pre">&lt;/absolute/path&gt;</span></code></p></td>
<td><p>The content of the <a class="reference external" href="https://kubernetes.io/docs/concepts/configuration/secret/">Secret</a> with name <code class="docutils literal notranslate"><span class="pre">S</span></code> with key <code class="docutils literal notranslate"><span class="pre">K</span></code> is made available to the path <code class="docutils literal notranslate"><span class="pre">/absolute/path</span></code>. When the key component is omitted the path is interpreted as a directory and all the <code class="docutils literal notranslate"><span class="pre">Secret</span></code> entries are exposed in that path.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">volumeClaim:</span> <span class="pre">&lt;V&gt;,</span> <span class="pre">mountPath:</span> <span class="pre">&lt;/absolute/path&gt;</span></code></p></td>
<td><p>Mounts a <a class="reference external" href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">Persistent volume claim</a> with name <code class="docutils literal notranslate"><span class="pre">V</span></code> to the specified path location. Use the optional <code class="docutils literal notranslate"><span class="pre">subPath</span></code> parameter to mount a directory inside the referenced volume instead of its root. The volume may be mounted with <cite>readOnly: true</cite>, but is read/write by default.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">imagePullPolicy:</span> <span class="pre">&lt;V&gt;</span></code></p></td>
<td><p>Specifies the strategy to be used to pull the container image e.g. <code class="docutils literal notranslate"><span class="pre">imagePullPolicy:</span> <span class="pre">'Always'</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">imagePullSecret:</span> <span class="pre">&lt;V&gt;</span></code></p></td>
<td><p>Specifies the secret name to access a private container image registry. See <a class="reference external" href="https://kubernetes.io/docs/concepts/containers/images/#specifying-imagepullsecrets-on-a-pod">Kubernetes documentation</a> for details.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">runAsUser:</span> <span class="pre">&lt;UID&gt;</span></code></p></td>
<td><p>Specifies the user ID to be used to run the container. Shortcut for the <code class="docutils literal notranslate"><span class="pre">securityContext</span></code> option.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">securityContext:</span> <span class="pre">&lt;V&gt;</span></code></p></td>
<td><p>Specifies the pod security context. See <a class="reference external" href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/">Kubernetes security context</a> for details.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">nodeSelector:</span> <span class="pre">&lt;V&gt;</span></code></p></td>
<td><p>Specifies which node the process will run on. See <a class="reference external" href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector">Kubernetes nodeSelector</a> for details.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">affinity:</span> <span class="pre">&lt;V&gt;</span></code></p></td>
<td><p>Specifies affinity for which nodes the process should run on. See <a class="reference external" href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity">Kubernetes affinity</a> for details.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">automountServiceAccountToken:</span> <span class="pre">&lt;V&gt;</span></code></p></td>
<td><p>Specifies whether to <a class="reference external" href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/">automount service account token</a> into process pods. If <code class="docutils literal notranslate"><span class="pre">V</span></code> is true, service account token is automounted into task pods (default).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">priorityClassName:</span> <span class="pre">&lt;V&gt;</span></code></p></td>
<td><p>Specifies the <a class="reference external" href="https://kubernetes.io/docs/concepts/scheduling-eviction/pod-priority-preemption/">priority class name</a> for pods.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">toleration:</span> <span class="pre">&lt;V&gt;</span></code></p></td>
<td><p>Specifies a toleration for a node taint. See <a class="reference external" href="https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/">Taints and Tolerations</a> for details.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">privileged:</span> <span class="pre">&lt;B&gt;</span></code></p></td>
<td><p>Whenever the process task should run as a <em>privileged</em> container (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>)</p></td>
</tr>
</tbody>
</table>
<p>When defined in the Nextflow configuration file, a pod setting can be defined using the canonical
associative array syntax. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="p">{</span>
  <span class="n">pod</span> <span class="o">=</span> <span class="p">[</span><span class="n">env</span><span class="p">:</span> <span class="s1">&#39;FOO&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When more than one setting needs to be provides they must be enclosed in a list definition as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="p">{</span>
  <span class="n">pod</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="n">env</span><span class="p">:</span> <span class="s1">&#39;FOO&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">secret</span><span class="p">:</span> <span class="s1">&#39;my-secret/key1&#39;</span><span class="p">,</span> <span class="n">mountPath</span><span class="p">:</span> <span class="s1">&#39;/etc/file.txt&#39;</span><span class="p">]</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Some settings, including environment variables, configs, secrets, volume claims, and tolerations, can be specified multiple times for different values.</p>
</section>
<section id="publishdir">
<span id="process-publishdir"></span><h3>publishDir<a class="headerlink" href="#publishdir" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">publishDir</span></code> directive allows you to publish the process output files to a specified folder. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
    <span class="n">publishDir</span> <span class="s1">&#39;/data/chunks&#39;</span>

    <span class="n">output</span><span class="p">:</span>
    <span class="n">path</span> <span class="s1">&#39;chunk_*&#39;</span> <span class="n">into</span> <span class="n">letters</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    printf &#39;Hola&#39; | split -b 1 - chunk_</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above example splits the string <code class="docutils literal notranslate"><span class="pre">Hola</span></code> into file chunks of a single byte. When complete the <code class="docutils literal notranslate"><span class="pre">chunk_*</span></code> output files
are published into the <code class="docutils literal notranslate"><span class="pre">/data/chunks</span></code> folder.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only files that match the declaration in the <code class="docutils literal notranslate"><span class="pre">output:</span></code> block are published, not all the outputs of the process.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <code class="docutils literal notranslate"><span class="pre">publishDir</span></code> directive can be specified more than once in order to publish output files
to different target directories based on different rules.</p>
</div>
<p>By default files are published to the target folder creating a <em>symbolic link</em> for each process output that links
the file produced into the process working directory. This behavior can be modified using the <code class="docutils literal notranslate"><span class="pre">mode</span></code> parameter.</p>
<p>Table of optional parameters that can be used with the <code class="docutils literal notranslate"><span class="pre">publishDir</span></code> directive:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 93%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>mode</p></td>
<td><p>The file publishing method. See the following table for possible values.</p></td>
</tr>
<tr class="row-odd"><td><p>overwrite</p></td>
<td><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> any existing file in the specified folder will be overridden (default: <code class="docutils literal notranslate"><span class="pre">true</span></code> during normal
pipeline execution and <code class="docutils literal notranslate"><span class="pre">false</span></code> when pipeline execution is <cite>resumed</cite>).</p></td>
</tr>
<tr class="row-even"><td><p>pattern</p></td>
<td><p>Specifies a <a class="reference external" href="http://docs.oracle.com/javase/tutorial/essential/io/fileOps.html#glob">glob</a> file pattern that selects which files to publish from the overall set of output files.</p></td>
</tr>
<tr class="row-odd"><td><p>path</p></td>
<td><p>Specifies the directory where files need to be published. <strong>Note</strong>: the syntax <code class="docutils literal notranslate"><span class="pre">publishDir</span> <span class="pre">'/some/dir'</span></code> is a shortcut for <code class="docutils literal notranslate"><span class="pre">publishDir</span> <span class="pre">path:</span> <span class="pre">'/some/dir'</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>saveAs</p></td>
<td><p>A closure which, given the name of the file being published, returns the actual file name or a full path where the file is required to be stored.
This can be used to rename or change the destination directory of the published files dynamically by using
a custom strategy.
Return the value <code class="docutils literal notranslate"><span class="pre">null</span></code> from the closure to <em>not</em> publish a file.
This is useful when the process has multiple output files, but you want to publish only some of them.</p></td>
</tr>
<tr class="row-odd"><td><p>enabled</p></td>
<td><p>Enable or disable the publish rule depending on the boolean value specified (default: <code class="docutils literal notranslate"><span class="pre">true</span></code>).</p></td>
</tr>
<tr class="row-even"><td><p>tags</p></td>
<td><p>Allow to associate tags with the target file e.g. <code class="docutils literal notranslate"><span class="pre">tag:</span> <span class="pre">[FOO:</span> <span class="pre">'Hello</span> <span class="pre">world']</span></code> (EXPERIMENTAL, currently only supported by files stored on AWS S3, requires version <code class="docutils literal notranslate"><span class="pre">21.12.0-edge</span></code> or later).</p></td>
</tr>
<tr class="row-odd"><td><p>failOnError</p></td>
<td><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> abort the execution if some file can’t be published to the specified target directory or bucket for any cause (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>)</p></td>
</tr>
</tbody>
</table>
<p>Table of publish modes:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 93%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Mode</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>symlink</p></td>
<td><p>Creates an absolute <cite>symbolic link</cite> in the published directory for each process output file (default).</p></td>
</tr>
<tr class="row-odd"><td><p>rellink</p></td>
<td><p>Creates a relative <cite>symbolic link</cite> in the published directory for each process output file.</p></td>
</tr>
<tr class="row-even"><td><p>link</p></td>
<td><p>Creates a <cite>hard link</cite> in the published directory for each process output file.</p></td>
</tr>
<tr class="row-odd"><td><p>copy</p></td>
<td><p>Copies the output files into the published directory.</p></td>
</tr>
<tr class="row-even"><td><p>copyNoFollow</p></td>
<td><p>Copies the output files into the published directory without following symlinks ie. copies the links themselves.</p></td>
</tr>
<tr class="row-odd"><td><p>move</p></td>
<td><p>Moves the output files into the published directory. <strong>Note</strong>: this is only supposed to be used for a <cite>terminating</cite> process i.e. a process whose output is not consumed by any other downstream process.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">mode</span></code> value must be specified as a string literal, i.e. in quotes. Multiple parameters
need to be separated by a colon character. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
    <span class="n">publishDir</span> <span class="s1">&#39;/data/chunks&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="s1">&#39;copy&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="n">false</span>

    <span class="n">output</span><span class="p">:</span>
    <span class="n">path</span> <span class="s1">&#39;chunk_*&#39;</span> <span class="n">into</span> <span class="n">letters</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    printf &#39;Hola&#39; | split -b 1 - chunk_</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Files are copied into the specified directory in an <em>asynchronous</em> manner, so they may not be immediately
available in the published directory at the end of the process execution. For this reason, downstream processes
should not try to access output files through the publish directory, but through channels.</p>
</div>
</section>
<section id="queue">
<span id="process-queue"></span><h3>queue<a class="headerlink" href="#queue" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">queue</span></code> directory allows you to set the <cite>queue</cite> where jobs are scheduled when using a grid based executor
in your pipeline. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">grid_job</span> <span class="p">{</span>
    <span class="n">queue</span> <span class="s1">&#39;long&#39;</span>
    <span class="n">executor</span> <span class="s1">&#39;sge&#39;</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    your task script here</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Multiple queues can be specified by separating their names with a comma for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">grid_job</span> <span class="p">{</span>
    <span class="n">queue</span> <span class="s1">&#39;short,long,cn-el6&#39;</span>
    <span class="n">executor</span> <span class="s1">&#39;sge&#39;</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    your task script here</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This directive is only used by certain executors. Refer to the
<a class="reference internal" href="executor.html#executor-page"><span class="std std-ref">Executors</span></a> page to see which executors support this directive.</p>
</div>
</section>
<section id="scratch">
<span id="process-scratch"></span><h3>scratch<a class="headerlink" href="#scratch" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">scratch</span></code> directive allows you to execute the process in a temporary folder that is local to the execution node.</p>
<p>This is useful when your pipeline is launched by using a <cite>grid</cite> executor, because it allows you to decrease the NFS
overhead by running the pipeline processes in a temporary directory in the local disk of the actual execution node.
Only the files declared as output in the process definition will be copied in the pipeline working area.</p>
<p>In its basic form simply specify <code class="docutils literal notranslate"><span class="pre">true</span></code> at the directive value, as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">simpleTask</span> <span class="p">{</span>
  <span class="n">scratch</span> <span class="n">true</span>

  <span class="n">output</span><span class="p">:</span>
  <span class="n">path</span> <span class="s1">&#39;data_out&#39;</span>

  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  &lt;task script&gt;</span>
<span class="sd">  &#39;&#39;&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>By doing this, it tries to execute the script in the directory defined by the variable <code class="docutils literal notranslate"><span class="pre">$TMPDIR</span></code> in the execution node.
If this variable does not exist, it will create a new temporary directory by using the Linux command <code class="docutils literal notranslate"><span class="pre">mktemp</span></code>.</p>
<p>A custom environment variable, other than <code class="docutils literal notranslate"><span class="pre">$TMPDIR</span></code>, can be specified by simply using it as the scratch value, for
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scratch</span> <span class="s1">&#39;$MY_GRID_TMP&#39;</span>
</pre></div>
</div>
<p>Note, it must be wrapped by single quotation characters, otherwise the variable will be evaluated in the
pipeline script context.</p>
<p>You can also provide a specific folder path as scratch value, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scratch</span> <span class="s1">&#39;/tmp/my/path&#39;</span>
</pre></div>
</div>
<p>By doing this, a new temporary directory will be created in the specified path each time a process is executed.</p>
<p>Finally, when the <code class="docutils literal notranslate"><span class="pre">ram-disk</span></code> string is provided as <code class="docutils literal notranslate"><span class="pre">scratch</span></code> value, the process will be execute in the node
RAM virtual disk.</p>
<p>Summary of allowed values:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 93%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>scratch</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>false</p></td>
<td><p>Do not use the scratch folder.</p></td>
</tr>
<tr class="row-odd"><td><p>true</p></td>
<td><p>Creates a scratch folder in the directory defined by the <code class="docutils literal notranslate"><span class="pre">$TMPDIR</span></code> variable; fallback to <code class="docutils literal notranslate"><span class="pre">mktemp</span> <span class="pre">/tmp</span></code> if that variable do not exists.</p></td>
</tr>
<tr class="row-even"><td><p>$YOUR_VAR</p></td>
<td><p>Creates a scratch folder in the directory defined by the <code class="docutils literal notranslate"><span class="pre">$YOUR_VAR</span></code> environment variable; fallback to <code class="docutils literal notranslate"><span class="pre">mktemp</span> <span class="pre">/tmp</span></code> if that variable do not exists.</p></td>
</tr>
<tr class="row-odd"><td><p>/my/tmp</p></td>
<td><p>Creates a scratch folder in the specified directory.</p></td>
</tr>
<tr class="row-even"><td><p>ram-disk</p></td>
<td><p>Creates a scratch folder in the RAM disk <code class="docutils literal notranslate"><span class="pre">/dev/shm/</span></code> (experimental).</p></td>
</tr>
</tbody>
</table>
</section>
<section id="storedir">
<span id="process-storedir"></span><h3>storeDir<a class="headerlink" href="#storedir" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">storeDir</span></code> directive allows you to define a directory that is used as a <cite>permanent</cite> cache for your process results.</p>
<p>In more detail, it affects the process execution in two main ways:</p>
<ol class="arabic simple">
<li><p>The process is executed only if the files declared in the <code class="docutils literal notranslate"><span class="pre">output</span></code> block do not exist in the directory specified by
the <code class="docutils literal notranslate"><span class="pre">storeDir</span></code> directive. When the files exist the process execution is skipped and these files are used as
the actual process result.</p></li>
<li><p>Whenever a process is successfully completed the files listed in the <code class="docutils literal notranslate"><span class="pre">output</span></code> block are moved into the directory
specified by the <code class="docutils literal notranslate"><span class="pre">storeDir</span></code> directive.</p></li>
</ol>
<p>The following example shows how to use the <code class="docutils literal notranslate"><span class="pre">storeDir</span></code> directive to create a directory containing a BLAST database
for each species specified by an input parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">genomes</span> <span class="o">=</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPath</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">genomes</span><span class="p">)</span>

<span class="n">process</span> <span class="n">formatBlastDatabases</span> <span class="p">{</span>
  <span class="n">storeDir</span> <span class="s1">&#39;/db/genomes&#39;</span>

  <span class="nb">input</span><span class="p">:</span>
  <span class="n">path</span> <span class="n">species</span> <span class="kn">from</span> <span class="nn">genomes</span>

  <span class="n">output</span><span class="p">:</span>
  <span class="n">path</span> <span class="s2">&quot;$</span><span class="si">{dbName}</span><span class="s2">.*&quot;</span> <span class="n">into</span> <span class="n">blastDb</span>

  <span class="n">script</span><span class="p">:</span>
  <span class="n">dbName</span> <span class="o">=</span> <span class="n">species</span><span class="o">.</span><span class="n">baseName</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  makeblastdb -dbtype nucl -in ${species} -out ${dbName}</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">storeDir</span></code> directive is meant for long-term process caching and should not be used to
publish output files or organize outputs into a semantic directory structure. In those cases, use
the <a class="reference internal" href="#publishdir">publishDir</a> directive instead.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The use of AWS S3 paths is supported, however it requires the installation of the <a class="reference external" href="https://aws.amazon.com/cli/">AWS CLI</a>
(i.e. <code class="docutils literal notranslate"><span class="pre">aws</span></code>) in the target compute node.</p>
</div>
</section>
<section id="stageinmode">
<span id="process-stageinmode"></span><h3>stageInMode<a class="headerlink" href="#stageinmode" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">stageInMode</span></code> directive defines how input files are staged-in to the process work directory. The following values
are allowed:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 95%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>copy</p></td>
<td><p>Input files are staged in the process work directory by creating a copy.</p></td>
</tr>
<tr class="row-odd"><td><p>link</p></td>
<td><p>Input files are staged in the process work directory by creating an (hard) link for each of them.</p></td>
</tr>
<tr class="row-even"><td><p>symlink</p></td>
<td><p>Input files are staged in the process work directory by creating a symbolic link with an absolute path for each of them (default).</p></td>
</tr>
<tr class="row-odd"><td><p>rellink</p></td>
<td><p>Input files are staged in the process work directory by creating a symbolic link with a relative path for each of them.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="stageoutmode">
<span id="process-stageoutmode"></span><h3>stageOutMode<a class="headerlink" href="#stageoutmode" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">stageOutMode</span></code> directive defines how output files are staged-out from the scratch directory to the process work
directory. The following values are allowed:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 94%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>copy</p></td>
<td><p>Output files are copied from the scratch directory to the work directory.</p></td>
</tr>
<tr class="row-odd"><td><p>move</p></td>
<td><p>Output files are moved from the scratch directory to the work directory.</p></td>
</tr>
<tr class="row-even"><td><p>rsync</p></td>
<td><p>Output files are copied from the scratch directory to the work directory by using the <code class="docutils literal notranslate"><span class="pre">rsync</span></code> utility.</p></td>
</tr>
</tbody>
</table>
<p>See also: <a class="reference internal" href="#scratch">scratch</a>.</p>
</section>
<section id="tag">
<span id="process-tag"></span><h3>tag<a class="headerlink" href="#tag" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">tag</span></code> directive allows you to associate each process execution with a custom label, so that it will be easier
to identify them in the log file or in the trace execution report. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
  <span class="n">tag</span> <span class="s2">&quot;$code&quot;</span>

  <span class="nb">input</span><span class="p">:</span>
  <span class="n">val</span> <span class="n">code</span> <span class="kn">from</span> <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;omega&#39;</span>

  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  echo $code</span>
<span class="sd">  &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above snippet will print a log similar to the following one, where process names contain the tag value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">6</span><span class="n">e</span><span class="o">/</span><span class="mi">28919</span><span class="n">b</span><span class="p">]</span> <span class="n">Submitted</span> <span class="n">process</span> <span class="o">&gt;</span> <span class="n">foo</span> <span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
<span class="p">[</span><span class="n">d2</span><span class="o">/</span><span class="mi">1</span><span class="n">c6175</span><span class="p">]</span> <span class="n">Submitted</span> <span class="n">process</span> <span class="o">&gt;</span> <span class="n">foo</span> <span class="p">(</span><span class="n">gamma</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="n">c</span><span class="o">/</span><span class="mi">3</span><span class="n">ef220</span><span class="p">]</span> <span class="n">Submitted</span> <span class="n">process</span> <span class="o">&gt;</span> <span class="n">foo</span> <span class="p">(</span><span class="n">omega</span><span class="p">)</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="tracing.html#trace-report"><span class="std std-ref">Trace execution report</span></a></p>
</section>
<section id="time">
<span id="process-time"></span><h3>time<a class="headerlink" href="#time" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">time</span></code> directive allows you to define how long a process is allowed to run. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">big_job</span> <span class="p">{</span>
    <span class="n">time</span> <span class="s1">&#39;1h&#39;</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    your task script here</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following time unit suffixes can be used when specifying the duration value:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms</span></code>, <code class="docutils literal notranslate"><span class="pre">milli</span></code>, <code class="docutils literal notranslate"><span class="pre">millis</span></code></p></td>
<td><p>Milliseconds</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">s</span></code>, <code class="docutils literal notranslate"><span class="pre">sec</span></code>, <code class="docutils literal notranslate"><span class="pre">second</span></code>, <code class="docutils literal notranslate"><span class="pre">seconds</span></code></p></td>
<td><p>Seconds</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">m</span></code>, <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">minute</span></code>, <code class="docutils literal notranslate"><span class="pre">minutes</span></code></p></td>
<td><p>Minutes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">h</span></code>, <code class="docutils literal notranslate"><span class="pre">hour</span></code>, <code class="docutils literal notranslate"><span class="pre">hours</span></code></p></td>
<td><p>Hours</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">day</span></code>, <code class="docutils literal notranslate"><span class="pre">days</span></code></p></td>
<td><p>Days</p></td>
</tr>
</tbody>
</table>
<p>Multiple units can be used in a single declaration, for example: <code class="docutils literal notranslate"><span class="pre">'1day</span> <span class="pre">6hours</span> <span class="pre">3minutes</span> <span class="pre">30seconds'</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This directive is only used by certain executors. Refer to the
<a class="reference internal" href="executor.html#executor-page"><span class="std std-ref">Executors</span></a> page to see which executors support this directive.</p>
</div>
<p>See also: <a class="reference internal" href="#cpus">cpus</a>, <a class="reference internal" href="#memory">memory</a>, <a class="reference internal" href="#queue">queue</a> and <a class="reference internal" href="#dynamic-computing-resources">Dynamic computing resources</a>.</p>
</section>
<section id="dynamic-directives">
<h3>Dynamic directives<a class="headerlink" href="#dynamic-directives" title="Permalink to this headline"></a></h3>
<p>A directive can be assigned <em>dynamically</em>, during the process execution, so that its actual value can be evaluated
based on the process inputs.</p>
<p>In order to be defined in a dynamic manner, the directive’s value needs to be expressed using a
<a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a>, as in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>process foo {
  executor &#39;sge&#39;
  queue { entries &gt; 100 ? &#39;long&#39; : &#39;short&#39; }

  input:
  tuple val(entries), path(&#39;data.txt&#39;) from data

  script:
  &quot;&quot;&quot;
  &lt; your job here &gt;
  &quot;&quot;&quot;
}
</pre></div>
</div>
<p>In the above example, the <a class="reference internal" href="#queue">queue</a> directive is evaluated dynamically, depending on the input value <code class="docutils literal notranslate"><span class="pre">entries</span></code>. When it is
larger than 100, jobs will be submitted to the <code class="docutils literal notranslate"><span class="pre">long</span></code> queue, otherwise the <code class="docutils literal notranslate"><span class="pre">short</span></code> queue will be used.</p>
<p>All directives can be assigned a dynamic value except the following:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#executor">executor</a></p></li>
<li><p><a class="reference internal" href="#label">label</a></p></li>
<li><p><a class="reference internal" href="#maxforks">maxForks</a></p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Assigning a string value with one or more variables is always resolved in a dynamic manner, and therefore
is equivalent to the above syntax. For example, the above directive can also be written as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">queue</span> <span class="s2">&quot;${ entries &gt; 100 ? &#39;long&#39; : &#39;short&#39; }&quot;</span>
</pre></div>
</div>
<p>Note, however, that the latter syntax can be used both for a directive’s main argument (as in the above example) and for a directive’s
optional named attributes, whereas the closure syntax is only resolved dynamically for a directive’s main argument.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can retrieve the current value of a dynamic directive in the process script by using the implicit variable <code class="docutils literal notranslate"><span class="pre">task</span></code>,
which holds the directive values defined in the current task. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>process foo {
  queue { entries &gt; 100 ? &#39;long&#39; : &#39;short&#39; }

  input:
  tuple val(entries), path(&#39;data.txt&#39;) from data

  script:
  &quot;&quot;&quot;
  echo Current queue: ${task.queue}
  &quot;&quot;&quot;
}
</pre></div>
</div>
</div>
</section>
<section id="dynamic-computing-resources">
<h3>Dynamic computing resources<a class="headerlink" href="#dynamic-computing-resources" title="Permalink to this headline"></a></h3>
<p>It’s a very common scenario that different instances of the same process may have very different needs in terms of computing resources.
In such situations requesting, for example, an amount of memory too low will cause some tasks to fail.
Instead, using a higher limit that fits all the tasks in your execution could significantly decrease the execution priority of your jobs.</p>
<p>The <a class="reference internal" href="#dynamic-directives">Dynamic directives</a> evaluation feature can be used to modify the amount of computing resources requested in case
of a process failure and try to re-execute it using a higher limit. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>process foo {
    memory { 2.GB * task.attempt }
    time { 1.hour * task.attempt }

    errorStrategy { task.exitStatus in 137..140 ? &#39;retry&#39; : &#39;terminate&#39; }
    maxRetries 3

    script:
    &lt;your job here&gt;
}
</pre></div>
</div>
<p>In the above example the <a class="reference internal" href="#memory">memory</a> and execution <a class="reference internal" href="#time">time</a> limits are defined dynamically. The first time the process
is executed the <code class="docutils literal notranslate"><span class="pre">task.attempt</span></code> is set to <code class="docutils literal notranslate"><span class="pre">1</span></code>, thus it will request a two GB of memory and one hour of maximum execution
time.</p>
<p>If the task execution fail reporting an exit status in the range between 137 and 140, the task is re-submitted (otherwise terminates immediately).
This time the value of <code class="docutils literal notranslate"><span class="pre">task.attempt</span></code> is <code class="docutils literal notranslate"><span class="pre">2</span></code>, thus increasing the amount of the memory to four GB and the time to 2 hours, and so on.</p>
<p>The directive <a class="reference internal" href="#maxretries">maxRetries</a> set the maximum number of time the same task can be re-executed.</p>
</section>
<section id="dynamic-retry-with-backoff">
<h3>Dynamic Retry with backoff<a class="headerlink" href="#dynamic-retry-with-backoff" title="Permalink to this headline"></a></h3>
<p>There are cases in which the required execution resources may be temporary unavailable e.g.
network congestion. In these cases immediately re-executing the task will likely result in
the identical error. A retry with an exponential backoff delay can better recover these error
conditions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">foo</span> <span class="p">{</span>
  <span class="n">errorStrategy</span> <span class="p">{</span> <span class="n">sleep</span><span class="p">(</span><span class="n">Math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">task</span><span class="o">.</span><span class="n">attempt</span><span class="p">)</span> <span class="o">*</span> <span class="mi">200</span> <span class="k">as</span> <span class="n">long</span><span class="p">);</span> <span class="k">return</span> <span class="s1">&#39;retry&#39;</span> <span class="p">}</span>
  <span class="n">maxRetries</span> <span class="mi">5</span>

  <span class="n">script</span><span class="p">:</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  your_command --here</span>
<span class="sd">  &#39;&#39;&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="script.html" class="btn btn-neutral float-left" title="Nextflow scripting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="channel.html" class="btn btn-neutral float-right" title="Channels" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2022, Seqera Labs. 2013-2019, Centre for Genomic Regulation (CRG)..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-364526-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-364526-10', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>