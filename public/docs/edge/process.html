<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Processes &mdash; Nextflow 23.12.0-edge documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Channels" href="channel.html" />
    <link rel="prev" title="Scripts" href="script.html" />
     
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TNCXSWG');</script>
    <!-- End Google Tag Manager -->

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/nextflow-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div>
    <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getstarted.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic.html">Basic concepts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Language</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="script.html">Scripts</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Processes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#script">Script</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#scripts-a-la-carte">Scripts <em>Ã  la carte</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="#conditional-scripts">Conditional scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#template">Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="#shell">Shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="#native-execution">Native execution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#stub">Stub</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inputs">Inputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#input-type-val">Input type <code class="docutils literal notranslate"><span class="pre">val</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-type-file">Input type <code class="docutils literal notranslate"><span class="pre">file</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-type-path">Input type <code class="docutils literal notranslate"><span class="pre">path</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-input-files">Multiple input files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-input-file-names">Dynamic input file names</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-type-env">Input type <code class="docutils literal notranslate"><span class="pre">env</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-type-stdin">Input type <code class="docutils literal notranslate"><span class="pre">stdin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-type-set">Input type <code class="docutils literal notranslate"><span class="pre">set</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-type-tuple">Input type <code class="docutils literal notranslate"><span class="pre">tuple</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-repeaters-each">Input repeaters (<code class="docutils literal notranslate"><span class="pre">each</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-input-channels">Multiple input channels</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#outputs">Outputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#output-type-val">Output type <code class="docutils literal notranslate"><span class="pre">val</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-type-file">Output type <code class="docutils literal notranslate"><span class="pre">file</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-type-path">Output type <code class="docutils literal notranslate"><span class="pre">path</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-output-files">Multiple output files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-output-file-names">Dynamic output file names</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-type-env">Output type <code class="docutils literal notranslate"><span class="pre">env</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-type-stdout">Output type <code class="docutils literal notranslate"><span class="pre">stdout</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-type-set">Output type <code class="docutils literal notranslate"><span class="pre">set</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-type-tuple">Output type <code class="docutils literal notranslate"><span class="pre">tuple</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-options">Additional options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#when">When</a></li>
<li class="toctree-l2"><a class="reference internal" href="#directives">Directives</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#accelerator">accelerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#afterscript">afterScript</a></li>
<li class="toctree-l3"><a class="reference internal" href="#arch">arch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#beforescript">beforeScript</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cache">cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clusteroptions">clusterOptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conda">conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="#container">container</a></li>
<li class="toctree-l3"><a class="reference internal" href="#containeroptions">containerOptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cpus">cpus</a></li>
<li class="toctree-l3"><a class="reference internal" href="#debug">debug</a></li>
<li class="toctree-l3"><a class="reference internal" href="#disk">disk</a></li>
<li class="toctree-l3"><a class="reference internal" href="#echo">echo</a></li>
<li class="toctree-l3"><a class="reference internal" href="#errorstrategy">errorStrategy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#executor">executor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ext">ext</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fair">fair</a></li>
<li class="toctree-l3"><a class="reference internal" href="#label">label</a></li>
<li class="toctree-l3"><a class="reference internal" href="#machinetype">machineType</a></li>
<li class="toctree-l3"><a class="reference internal" href="#maxsubmitawait-experimental">maxSubmitAwait (experimental)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#maxerrors">maxErrors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#maxforks">maxForks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#maxretries">maxRetries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#memory">memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module">module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#penv">penv</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pod">pod</a></li>
<li class="toctree-l3"><a class="reference internal" href="#publishdir">publishDir</a></li>
<li class="toctree-l3"><a class="reference internal" href="#queue">queue</a></li>
<li class="toctree-l3"><a class="reference internal" href="#resourcelabels">resourceLabels</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scratch">scratch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#process-directive-shell">shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spack">spack</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stageinmode">stageInMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stageoutmode">stageOutMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#storedir">storeDir</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tag">tag</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time">time</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-directives">Dynamic directives</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-computing-resources">Dynamic computing resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-retry-with-backoff">Dynamic Retry with backoff</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="channel.html">Channels</a></li>
<li class="toctree-l1"><a class="reference internal" href="operator.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="module.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="dsl1.html">Migrating from DSL 1</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Execution</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command line interface (CLI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="executor.html">Executors</a></li>
<li class="toctree-l1"><a class="reference internal" href="cache-and-resume.html">Caching and resuming</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracing.html">Tracing &amp; visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="sharing.html">Pipeline sharing</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Workflow introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="mail.html">Mail &amp; Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="secrets.html">Secrets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software dependencies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="container.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="conda.html">Conda environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="spack.html">Spack environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="wave.html">Wave containers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Compute &amp; storage platforms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="aws.html">AWS Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="amazons3.html">AWS S3 storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="azure.html">Azure Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="fusion.html">Fusion file system</a></li>
<li class="toctree-l1"><a class="reference internal" href="google.html">Google Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="kubernetes.html">Kubernetes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional integrations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="flux.html">Flux Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="ignite.html">Apache Ignite</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="developer/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer/packages.html">Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer/plugins.html">Core plugins</a></li>
</ul>

        </div>
    <div class="nav-footer-logo">
        <a href="https://seqera.io/" target="_blank" title="Developed by Seqera Labs">
            Nextflow is developed by:<br>
            <img src="_static/seqera-logo.svg" alt="Seqera Labs">
        </a>
    </div>

      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Nextflow</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Processes</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/nextflow-io/nextflow/blob/master/docs/process.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="processes">
<span id="process-page"></span><h1>Processes<a class="headerlink" href="#processes" title="Permalink to this heading">ï</a></h1>
<p>In Nextflow, a <strong>process</strong> is the basic processing primitive to execute a user script.</p>
<p>The process definition starts with the keyword <code class="docutils literal notranslate"><span class="pre">process</span></code>, followed by process name and finally the process body delimited by curly braces. The process body must contain a string which represents the command or, more generally, a script that is executed by it. A basic process looks like the following example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">sayHello</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    echo &#39;Hello world!&#39; &gt; file</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>A process may contain any of the following definition blocks: directives, inputs, outputs, when clause, and the process script. The syntax is defined as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="o">&lt;</span> <span class="n">name</span> <span class="o">&gt;</span> <span class="p">{</span>

  <span class="p">[</span> <span class="n">directives</span> <span class="p">]</span>

  <span class="nb">input</span><span class="p">:</span>
    <span class="o">&lt;</span> <span class="n">process</span> <span class="n">inputs</span> <span class="o">&gt;</span>

  <span class="n">output</span><span class="p">:</span>
    <span class="o">&lt;</span> <span class="n">process</span> <span class="n">outputs</span> <span class="o">&gt;</span>

  <span class="n">when</span><span class="p">:</span>
    <span class="o">&lt;</span> <span class="n">condition</span> <span class="o">&gt;</span>

  <span class="p">[</span><span class="n">script</span><span class="o">|</span><span class="n">shell</span><span class="o">|</span><span class="n">exec</span><span class="p">]:</span>
    <span class="o">&lt;</span> <span class="n">user</span> <span class="n">script</span> <span class="n">to</span> <span class="n">be</span> <span class="n">executed</span> <span class="o">&gt;</span>

<span class="p">}</span>
</pre></div>
</div>
<section id="script">
<span id="process-script"></span><h2>Script<a class="headerlink" href="#script" title="Permalink to this heading">ï</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">script</span></code> block defines, as a string expression, the script that is executed by the process.</p>
<p>A process may contain only one script, and if the <code class="docutils literal notranslate"><span class="pre">script</span></code> guard is not explicitly declared, the script must be the final statement in the process block.</p>
<p>The script string is executed as a <a class="reference external" href="http://en.wikipedia.org/wiki/Bash_(Unix_shell)">Bash</a> script in the host environment. It can be any command or script that you would normally execute on the command line or in a Bash script. Naturally, the script may only use commands that are available in the host environment.</p>
<p>The script block can be a simple string or a multi-line string. The latter approach makes it easier to write scripts with multiple commands spanning multiple lines. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">doMoreThings</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  blastp -db $db -query query.fa -outfmt 6 &gt; blast_result</span>
<span class="s2">  cat blast_result | head -n 10 | cut -f 2 &gt; top_hits</span>
<span class="s2">  blastdbcmd -db $db -entry_batch top_hits &gt; sequences</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>As explained in the script tutorial section, strings can be defined using single-quotes or double-quotes, and multi-line strings are defined by three single-quote or three double-quote characters.</p>
<p>There is a subtle but important difference between them. Like in Bash, strings delimited by a <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> character support variable substitutions, while strings delimited by <code class="docutils literal notranslate"><span class="pre">'</span></code> do not.</p>
<p>In the above code fragment, the <code class="docutils literal notranslate"><span class="pre">$db</span></code> variable is replaced by the actual value defined elsewhere in the pipeline script.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since Nextflow uses the same Bash syntax for variable substitutions in strings, you must manage them carefully depending on whether you want to evaluate a <em>Nextflow</em> variable or a <em>Bash</em> variable.</p>
</div>
<p>When you need to access a system environment variable in your script, you have two options.</p>
<p>If you donât need to access any Nextflow variables, you can define your script block with single-quotes:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">printPath</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">  echo The path is: $PATH</span>
<span class="s1">  &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Otherwise, you can define your script with double-quotes and escape the system environment variables by prefixing them with a back-slash <code class="docutils literal notranslate"><span class="pre">\</span></code> character, as shown in the following example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">doOtherThings</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  blastp -db \$DB -query query.fa -outfmt 6 &gt; blast_result</span>
<span class="s2">  cat blast_result | head -n $MAX | cut -f 2 &gt; top_hits</span>
<span class="s2">  blastdbcmd -db \$DB -entry_batch top_hits &gt; sequences</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">$MAX</span></code> is a Nextflow variable that must be defined elsewhere in the pipeline script. Nextflow replaces it with the actual value before executing the script. Meanwhile, <code class="docutils literal notranslate"><span class="pre">$DB</span></code> is a Bash variable that must exist in the execution environment, and Bash will replace it with the actual value during execution.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Alternatively, you can use the <a class="reference internal" href="#process-shell"><span class="std std-ref">Shell</span></a> block definition, which allows a script to contain both Bash and Nextflow variables without having to escape the first.</p>
</div>
<section id="scripts-a-la-carte">
<h3>Scripts <em>Ã  la carte</em><a class="headerlink" href="#scripts-a-la-carte" title="Permalink to this heading">ï</a></h3>
<p>The process script is interpreted by Nextflow as a Bash script by default, but you are not limited to Bash.</p>
<p>You can use your favourite scripting language (Perl, Python, R, etc), or even mix them in the same pipeline.</p>
<p>A pipeline may be composed of processes that execute very different tasks. With Nextflow, you can choose the scripting language that best fits the task performed by a given process. For example, for some processes R might be more useful than Perl, whereas for others you may need to use Python because it provides better access to a library or an API, etc.</p>
<p>To use a language other than Bash, simply start your process script with the corresponding <a class="reference external" href="http://en.wikipedia.org/wiki/Shebang_(Unix)">shebang</a>. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">perlTask</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    #!/usr/bin/perl</span>

<span class="s2">    print &#39;Hi there!&#39; . &#39;\n&#39;;</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">process</span><span class="w"> </span><span class="n">pythonTask</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    #!/usr/bin/python</span>

<span class="s2">    x = &#39;Hello&#39;</span>
<span class="s2">    y = &#39;world!&#39;</span>
<span class="s2">    print &quot;%s - %s&quot; % (x,y)</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">perlTask</span><span class="o">()</span>
<span class="w">    </span><span class="n">pythonTask</span><span class="o">()</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Since the actual location of the interpreter binary file can differ across platforms, it is wise to use the <code class="docutils literal notranslate"><span class="pre">env</span></code> command followed by the interpreter name, e.g. <code class="docutils literal notranslate"><span class="pre">#!/usr/bin/env</span> <span class="pre">perl</span></code>, instead of the absolute path, in order to make your script more portable.</p>
</div>
</section>
<section id="conditional-scripts">
<h3>Conditional scripts<a class="headerlink" href="#conditional-scripts" title="Permalink to this heading">ï</a></h3>
<p>So far, our <code class="docutils literal notranslate"><span class="pre">script</span></code> block has always been a simple string expression, but in reality, the <code class="docutils literal notranslate"><span class="pre">script</span></code> block is just Groovy code that returns a string. This means that you can write arbitrary Groovy code to determine the script to execute, as long as the final statement is a string (remember that the <code class="docutils literal notranslate"><span class="pre">return</span></code> keyword is optional in Groovy).</p>
<p>For example, you can use flow control statements (<code class="docutils literal notranslate"><span class="pre">if</span></code>, <code class="docutils literal notranslate"><span class="pre">switch</span></code>, etc) to execute a different script based on the process inputs. The only difference here is that you must explicitly declare the <code class="docutils literal notranslate"><span class="pre">script</span></code> guard, whereas before it was not required. Here is an example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;tcoffee&#39;</span>

<span class="n">process</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">input:</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="n">sequences</span>

<span class="w">    </span><span class="nl">script:</span>
<span class="w">    </span><span class="k">if</span><span class="o">(</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;tcoffee&#39;</span><span class="w"> </span><span class="o">)</span>
<span class="w">        </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        t_coffee -in $sequences &gt; out_file</span>
<span class="s2">        &quot;&quot;&quot;</span>

<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="o">(</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;mafft&#39;</span><span class="w"> </span><span class="o">)</span>
<span class="w">        </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        mafft --anysymbol --parttree --quiet $sequences &gt; out_file</span>
<span class="s2">        &quot;&quot;&quot;</span>

<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="o">(</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;clustalo&#39;</span><span class="w"> </span><span class="o">)</span>
<span class="w">        </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        clustalo -i $sequences -o out_file</span>
<span class="s2">        &quot;&quot;&quot;</span>

<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="n">error</span><span class="w"> </span><span class="s2">&quot;Invalid alignment mode: ${mode}&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, the process will execute one of the script fragments depending on the value of the <code class="docutils literal notranslate"><span class="pre">mode</span></code> parameter. By default it will execute the <code class="docutils literal notranslate"><span class="pre">tcoffee</span></code> command, but changing the <code class="docutils literal notranslate"><span class="pre">mode</span></code> variable will cause a different branch to be executed.</p>
</section>
<section id="template">
<span id="process-template"></span><h3>Template<a class="headerlink" href="#template" title="Permalink to this heading">ï</a></h3>
<p>Process scripts can be externalised to <strong>template</strong> files, which can be reused across different processes and tested independently from the overall pipeline execution.</p>
<p>A template is simply a shell script file that Nextflow is able to execute by using the <code class="docutils literal notranslate"><span class="pre">template</span></code> function as shown below:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">templateExample</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">input:</span>
<span class="w">    </span><span class="n">val</span><span class="w"> </span><span class="n">STR</span>

<span class="w">    </span><span class="nl">script:</span>
<span class="w">    </span><span class="n">template</span><span class="w"> </span><span class="s1">&#39;my_script.sh&#39;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">Channel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s1">&#39;this&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;that&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">templateExample</span>
<span class="o">}</span>
</pre></div>
</div>
<p>By default, Nextflow looks for the <code class="docutils literal notranslate"><span class="pre">my_script.sh</span></code> template file in the <code class="docutils literal notranslate"><span class="pre">templates</span></code> directory located alongside the Nextflow script and/or the module script in which the process is defined. Any other location can be specified by using an absolute template path.</p>
<p>The template script may contain any code that can be executed by the underlying environment. For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;process started at `date`&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="nv">$STR</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;process completed&quot;</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The dollar character (<code class="docutils literal notranslate"><span class="pre">$</span></code>) is interpreted as a Nextflow variable when the script is run as a Nextflow template, whereas it is evaluated as a Bash variable when run as a Bash script. This can be very useful for testing your script independently from Nextflow execution. You only need to provide a Bash environment variable for each of the Nextflow variables that are referenced in your script. For example, it would be possible to execute the above script with the following command in the terminal: <code class="docutils literal notranslate"><span class="pre">STR='foo'</span> <span class="pre">bash</span> <span class="pre">templates/my_script.sh</span></code></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>As a best practice, the template script should not contain any <code class="docutils literal notranslate"><span class="pre">\$</span></code> escaped variables, because these variables will not be evaluated properly when the script is executed directly.</p>
</div>
</section>
<section id="shell">
<span id="process-shell"></span><h3>Shell<a class="headerlink" href="#shell" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">shell</span></code> block is a string expression that defines the script that is executed by the process. It is an alternative to the <a class="reference internal" href="#process-script"><span class="std std-ref">Script</span></a> definition with one important difference: it uses the exclamation mark <code class="docutils literal notranslate"><span class="pre">!</span></code> character, instead of the usual dollar <code class="docutils literal notranslate"><span class="pre">$</span></code> character, to denote Nextflow variables.</p>
<p>This way, it is possible to use both Nextflow and Bash variables in the same script without having to escape the latter, which makes process scripts easier to read and maintain. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">myTask</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">input:</span>
<span class="w">    </span><span class="n">val</span><span class="w"> </span><span class="n">str</span>

<span class="w">    </span><span class="nl">shell:</span>
<span class="w">    </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    echo &quot;User $USER says !{str}&quot;</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">Channel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s1">&#39;Hello&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;Hola&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;Bonjour&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">myTask</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, <code class="docutils literal notranslate"><span class="pre">$USER</span></code> is treated as a Bash variable, while <code class="docutils literal notranslate"><span class="pre">!{str}</span></code> is treated as a Nextflow variable.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Shell script definitions require the use of single-quote <code class="docutils literal notranslate"><span class="pre">'</span></code> delimited strings. When using double-quote <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> delimited strings, dollar variables are interpreted as Nextflow variables as usual. See <a class="reference internal" href="script.html#string-interpolation"><span class="std std-ref">String interpolation</span></a>.</p></li>
<li><p>Variables prefixed with <code class="docutils literal notranslate"><span class="pre">!</span></code> must always be enclosed in curly brackets, i.e. <code class="docutils literal notranslate"><span class="pre">!{str}</span></code> is a valid variable whereas <code class="docutils literal notranslate"><span class="pre">!str</span></code> is ignored.</p></li>
<li><p>Shell scripts support the use of the <a class="reference internal" href="#process-template"><span class="std std-ref">Template</span></a> mechanism. The same rules are applied to the variables defined in the script template.</p></li>
</ul>
</div>
</section>
<section id="native-execution">
<span id="process-native"></span><h3>Native execution<a class="headerlink" href="#native-execution" title="Permalink to this heading">ï</a></h3>
<p>Nextflow processes can also execute native Groovy code as the task itself, using the <code class="docutils literal notranslate"><span class="pre">exec</span></code> block. Whereas the <code class="docutils literal notranslate"><span class="pre">script</span></code> block defines a script to be executed, the <code class="docutils literal notranslate"><span class="pre">exec</span></code> block defines Groovy code to be executed directly.</p>
<p>For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">simpleSum</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">input:</span>
<span class="w">    </span><span class="n">val</span><span class="w"> </span><span class="n">x</span>

<span class="w">    </span><span class="nl">exec:</span>
<span class="w">    </span><span class="n">println</span><span class="w"> </span><span class="s2">&quot;Hello Mr. $x&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">Channel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s1">&#39;a&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;c&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">simpleSum</span>
<span class="o">}</span>
</pre></div>
</div>
<p>will display:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hello</span> <span class="n">Mr</span><span class="o">.</span> <span class="n">b</span>
<span class="n">Hello</span> <span class="n">Mr</span><span class="o">.</span> <span class="n">a</span>
<span class="n">Hello</span> <span class="n">Mr</span><span class="o">.</span> <span class="n">c</span>
</pre></div>
</div>
</section>
</section>
<section id="stub">
<span id="process-stub"></span><h2>Stub<a class="headerlink" href="#stub" title="Permalink to this heading">ï</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 20.11.0-edge.</span></p>
</div>
<p>You can define a command <em>stub</em>, which replaces the actual process command when the <code class="docutils literal notranslate"><span class="pre">-stub-run</span></code> or <code class="docutils literal notranslate"><span class="pre">-stub</span></code> command-line option is enabled:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">INDEX</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="n">transcriptome</span>

<span class="w">  </span><span class="nl">output:</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;index&#39;</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    salmon index --threads $task.cpus -t $transcriptome -i index</span>
<span class="s2">    &quot;&quot;&quot;</span>

<span class="w">  </span><span class="nl">stub:</span>
<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    mkdir index</span>
<span class="s2">    touch index/seq.bin</span>
<span class="s2">    touch index/info.json</span>
<span class="s2">    touch index/refseq.bin</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">stub</span></code> block can be defined before or after the <code class="docutils literal notranslate"><span class="pre">script</span></code> block. When the pipeline is executed with the <code class="docutils literal notranslate"><span class="pre">-stub-run</span></code> option and a processâs <code class="docutils literal notranslate"><span class="pre">stub</span></code> is not defined, the <code class="docutils literal notranslate"><span class="pre">script</span></code> block is executed.</p>
<p>This feature makes it easier to quickly prototype the workflow logic without using the real commands. The developer can use it to provide a dummy script that mimics the execution of the real one in a quicker manner. In other words, it is a way to perform a dry-run.</p>
</section>
<section id="inputs">
<span id="process-input"></span><h2>Inputs<a class="headerlink" href="#inputs" title="Permalink to this heading">ï</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">input</span></code> block allows you to define the input channels of a process, similar to function arguments. A process may have at most one input block, and it must contain at least one input.</p>
<p>The input block follows the syntax shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">input</span><span class="p">:</span>
  <span class="o">&lt;</span><span class="nb">input</span> <span class="n">qualifier</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">input</span> <span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>An input definition consists of a <em>qualifier</em> and a <em>name</em>. The input qualifier defines the type of data to be received. This information is used by Nextflow to apply the semantic rules associated with each qualifier, and handle it properly depending on the target execution platform (grid, cloud, etc).</p>
<p>When a process is invoked in a workflow block, it must be provided a channel for each channel in the process input block, similar to calling a function with specific arguments. The examples provided in the following sections demonstrate how a process is invoked with input channels.</p>
<p>The following input qualifiers are available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">val</span></code>: Access the input value by name in the process script.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code>: (DEPRECATED) Handle the input value as a file, staging it properly in the execution context.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code>: Handle the input value as a path, staging the file properly in the execution context.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">env</span></code>: Use the input value to set an environment variable in the process script.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stdin</span></code>: Forward the input value to the process <code class="docutils literal notranslate"><span class="pre">stdin</span></code> special file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple</span></code>: Handle a group of input values having any of the above qualifiers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">each</span></code>: Execute the process for each element in the input collection.</p></li>
</ul>
<section id="input-type-val">
<h3>Input type <code class="docutils literal notranslate"><span class="pre">val</span></code><a class="headerlink" href="#input-type-val" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">val</span></code> qualifier accepts any data type. It can be accessed in the process script by using the specified input name, as shown in the following example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">basicExample</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">x</span>

<span class="w">  </span><span class="s2">&quot;echo process job $x&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="kt">def</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">)</span>
<span class="w">  </span><span class="n">basicExample</span><span class="o">(</span><span class="n">num</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, the process is executed three times: once for each value emitted by the <code class="docutils literal notranslate"><span class="pre">num</span></code> channel. The resulting output is similar to the one shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="n">job</span> <span class="mi">3</span>
<span class="n">process</span> <span class="n">job</span> <span class="mi">1</span>
<span class="n">process</span> <span class="n">job</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While channels do emit items in the order that they are received, <em>processes</em> do not necessarily <em>process</em> items in the order that they are received. In the above example, the value <code class="docutils literal notranslate"><span class="pre">3</span></code> was processed before the others.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the process declares exactly one input, the pipe <code class="docutils literal notranslate"><span class="pre">|</span></code> operator can be used to provide inputs to the process, instead of passing it as a parameter. Both methods have identical semantics:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">basicExample</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">x</span>

<span class="w">  </span><span class="s2">&quot;echo process job $x&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">Channel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">basicExample</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</section>
<section id="input-type-file">
<h3>Input type <code class="docutils literal notranslate"><span class="pre">file</span></code><a class="headerlink" href="#input-type-file" title="Permalink to this heading">ï</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">file</span></code> qualifier was the standard way to handle input files prior to Nextflow 19.10.0. In later versions of Nextflow, the <code class="docutils literal notranslate"><span class="pre">path</span></code> qualifier should be preferred over <code class="docutils literal notranslate"><span class="pre">file</span></code>.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">file</span></code> qualifier is identical to <code class="docutils literal notranslate"><span class="pre">path</span></code>, with one important difference. When a <code class="docutils literal notranslate"><span class="pre">file</span></code> input receives a value that is not a file, it automatically converts the value to a string and saves it to a temporary file. This behavior is useful in some cases, but tends to be confusing in general. The <code class="docutils literal notranslate"><span class="pre">path</span></code> qualifier instead interprets string values as the path location of the input file and automatically converts to a file object.</p>
</section>
<section id="input-type-path">
<span id="process-input-path"></span><h3>Input type <code class="docutils literal notranslate"><span class="pre">path</span></code><a class="headerlink" href="#input-type-path" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">path</span></code> qualifier allows you to provide input files to the process execution context. Nextflow will stage the files into the process execution directory, and they can be accessed in the script by using the specified input name. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">blastThemAll</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="n">query_file</span>

<span class="w">  </span><span class="s2">&quot;blastp -query ${query_file} -db nr&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="kt">def</span><span class="w"> </span><span class="n">proteins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="w"> </span><span class="s1">&#39;/some/path/*.fa&#39;</span><span class="w"> </span><span class="o">)</span>
<span class="w">  </span><span class="n">blastThemAll</span><span class="o">(</span><span class="n">proteins</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, all the files ending with the suffix <code class="docutils literal notranslate"><span class="pre">.fa</span></code> are sent over the channel <code class="docutils literal notranslate"><span class="pre">proteins</span></code>. These files are received by the process, which executes a BLAST query on each of them.</p>
<p>Itâs worth noting that in the above example, the name of the file in the file-system is not used. You can access the file without even knowing its name, because you can reference it in the process script by the input name.</p>
<p>There may be cases where your task needs to use a file whose name is fixed, i.e. it does not have to change along with the actual provided file. In this case, you can specify a fixed name with the <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute in the input file parameter definition, as shown in the following example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="nl">input:</span>
<span class="n">path</span><span class="w"> </span><span class="n">query_file</span><span class="o">,</span><span class="w"> </span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;query.fa&#39;</span>
</pre></div>
</div>
<p>or, using a shorter syntax:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="nl">input:</span>
<span class="n">path</span><span class="w"> </span><span class="s1">&#39;query.fa&#39;</span>
</pre></div>
</div>
<p>The previous example can be re-written as shown below:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">blastThemAll</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;query.fa&#39;</span>

<span class="w">  </span><span class="s2">&quot;blastp -query query.fa -db nr&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="kt">def</span><span class="w"> </span><span class="n">proteins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="w"> </span><span class="s1">&#39;/some/path/*.fa&#39;</span><span class="w"> </span><span class="o">)</span>
<span class="w">  </span><span class="n">blastThemAll</span><span class="o">(</span><span class="n">proteins</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In this example, each file received by the process is staged with the name <code class="docutils literal notranslate"><span class="pre">query.fa</span></code> in a different execution context (i.e. the folder where a task is executed).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This feature allows you to execute the process command multiple times without worrying about the file names changing. In other words, Nextflow helps you write pipeline tasks that are self-contained and decoupled from the execution environment. As a best practice, you should avoid referencing files in your process script other than those defined in your input block.</p>
</div>
<p>Channel factories like <code class="docutils literal notranslate"><span class="pre">Channel.fromPath</span></code> produce file objects, but a <code class="docutils literal notranslate"><span class="pre">path</span></code> input can also accept a string literal path. The string value should be an absolute path, i.e. it must be prefixed with a <code class="docutils literal notranslate"><span class="pre">/</span></code> character or a supported URI protocol (<code class="docutils literal notranslate"><span class="pre">file://</span></code>, <code class="docutils literal notranslate"><span class="pre">http://</span></code>, <code class="docutils literal notranslate"><span class="pre">s3://</span></code>, etc), and it cannot contain special characters (<code class="docutils literal notranslate"><span class="pre">\n</span></code>, etc).</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="n">x</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  your_command --in $x</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">foo</span><span class="o">(</span><span class="s1">&#39;/some/data/file.txt&#39;</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Available options:</p>
<dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">arity</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 23.09.0-edge.</span></p>
</div>
</dd>
<dd><p>Specify the number of expected files. Can be a number or a range:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="nl">input:</span>
<span class="w">    </span><span class="n">path</span><span class="o">(</span><span class="s1">&#39;one.txt&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">arity:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="o">)</span><span class="w">         </span><span class="c1">// exactly one file is expected</span>
<span class="w">    </span><span class="n">path</span><span class="o">(</span><span class="s1">&#39;pair_*.txt&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">arity:</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="o">)</span><span class="w">      </span><span class="c1">// exactly two files are expected</span>
<span class="w">    </span><span class="n">path</span><span class="o">(</span><span class="s1">&#39;many_*.txt&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">arity:</span><span class="w"> </span><span class="s1">&#39;1..*&#39;</span><span class="o">)</span><span class="w">   </span><span class="c1">// one or more files are expected</span>
</pre></div>
</div>
<p>When a task is created, Nextflow will check whether the received files for each path input match the declared arity, and fail if they do not.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">stageAs</span></code></dt><dd><p>Specify how the file should be named in the task work directory:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="nl">stageAs:</span><span class="w"> </span><span class="s1">&#39;data.txt&#39;</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  your_command --in data.txt</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">foo</span><span class="o">(</span><span class="s1">&#39;/some/data/file.txt&#39;</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Can be a name or a pattern as described in the <a class="reference internal" href="#multiple-input-files"><span class="std std-doc">Multiple input files</span></a> section.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Process <code class="docutils literal notranslate"><span class="pre">path</span></code> inputs have nearly the same interface as described in <a class="reference internal" href="script.html#script-file-io"><span class="std std-ref">Files and I/O</span></a>, with one difference which is relevant when files are staged into a subdirectory. Given the following input:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">path</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="nl">stageAs:</span><span class="w"> </span><span class="s1">&#39;my-dir/*&#39;</span>
</pre></div>
</div>
<p>In this case, <code class="docutils literal notranslate"><span class="pre">x.name</span></code> returns the file name with the parent directory (e.g. <code class="docutils literal notranslate"><span class="pre">my-dir/file.txt</span></code>), whereas normally it would return the file name (e.g. <code class="docutils literal notranslate"><span class="pre">file.txt</span></code>). You can use <code class="docutils literal notranslate"><span class="pre">x.fileName.name</span></code> to get the file name.</p>
</div>
</section>
<section id="multiple-input-files">
<h3>Multiple input files<a class="headerlink" href="#multiple-input-files" title="Permalink to this heading">ï</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">path</span></code> input can also accept a collection of files instead of a single value. In this case, the input variable will be a Groovy list, and you can use it as such.</p>
<p>When the input has a fixed file name and a collection of files is received by the process, the file name will be appended with a numerical suffix representing its ordinal position in the list. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">blastThemAll</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">input:</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;seq&#39;</span>

<span class="w">    </span><span class="s2">&quot;echo seq*&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="kt">def</span><span class="w"> </span><span class="n">fasta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="w"> </span><span class="s2">&quot;/some/path/*.fa&quot;</span><span class="w"> </span><span class="o">).</span><span class="na">buffer</span><span class="o">(</span><span class="nl">size:</span><span class="w"> </span><span class="mi">3</span><span class="o">)</span>
<span class="w">    </span><span class="n">blastThemAll</span><span class="o">(</span><span class="n">fasta</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>will output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seq1</span> <span class="n">seq2</span> <span class="n">seq3</span>
<span class="n">seq1</span> <span class="n">seq2</span> <span class="n">seq3</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The target input file name may contain the <code class="docutils literal notranslate"><span class="pre">*</span></code> and <code class="docutils literal notranslate"><span class="pre">?</span></code> wildcards, which can be used to control the name of staged files. The following table shows how the wildcards are replaced depending on the cardinality of the received input collection.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Cardinality</p></th>
<th class="head"><p>Name pattern</p></th>
<th class="head"><p>Staged file names</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>any</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">*</span></code></p></td>
<td><p>named as the source file</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file*.ext</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file.ext</span></code></p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file?.ext</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file1.ext</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file??.ext</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file01.ext</span></code></p></td>
</tr>
<tr class="row-even"><td><p>many</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file*.ext</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file1.ext</span></code>, <code class="docutils literal notranslate"><span class="pre">file2.ext</span></code>, <code class="docutils literal notranslate"><span class="pre">file3.ext</span></code>, ..</p></td>
</tr>
<tr class="row-odd"><td><p>many</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file?.ext</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file1.ext</span></code>, <code class="docutils literal notranslate"><span class="pre">file2.ext</span></code>, <code class="docutils literal notranslate"><span class="pre">file3.ext</span></code>, ..</p></td>
</tr>
<tr class="row-even"><td><p>many</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file??.ext</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file01.ext</span></code>, <code class="docutils literal notranslate"><span class="pre">file02.ext</span></code>, <code class="docutils literal notranslate"><span class="pre">file03.ext</span></code>, ..</p></td>
</tr>
<tr class="row-odd"><td><p>many</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dir/*</span></code></p></td>
<td><p>named as the source file, created in <code class="docutils literal notranslate"><span class="pre">dir</span></code> subdirectory</p></td>
</tr>
<tr class="row-even"><td><p>many</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dir??/*</span></code></p></td>
<td><p>named as the source file, created in a progressively indexed subdirectory e.g. <code class="docutils literal notranslate"><span class="pre">dir01/</span></code>, <code class="docutils literal notranslate"><span class="pre">dir02/</span></code>, etc.</p></td>
</tr>
<tr class="row-odd"><td><p>many</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dir*/*</span></code></p></td>
<td><p>(as above)</p></td>
</tr>
</tbody>
</table>
<p>The following example shows how a wildcard can be used in the input file definition:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">blastThemAll</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">input:</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;seq?.fa&#39;</span>

<span class="w">    </span><span class="s2">&quot;cat seq1.fa seq2.fa seq3.fa&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="kt">def</span><span class="w"> </span><span class="n">fasta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="w"> </span><span class="s2">&quot;/some/path/*.fa&quot;</span><span class="w"> </span><span class="o">).</span><span class="na">buffer</span><span class="o">(</span><span class="nl">size:</span><span class="w"> </span><span class="mi">3</span><span class="o">)</span>
<span class="w">    </span><span class="n">blastThemAll</span><span class="o">(</span><span class="n">fasta</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Rewriting input file names according to a named pattern is an extra feature and not at all required. The normal file input syntax introduced in the <a class="reference internal" href="#process-input-path"><span class="std std-ref">Input type path</span></a> section is valid for collections of multiple files as well. To handle multiple input files while preserving the original file names, use a variable identifier or the <code class="docutils literal notranslate"><span class="pre">*</span></code> wildcard.</p>
</div>
</section>
<section id="dynamic-input-file-names">
<h3>Dynamic input file names<a class="headerlink" href="#dynamic-input-file-names" title="Permalink to this heading">ï</a></h3>
<p>When the input file name is specified by using the <code class="docutils literal notranslate"><span class="pre">name</span></code> option or a string literal, you can also use other input values as variables in the file name string. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">simpleCount</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">x</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="s2">&quot;${x}.fa&quot;</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  cat ${x}.fa | grep &#39;&gt;&#39;</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, the input file name is determined by the current value of the <code class="docutils literal notranslate"><span class="pre">x</span></code> input value.</p>
<p>This approach allows input files to be staged in the task directory with a name that is coherent with the current execution context.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In most cases, you wonât need to use dynamic file names, because each task is executed in its own directory, and input files are automatically staged into this directory by Nextflow. This behavior guarantees that input files with the same name wonât overwrite each other.</p>
<p>An example of when you may have to deal with that is when you have many input files in a task, and some of these files may have the same filename. In this case, a solution would be to use the <code class="docutils literal notranslate"><span class="pre">stageAs</span></code> option.</p>
</div>
</section>
<section id="input-type-env">
<h3>Input type <code class="docutils literal notranslate"><span class="pre">env</span></code><a class="headerlink" href="#input-type-env" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">env</span></code> qualifier allows you to define an environment variable in the process execution context based on the input value. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">printEnv</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">input:</span>
<span class="w">    </span><span class="n">env</span><span class="w"> </span><span class="n">HELLO</span>

<span class="w">    </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    echo $HELLO world!</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">Channel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s1">&#39;hello&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;hola&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;bonjour&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;ciao&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">printEnv</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>hello world!
ciao world!
bonjour world!
hola world!
</pre></div>
</div>
</section>
<section id="input-type-stdin">
<h3>Input type <code class="docutils literal notranslate"><span class="pre">stdin</span></code><a class="headerlink" href="#input-type-stdin" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">stdin</span></code> qualifier allows you to forward the input value to the <a class="reference external" href="http://en.wikipedia.org/wiki/Standard_streams#Standard_input_.28stdin.29">standard input</a> of the process script. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">printAll</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">stdin</span><span class="w"> </span><span class="n">str</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  cat -</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">Channel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s1">&#39;hello&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;hola&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;bonjour&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;ciao&#39;</span><span class="o">)</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;\n&#39;</span><span class="w"> </span><span class="o">}</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">printAll</span>
<span class="o">}</span>
</pre></div>
</div>
<p>will output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hola</span>
<span class="n">bonjour</span>
<span class="n">ciao</span>
<span class="n">hello</span>
</pre></div>
</div>
</section>
<section id="input-type-set">
<span id="process-input-set"></span><h3>Input type <code class="docutils literal notranslate"><span class="pre">set</span></code><a class="headerlink" href="#input-type-set" title="Permalink to this heading">ï</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 19.08.1-edge: </span>Use <code class="docutils literal notranslate"><span class="pre">tuple</span></code> instead.</p>
</div>
</section>
<section id="input-type-tuple">
<span id="process-input-tuple"></span><h3>Input type <code class="docutils literal notranslate"><span class="pre">tuple</span></code><a class="headerlink" href="#input-type-tuple" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">tuple</span></code> qualifier allows you to group multiple values into a single input definition. It can be useful when a channel emits tuples of values that need to be handled separately. Each element in the tuple is associated with a corresponding element in the <code class="docutils literal notranslate"><span class="pre">tuple</span></code> definition. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">tupleExample</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">input:</span>
<span class="w">    </span><span class="n">tuple</span><span class="w"> </span><span class="n">val</span><span class="o">(</span><span class="n">x</span><span class="o">),</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="s1">&#39;latin.txt&#39;</span><span class="o">)</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    echo &quot;Processing $x&quot;</span>
<span class="s2">    cat - latin.txt &gt; copy</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">Channel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="w"> </span><span class="o">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;alpha&#39;</span><span class="o">],</span><span class="w"> </span><span class="o">[</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;beta&#39;</span><span class="o">],</span><span class="w"> </span><span class="o">[</span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;delta&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">tupleExample</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, the <code class="docutils literal notranslate"><span class="pre">tuple</span></code> input consists of the value <code class="docutils literal notranslate"><span class="pre">x</span></code> and the file <code class="docutils literal notranslate"><span class="pre">latin.txt</span></code>.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">tuple</span></code> definition may contain any of the following qualifiers, as previously described: <code class="docutils literal notranslate"><span class="pre">val</span></code>, <code class="docutils literal notranslate"><span class="pre">env</span></code>, <code class="docutils literal notranslate"><span class="pre">path</span></code> and <code class="docutils literal notranslate"><span class="pre">stdin</span></code>. Files specified with the <code class="docutils literal notranslate"><span class="pre">path</span></code> qualifier are treated exactly the same as standalone <code class="docutils literal notranslate"><span class="pre">path</span></code> inputs.</p>
</section>
<section id="input-repeaters-each">
<h3>Input repeaters (<code class="docutils literal notranslate"><span class="pre">each</span></code>)<a class="headerlink" href="#input-repeaters-each" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">each</span></code> qualifier allows you to repeat the execution of a process for each item in a collection, each time a new value is received. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">alignSequences</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="n">seq</span>
<span class="w">  </span><span class="n">each</span><span class="w"> </span><span class="n">mode</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  t_coffee -in $seq -mode $mode &gt; result</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">sequences</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="s1">&#39;*.fa&#39;</span><span class="o">)</span>
<span class="w">  </span><span class="n">methods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;regular&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;espresso&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;psicoffee&#39;</span><span class="o">]</span>

<span class="w">  </span><span class="n">alignSequences</span><span class="o">(</span><span class="n">sequences</span><span class="o">,</span><span class="w"> </span><span class="n">methods</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, each time a file of sequences is emitted from the <code class="docutils literal notranslate"><span class="pre">sequences</span></code> channel, the process executes <em>three</em> tasks, each running a T-coffee alignment with a different value for the <code class="docutils literal notranslate"><span class="pre">mode</span></code> parameter. This behavior is useful when you need to repeat the same task over a given set of parameters.</p>
<p>Input repeaters can be applied to files as well. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">alignSequences</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="n">seq</span>
<span class="w">  </span><span class="n">each</span><span class="w"> </span><span class="n">mode</span>
<span class="w">  </span><span class="n">each</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="n">lib</span><span class="o">)</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  t_coffee -in $seq -mode $mode -lib $lib &gt; result</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">sequences</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="s1">&#39;*.fa&#39;</span><span class="o">)</span>
<span class="w">  </span><span class="n">methods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;regular&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;espresso&#39;</span><span class="o">]</span>
<span class="w">  </span><span class="n">libraries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="n">file</span><span class="o">(</span><span class="s1">&#39;PQ001.lib&#39;</span><span class="o">),</span><span class="w"> </span><span class="n">file</span><span class="o">(</span><span class="s1">&#39;PQ002.lib&#39;</span><span class="o">),</span><span class="w"> </span><span class="n">file</span><span class="o">(</span><span class="s1">&#39;PQ003.lib&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">]</span>

<span class="w">  </span><span class="n">alignSequences</span><span class="o">(</span><span class="n">sequences</span><span class="o">,</span><span class="w"> </span><span class="n">methods</span><span class="o">,</span><span class="w"> </span><span class="n">libraries</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, each sequence input file emitted by the <code class="docutils literal notranslate"><span class="pre">sequences</span></code> channel triggers six alignment tasks, three with the <code class="docutils literal notranslate"><span class="pre">regular</span></code> method against each library file, and three with the <code class="docutils literal notranslate"><span class="pre">espresso</span></code> method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When multiple repeaters are defined, the process is executed for each <em>combination</em> of them.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Input repeaters currently do not support tuples. However, you can emulate an input repeater on a channel of tuples by using the <a class="reference internal" href="operator.html#operator-combine"><span class="std std-ref">combine</span></a> or <a class="reference internal" href="operator.html#operator-cross"><span class="std std-ref">cross</span></a> operator with other input channels to produce all of the desired input combinations.</p>
</div>
</section>
<section id="multiple-input-channels">
<span id="process-multiple-input-channels"></span><h3>Multiple input channels<a class="headerlink" href="#multiple-input-channels" title="Permalink to this heading">ï</a></h3>
<p>A key feature of processes is the ability to handle inputs from multiple channels.</p>
<p>When two or more channels are declared as process inputs, the process waits until there is a complete input configuration, i.e. until it receives a value from each input channel. When this condition is satisfied, the process consumes a value from each channel and launches a new task, repeating this logic until one or more channels are empty.</p>
<p>As a result, channel values are consumed sequentially and any empty channel will cause the process to wait, even if the other channels have values.</p>
<p>For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">x</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">y</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  echo $x and $y</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">)</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s1">&#39;a&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;c&#39;</span><span class="o">)</span>
<span class="w">  </span><span class="n">foo</span><span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The process <code class="docutils literal notranslate"><span class="pre">foo</span></code> is executed two times because the <code class="docutils literal notranslate"><span class="pre">x</span></code> channel emits only two values, therefore the <code class="docutils literal notranslate"><span class="pre">c</span></code> element is discarded. It outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="ow">and</span> <span class="n">a</span>
<span class="mi">2</span> <span class="ow">and</span> <span class="n">b</span>
</pre></div>
</div>
<p>A different semantic is applied when using a <a class="reference internal" href="channel.html#channel-type-value"><span class="std std-ref">value channel</span></a>. This kind of channel is created by the <a class="reference internal" href="channel.html#channel-value"><span class="std std-ref">Channel.value</span></a> factory method or implicitly when a process is invoked with an argument that is not a channel. By definition, a value channel is bound to a single value and it can be read an unlimited number of times without consuming its content. Therefore, when mixing a value channel with one or more (queue) channels, it does not affect the process termination because the underlying value is applied repeatedly.</p>
<p>To better understand this behavior, compare the previous example with the following one:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">x</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">y</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  echo $x and $y</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">value</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s1">&#39;a&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;c&#39;</span><span class="o">)</span>
<span class="w">  </span><span class="n">foo</span><span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The above example executes the <code class="docutils literal notranslate"><span class="pre">bar</span></code> process three times because <code class="docutils literal notranslate"><span class="pre">x</span></code> is a value channel, therefore its value can be read as many times as needed. The process termination is determined by the contents of <code class="docutils literal notranslate"><span class="pre">y</span></code>. It outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="ow">and</span> <span class="n">a</span>
<span class="mi">1</span> <span class="ow">and</span> <span class="n">b</span>
<span class="mi">1</span> <span class="ow">and</span> <span class="n">c</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In general, multiple input channels should be used to process <em>combinations</em> of different inputs, using the <code class="docutils literal notranslate"><span class="pre">each</span></code> qualifier or value channels. Having multiple queue channels as inputs is equivalent to using the <a class="reference internal" href="operator.html#operator-merge"><span class="std std-ref">merge</span></a> operator, which is not recommended as it may lead to <a class="reference internal" href="cache-and-resume.html#cache-nondeterministic-inputs"><span class="std std-ref">non-deterministic process inputs</span></a>.</p>
</div>
<p>See also: <a class="reference internal" href="channel.html#channel-types"><span class="std std-ref">Channel types</span></a>.</p>
</section>
</section>
<section id="outputs">
<span id="process-output"></span><h2>Outputs<a class="headerlink" href="#outputs" title="Permalink to this heading">ï</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">output</span></code> block allows you to define the output channels of a process, similar to function outputs. A process may have at most one output block, and it must contain at least one output.</p>
<p>The output block follows the syntax shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span><span class="p">:</span>
  <span class="o">&lt;</span><span class="n">output</span> <span class="n">qualifier</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">name</span><span class="o">&gt;</span> <span class="p">[,</span> <span class="o">&lt;</span><span class="n">option</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">option</span> <span class="n">value</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<p>An output definition consists of a <em>qualifier</em> and a <em>name</em>. Some optional attributes can also be specified.</p>
<p>When a process is invoked, each process output is returned as a channel. The examples provided in the following sections demonstrate how to access the output channels of a process.</p>
<p>The following output qualifiers are available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">val</span></code>: Emit the variable with the specified name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code>: (DEPRECATED) Emit a file produced by the process with the specified name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code>: Emit a file produced by the process with the specified name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">env</span></code>: Emit the variable defined in the process environment with the specified name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stdout</span></code>: Emit the <code class="docutils literal notranslate"><span class="pre">stdout</span></code> of the executed process.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple</span></code>: Emit multiple values.</p></li>
</ul>
<section id="output-type-val">
<h3>Output type <code class="docutils literal notranslate"><span class="pre">val</span></code><a class="headerlink" href="#output-type-val" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">val</span></code> qualifier allows you to output any Nextflow variable defined in the process. A common use case is to output a variable that was defined in the <code class="docutils literal notranslate"><span class="pre">input</span></code> block, as shown in the following example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">each</span><span class="w"> </span><span class="n">x</span>

<span class="w">  </span><span class="nl">output:</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">x</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  echo $x &gt; file</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">methods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;prot&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;dna&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;rna&#39;</span><span class="o">]</span>

<span class="w">  </span><span class="n">receiver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">foo</span><span class="o">(</span><span class="n">methods</span><span class="o">)</span>
<span class="w">  </span><span class="n">receiver</span><span class="o">.</span><span class="na">view</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="s2">&quot;Received: $it&quot;</span><span class="w"> </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The output value can be a value literal, an input variable, any other Nextflow variable in the process scope, or a value expression. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="n">infile</span>

<span class="w">  </span><span class="nl">output:</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">x</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="s1">&#39;BB11&#39;</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="s2">&quot;${infile.baseName}.out&quot;</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infile</span><span class="o">.</span><span class="na">name</span>
<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  cat $x &gt; file</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">ch_dummy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="s1">&#39;*&#39;</span><span class="o">).</span><span class="na">first</span><span class="o">()</span>
<span class="w">  </span><span class="o">(</span><span class="n">ch_var</span><span class="o">,</span><span class="w"> </span><span class="n">ch_str</span><span class="o">,</span><span class="w"> </span><span class="n">ch_exp</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">foo</span><span class="o">(</span><span class="n">ch_dummy</span><span class="o">)</span>

<span class="w">  </span><span class="n">ch_var</span><span class="o">.</span><span class="na">view</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="s2">&quot;ch_var: $it&quot;</span><span class="w"> </span><span class="o">}</span>
<span class="w">  </span><span class="n">ch_str</span><span class="o">.</span><span class="na">view</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="s2">&quot;ch_str: $it&quot;</span><span class="w"> </span><span class="o">}</span>
<span class="w">  </span><span class="n">ch_exp</span><span class="o">.</span><span class="na">view</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="s2">&quot;ch_exp: $it&quot;</span><span class="w"> </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="output-type-file">
<h3>Output type <code class="docutils literal notranslate"><span class="pre">file</span></code><a class="headerlink" href="#output-type-file" title="Permalink to this heading">ï</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">file</span></code> qualifier was the standard way to handle input files prior to Nextflow 19.10.0. In later versions of Nextflow, the <code class="docutils literal notranslate"><span class="pre">path</span></code> qualifier should be preferred over <code class="docutils literal notranslate"><span class="pre">file</span></code>.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">file</span></code> qualifier is similar to <code class="docutils literal notranslate"><span class="pre">path</span></code>, but with some differences. The <code class="docutils literal notranslate"><span class="pre">file</span></code> qualifier interprets <code class="docutils literal notranslate"><span class="pre">:</span></code> as a path separator, therefore <code class="docutils literal notranslate"><span class="pre">file</span> <span class="pre">'foo:bar'</span></code> captures two files named <code class="docutils literal notranslate"><span class="pre">foo</span></code> and <code class="docutils literal notranslate"><span class="pre">bar</span></code>, whereas <code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">'foo:bar'</span></code> captures a single file named <code class="docutils literal notranslate"><span class="pre">foo:bar</span></code>. Additionally, <code class="docutils literal notranslate"><span class="pre">file</span></code> does not support all of the extra options provided by <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
</section>
<section id="output-type-path">
<h3>Output type <code class="docutils literal notranslate"><span class="pre">path</span></code><a class="headerlink" href="#output-type-path" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">path</span></code> qualifier allows you to output one or more files produced by the process. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">randomNum</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">output:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;result.txt&#39;</span>

<span class="w">  </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">  echo $RANDOM &gt; result.txt</span>
<span class="s1">  &#39;&#39;&#39;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">randomNum</span><span class="o">()</span>
<span class="w">  </span><span class="n">numbers</span><span class="o">.</span><span class="na">view</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="s2">&quot;Received: ${it.text}&quot;</span><span class="w"> </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, the <code class="docutils literal notranslate"><span class="pre">randomNum</span></code> process creates a file named <code class="docutils literal notranslate"><span class="pre">result.txt</span></code> which contains a random number. Since a <code class="docutils literal notranslate"><span class="pre">path</span></code> output with the same name is declared, that file is emitted by the corresponding output channel. A downstream process with a compatible input channel will be able to receive it.</p>
<p>Available options:</p>
<dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">arity</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 23.09.0-edge.</span></p>
</div>
</dd>
<dd><p>Specify the number of expected files. Can be a number or a range:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="nl">output:</span>
<span class="w">    </span><span class="n">path</span><span class="o">(</span><span class="s1">&#39;one.txt&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">arity:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="o">)</span><span class="w">         </span><span class="c1">// exactly one file is expected</span>
<span class="w">    </span><span class="n">path</span><span class="o">(</span><span class="s1">&#39;pair_*.txt&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">arity:</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="o">)</span><span class="w">      </span><span class="c1">// exactly two files are expected</span>
<span class="w">    </span><span class="n">path</span><span class="o">(</span><span class="s1">&#39;many_*.txt&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">arity:</span><span class="w"> </span><span class="s1">&#39;1..*&#39;</span><span class="o">)</span><span class="w">   </span><span class="c1">// one or more files are expected</span>
</pre></div>
</div>
<p>When a task completes, Nextflow will check whether the produced files for each path output match the declared arity,
and fail if they do not. If the arity is <code class="docutils literal notranslate"><span class="pre">1</span></code>, a sole file object will be emitted. Otherwise, a list will always be emitted,
even if only one file is produced.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">followLinks</span></code></dt><dd><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> target files are return in place of any matching symlink (default: <code class="docutils literal notranslate"><span class="pre">true</span></code>)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">glob</span></code></dt><dd><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> the specified name is interpreted as a glob pattern (default: <code class="docutils literal notranslate"><span class="pre">true</span></code>)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">hidden</span></code></dt><dd><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> hidden files are included in the matching output files (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">includeInputs</span></code></dt><dd><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> any input files matching an output file glob pattern are included.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">maxDepth</span></code></dt><dd><p>Maximum number of directory levels to visit (default: no limit)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">type</span></code></dt><dd><p>Type of paths returned, either <code class="docutils literal notranslate"><span class="pre">file</span></code>, <code class="docutils literal notranslate"><span class="pre">dir</span></code> or <code class="docutils literal notranslate"><span class="pre">any</span></code> (default: <code class="docutils literal notranslate"><span class="pre">any</span></code>, or <code class="docutils literal notranslate"><span class="pre">file</span></code> if the specified file name pattern contains a double star (<code class="docutils literal notranslate"><span class="pre">**</span></code>))</p>
</dd>
</dl>
</section>
<section id="multiple-output-files">
<h3>Multiple output files<a class="headerlink" href="#multiple-output-files" title="Permalink to this heading">ï</a></h3>
<p>When an output file name contains a <code class="docutils literal notranslate"><span class="pre">*</span></code> or <code class="docutils literal notranslate"><span class="pre">?</span></code> wildcard character, it is interpreted as a <a class="reference external" href="http://docs.oracle.com/javase/tutorial/essential/io/fileOps.html#glob">glob</a> path matcher. This allows you to capture multiple files into a list and emit the list as a single value. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">splitLetters</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">output:</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;chunk_*&#39;</span>

<span class="w">    </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    printf &#39;Hola&#39; | split -b 1 - chunk_</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">splitLetters</span>
<span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="n">flatten</span>
<span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="n">view</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="s2">&quot;File: ${it.name} =&gt; ${it.text}&quot;</span><span class="w"> </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>It prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span><span class="p">:</span> <span class="n">chunk_aa</span> <span class="o">=&gt;</span> <span class="n">H</span>
<span class="n">File</span><span class="p">:</span> <span class="n">chunk_ab</span> <span class="o">=&gt;</span> <span class="n">o</span>
<span class="n">File</span><span class="p">:</span> <span class="n">chunk_ac</span> <span class="o">=&gt;</span> <span class="n">l</span>
<span class="n">File</span><span class="p">:</span> <span class="n">chunk_ad</span> <span class="o">=&gt;</span> <span class="n">a</span>
</pre></div>
</div>
<p>By default, all the files matching the specified glob pattern are emitted as a single list. However, as the above example demonstrates, the <a class="reference internal" href="operator.html#operator-flatten"><span class="std std-ref">flatten</span></a> operator can be used to transform the list of files into a channel that emits each file individually.</p>
<p>Some caveats on glob pattern behavior:</p>
<ul class="simple">
<li><p>Input files are not included (unless <code class="docutils literal notranslate"><span class="pre">includeInputs</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>)</p></li>
<li><p>Directories are included, unless the <code class="docutils literal notranslate"><span class="pre">**</span></code> pattern is used to recurse through directories</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Although the input files matching a glob output declaration are not included in the resulting output channel, these files may still be transferred from the task scratch directory to the original task work directory. Therefore, to avoid unnecessary file copies, avoid using loose wildcards when defining output files, e.g. <code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">'*'</span></code>. Instead, use a prefix or a suffix to restrict the set of matching files to only the expected ones, e.g. <code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">'prefix_*.sorted.bam'</span></code>.</p>
</div>
<p>Read more about glob syntax at the following link <a class="reference external" href="http://docs.oracle.com/javase/tutorial/essential/io/fileOps.html#glob">What is a glob?</a></p>
</section>
<section id="dynamic-output-file-names">
<h3>Dynamic output file names<a class="headerlink" href="#dynamic-output-file-names" title="Permalink to this heading">ï</a></h3>
<p>When an output file name needs to be expressed dynamically, it is possible to define it using a dynamic string which references variables in the <code class="docutils literal notranslate"><span class="pre">input</span></code> block or in the script global context. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">species</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="n">seq</span>

<span class="w">  </span><span class="nl">output:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="s2">&quot;${species}.aln&quot;</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  t_coffee -in $seq &gt; ${species}.aln</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, each process execution produces an alignment file whose name depends on the actual value of the <code class="docutils literal notranslate"><span class="pre">species</span></code> input.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The management of output files in Nextflow is often misunderstood.</p>
<p>With other tools it is generally necessary to organize the output files into some kind of directory structure or to guarantee a unique file name scheme, so that result files donât overwrite each other and so they can be referenced unequivocally by downstream tasks.</p>
<p>With Nextflow, in most cases, you donât need to manage the naming of output files, because each task is executed in its own unique directory, so files produced by different tasks canât overwrite each other. Also, metadata can be associated with outputs by using the <a class="reference internal" href="#process-out-tuple"><span class="std std-ref">tuple output</span></a> qualifier, instead of including them in the output file name.</p>
<p>One example in which youâd need to manage the naming of output files is when you use the <code class="docutils literal notranslate"><span class="pre">publishDir</span></code> directive to have output files also in a specific path of your choice. If two tasks have the same filename for their output and you want them to be in the same path specified by <code class="docutils literal notranslate"><span class="pre">publishDir</span></code>, the last task to finish will overwrite the output of the task that finished before. You can dynamically change that by adding the <code class="docutils literal notranslate"><span class="pre">saveAs</span></code> option to your <code class="docutils literal notranslate"><span class="pre">publishDir</span></code> directive.</p>
<p>To sum up, the use of output files with static names over dynamic ones is preferable whenever possible, because it will result in simpler and more portable code.</p>
</div>
</section>
<section id="output-type-env">
<span id="process-env"></span><h3>Output type <code class="docutils literal notranslate"><span class="pre">env</span></code><a class="headerlink" href="#output-type-env" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">env</span></code> qualifier allows you to output a variable defined in the process execution environment:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">myTask</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">output:</span>
<span class="w">    </span><span class="n">env</span><span class="w"> </span><span class="n">FOO</span>

<span class="w">    </span><span class="nl">script:</span>
<span class="w">    </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    FOO=$(ls -la)</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">myTask</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">view</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="s2">&quot;directory contents: $it&quot;</span><span class="w"> </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="output-type-stdout">
<span id="process-stdout"></span><h3>Output type <code class="docutils literal notranslate"><span class="pre">stdout</span></code><a class="headerlink" href="#output-type-stdout" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">stdout</span></code> qualifier allows you to output the <code class="docutils literal notranslate"><span class="pre">stdout</span></code> of the executed process:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">sayHello</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">output:</span>
<span class="w">    </span><span class="n">stdout</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    echo Hello world!</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">sayHello</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">view</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="s2">&quot;I say... $it&quot;</span><span class="w"> </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="output-type-set">
<span id="process-set"></span><h3>Output type <code class="docutils literal notranslate"><span class="pre">set</span></code><a class="headerlink" href="#output-type-set" title="Permalink to this heading">ï</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 19.08.1-edge: </span>Use <code class="docutils literal notranslate"><span class="pre">tuple</span></code> instead.</p>
</div>
</section>
<section id="output-type-tuple">
<span id="process-out-tuple"></span><h3>Output type <code class="docutils literal notranslate"><span class="pre">tuple</span></code><a class="headerlink" href="#output-type-tuple" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">tuple</span></code> qualifier allows you to output multiple values in a single channel. It is useful when you need to associate outputs with metadata, for example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">blast</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">    </span><span class="n">val</span><span class="w"> </span><span class="n">species</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="n">query</span>

<span class="w">  </span><span class="nl">output:</span>
<span class="w">    </span><span class="n">tuple</span><span class="w"> </span><span class="n">val</span><span class="o">(</span><span class="n">species</span><span class="o">),</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="s1">&#39;result&#39;</span><span class="o">)</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    blast -db nr -query $query &gt; result</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">ch_species</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s1">&#39;human&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;cow&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;horse&#39;</span><span class="o">)</span>
<span class="w">  </span><span class="n">ch_query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="s1">&#39;*.fa&#39;</span><span class="o">)</span>

<span class="w">  </span><span class="n">blast</span><span class="o">(</span><span class="n">ch_species</span><span class="o">,</span><span class="w"> </span><span class="n">ch_query</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, a <code class="docutils literal notranslate"><span class="pre">blast</span></code> task is executed for each pair of <code class="docutils literal notranslate"><span class="pre">species</span></code> and <code class="docutils literal notranslate"><span class="pre">query</span></code> that are received. Each task produces a new tuple containing the value for <code class="docutils literal notranslate"><span class="pre">species</span></code> and the file <code class="docutils literal notranslate"><span class="pre">result</span></code>.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">tuple</span></code> definition may contain any of the following qualifiers, as previously described: <code class="docutils literal notranslate"><span class="pre">val</span></code>, <code class="docutils literal notranslate"><span class="pre">path</span></code>, <code class="docutils literal notranslate"><span class="pre">env</span></code> and <code class="docutils literal notranslate"><span class="pre">stdout</span></code>. Files specified with the <code class="docutils literal notranslate"><span class="pre">path</span></code> qualifier are treated exactly the same as standalone <code class="docutils literal notranslate"><span class="pre">path</span></code> inputs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While parentheses for input and output qualifiers are generally optional, they are required when specifying elements in an input/output tuple.</p>
<p>Hereâs an example with a single path output (parentheses optional):</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">output:</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;result.txt&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">hidden:</span><span class="w"> </span><span class="kc">true</span>

<span class="w">    </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    echo &#39;another new line&#39; &gt;&gt; result.txt</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>And hereâs an example with a tuple output (parentheses required):</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">output:</span>
<span class="w">    </span><span class="n">tuple</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="s1">&#39;last_result.txt&#39;</span><span class="o">),</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="s1">&#39;result.txt&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">hidden:</span><span class="w"> </span><span class="kc">true</span><span class="o">)</span>

<span class="w">    </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    echo &#39;another new line&#39; &gt;&gt; result.txt</span>
<span class="s1">    echo &#39;another new line&#39; &gt; last_result.txt</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</section>
<section id="additional-options">
<span id="process-additional-options"></span><h3>Additional options<a class="headerlink" href="#additional-options" title="Permalink to this heading">ï</a></h3>
<p>The following options are available for all process outputs:</p>
<dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">emit:</span> <span class="pre">&lt;name&gt;</span></code></dt><dd><p>Defines the name of the output channel, which can be used to access the channel by name from the process output:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">FOO</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nl">output:</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;hello.txt&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">emit:</span><span class="w"> </span><span class="n">hello</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;bye.txt&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">emit:</span><span class="w"> </span><span class="n">bye</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    echo &quot;hello&quot; &gt; hello.txt</span>
<span class="s2">    echo &quot;bye&quot; &gt; bye.txt</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">FOO</span><span class="o">()</span>
<span class="w">    </span><span class="n">FOO</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">hello</span><span class="o">.</span><span class="na">view</span><span class="o">()</span>
<span class="o">}</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="workflow.html#workflow-process-invocation"><span class="std std-ref">Process invocation</span></a> for more details.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">optional:</span> <span class="pre">true</span> <span class="pre">|</span> <span class="pre">false</span></code></dt><dd><p>Normally, if a specified output is not produced by the task, the task will fail. Setting <code class="docutils literal notranslate"><span class="pre">optional:</span> <span class="pre">true</span></code> will cause the task to not fail, and instead emit nothing to the given output channel.</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="nl">output:</span>
<span class="n">path</span><span class="o">(</span><span class="s2">&quot;output.txt&quot;</span><span class="o">),</span><span class="w"> </span><span class="nl">optional:</span><span class="w"> </span><span class="kc">true</span>
</pre></div>
</div>
<p>In this example, the process is normally expected to produce an <code class="docutils literal notranslate"><span class="pre">output.txt</span></code> file, but in the cases where the file is missing, the task will not fail. The output channel will only contain values for those tasks that produced <code class="docutils literal notranslate"><span class="pre">output.txt</span></code>.</p>
</dd>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>While this option can be used with any process output, it cannot be applied to individual elements of a <a class="reference internal" href="#output-type-tuple"><span class="std std-doc">tuple</span></a> output. The entire tuple must be optional or not optional.</p>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">topic:</span> <span class="pre">&lt;name&gt;</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 23.11.0-edge.</span></p>
</div>
</dd>
<dd><p><em>Experimental: may change in a future release.</em></p>
</dd>
<dd><p>Defines the <span class="xref std std-ref">channel topic</span> to which the output will be sent.</p>
</dd>
</dl>
</section>
</section>
<section id="when">
<h2>When<a class="headerlink" href="#when" title="Permalink to this heading">ï</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">when</span></code> block allows you to define a condition that must be satisfied in order to execute the process. The condition can be any expression that returns a boolean value.</p>
<p>It can be useful to enable/disable the process execution depending on the state of various inputs and parameters. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="n">proteins</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">dbtype</span>

<span class="w">  </span><span class="nl">when:</span>
<span class="w">  </span><span class="n">proteins</span><span class="o">.</span><span class="na">name</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s">/^BB11.*/</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dbtype</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;nr&#39;</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  blastp -query $proteins -db nr</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>As a best practice, it is better to define such control flow logic in the workflow block, i.e. with an <code class="docutils literal notranslate"><span class="pre">if</span></code> statement or with channel operators, to make the process more portable.</p>
</div>
</section>
<section id="directives">
<span id="process-directives"></span><h2>Directives<a class="headerlink" href="#directives" title="Permalink to this heading">ï</a></h2>
<p>Directives are optional settings that affect the execution of the current process.</p>
<p>They must be entered at the top of the process body, before any other declaration blocks (<code class="docutils literal notranslate"><span class="pre">input</span></code>, <code class="docutils literal notranslate"><span class="pre">output</span></code>, etc), and have the following syntax:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="c1">// directive with simple value</span>
<span class="n">name</span><span class="w"> </span><span class="n">value</span>

<span class="c1">// directive with list value</span>
<span class="n">name</span><span class="w"> </span><span class="n">arg1</span><span class="o">,</span><span class="w"> </span><span class="n">arg2</span><span class="o">,</span><span class="w"> </span><span class="n">arg3</span>

<span class="c1">// directive with map value</span>
<span class="n">name</span><span class="w"> </span><span class="nl">key1:</span><span class="w"> </span><span class="n">val1</span><span class="o">,</span><span class="w"> </span><span class="nl">key2:</span><span class="w"> </span><span class="n">val2</span>

<span class="c1">// directive with value and options</span>
<span class="n">name</span><span class="w"> </span><span class="n">arg</span><span class="o">,</span><span class="w"> </span><span class="nl">opt1:</span><span class="w"> </span><span class="n">val1</span><span class="o">,</span><span class="w"> </span><span class="nl">opt2:</span><span class="w"> </span><span class="n">val2</span>
</pre></div>
</div>
<p>By default, directives are evaluated when the process is defined. However, if the value is a dynamic string or closure, it will be evaluated separately for each task, which allows task-specific variables like <code class="docutils literal notranslate"><span class="pre">task</span></code> and <code class="docutils literal notranslate"><span class="pre">val</span></code> inputs to be used.</p>
<p>Some directives are generally available to all processes, while others depend on the <code class="docutils literal notranslate"><span class="pre">executor</span></code> currently defined.</p>
<section id="accelerator">
<span id="process-accelerator"></span><h3>accelerator<a class="headerlink" href="#accelerator" title="Permalink to this heading">ï</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 19.09.0-edge.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">accelerator</span></code> directive allows you to request hardware accelerators (e.g. GPUs) for the task execution. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">accelerator</span><span class="w"> </span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="nl">type:</span><span class="w"> </span><span class="s1">&#39;nvidia-tesla-k80&#39;</span>

<span class="w">    </span><span class="nl">script:</span>
<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    your_gpu_enabled --command --line</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The above examples will request 4 GPUs of type <code class="docutils literal notranslate"><span class="pre">nvidia-tesla-k80</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This directive is only used by certain executors. Refer to the <a class="reference internal" href="executor.html#executor-page"><span class="std std-ref">Executors</span></a> page to see which executors support this directive.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The accelerator <code class="docutils literal notranslate"><span class="pre">type</span></code> option depends on the target execution platform. Refer to the platform-specific documentation for details on the available accelerators:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cloud.google.com/compute/docs/gpus/">Google Cloud</a></p></li>
<li><p><a class="reference external" href="https://kubernetes.io/docs/tasks/manage-gpus/scheduling-gpus/#clusters-containing-different-types-of-gpus">Kubernetes</a></p></li>
</ul>
<p>The accelerator <code class="docutils literal notranslate"><span class="pre">type</span></code> option is not supported for AWS Batch. You can control the accelerator type indirectly through the allowed instance types in your Compute Environment. See the <a class="reference external" href="https://aws.amazon.com/batch/faqs/?#GPU_Scheduling_">AWS Batch FAQs</a> for more information.</p>
</div>
</section>
<section id="afterscript">
<span id="process-afterscript"></span><h3>afterScript<a class="headerlink" href="#afterscript" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">afterScript</span></code> directive allows you to execute a custom (Bash) snippet immediately <em>after</em> the main process has run. This may be useful to clean up your staging area.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When combined with the <a class="reference internal" href="#process-container"><span class="std std-ref">container directive</span></a>, the <code class="docutils literal notranslate"><span class="pre">afterScript</span></code> will be executed outside the specified container. In other words, the <code class="docutils literal notranslate"><span class="pre">afterScript</span></code> is always executed in the host environment.</p>
</div>
</section>
<section id="arch">
<span id="process-arch"></span><h3>arch<a class="headerlink" href="#arch" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">arch</span></code> directive allows you to define the CPU architecture to build the software in use by the processâ task. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">cpu_task</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">spack</span><span class="w"> </span><span class="s1">&#39;blast-plus@2.13.0&#39;</span>
<span class="w">    </span><span class="n">arch</span><span class="w"> </span><span class="s1">&#39;linux/x86_64&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">target:</span><span class="w"> </span><span class="s1">&#39;cascadelake&#39;</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    blastp -query input_sequence -num_threads ${task.cpus}</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The example above declares that the CPU generic architecture is <code class="docutils literal notranslate"><span class="pre">linux/x86_64</span></code> (X86 64 bit), and more specifically that the microarchitecture is <code class="docutils literal notranslate"><span class="pre">cascadelake</span></code> (a specific generation of Intel CPUs).</p>
<p>This directive is currently used by the following Nextflow functionalities:</p>
<ul class="simple">
<li><p>by the <a class="reference internal" href="#spack"><span class="std std-doc">spack</span></a> directive, to build microarchitecture-optimised applications;</p></li>
<li><p>by the <a class="reference internal" href="wave.html#wave-page"><span class="std std-ref">Wave containers</span></a> service, to build containers for one of the generic families of CPU architectures (see below);</p></li>
<li><p>by the <code class="docutils literal notranslate"><span class="pre">spack</span></code> strategy within <a class="reference internal" href="wave.html#wave-page"><span class="std std-ref">Wave containers</span></a>, to optimise the container builds for specific CPU microarchitectures.</p></li>
</ul>
<p>Allowed values for the <code class="docutils literal notranslate"><span class="pre">arch</span></code> directive are as follows, grouped by equivalent family (choices available for the sake of compatibility):</p>
<ul class="simple">
<li><p>X86 64 bit: <code class="docutils literal notranslate"><span class="pre">linux/x86_64</span></code>, <code class="docutils literal notranslate"><span class="pre">x86_64</span></code>, <code class="docutils literal notranslate"><span class="pre">linux/amd64</span></code>, <code class="docutils literal notranslate"><span class="pre">amd64</span></code></p></li>
<li><p>ARM 64 bit: <code class="docutils literal notranslate"><span class="pre">linux/aarch64</span></code>, <code class="docutils literal notranslate"><span class="pre">aarch64</span></code>, <code class="docutils literal notranslate"><span class="pre">linux/arm64</span></code>, <code class="docutils literal notranslate"><span class="pre">arm64</span></code>, <code class="docutils literal notranslate"><span class="pre">linux/arm64/v8</span></code></p></li>
<li><p>ARM 64 bit, older generation: <code class="docutils literal notranslate"><span class="pre">linux/arm64/v7</span></code></p></li>
</ul>
<p>Examples of values for the architecture <code class="docutils literal notranslate"><span class="pre">target</span></code> option are <code class="docutils literal notranslate"><span class="pre">cascadelake</span></code>, <code class="docutils literal notranslate"><span class="pre">icelake</span></code>, <code class="docutils literal notranslate"><span class="pre">zen2</span></code> and <code class="docutils literal notranslate"><span class="pre">zen3</span></code>. See the Spack documentation for the full and up-to-date <a class="reference external" href="https://spack.readthedocs.io/en/latest/basic_usage.html#support-for-specific-microarchitectures">list of meaningful targets</a>.</p>
</section>
<section id="beforescript">
<span id="process-beforescript"></span><h3>beforeScript<a class="headerlink" href="#beforescript" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">beforeScript</span></code> directive allows you to execute a custom (Bash) snippet <em>before</em> the main process script is run. This may be useful to initialise the underlying cluster environment or for other custom initialisation.</p>
<p>For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">beforeScript</span><span class="w"> </span><span class="s1">&#39;source /cluster/bin/setup&#39;</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  echo bar</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When combined with the <a class="reference internal" href="#process-container"><span class="std std-ref">container directive</span></a>, the <code class="docutils literal notranslate"><span class="pre">beforeScript</span></code> will be executed outside the specified container. In other words, the <code class="docutils literal notranslate"><span class="pre">beforeScript</span></code> is always executed in the host environment.</p>
</div>
</section>
<section id="cache">
<span id="process-cache"></span><h3>cache<a class="headerlink" href="#cache" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cache</span></code> directive allows you to store the process results to a local cache. When the cache is enabled <em>and</em> the pipeline is launched with the <a class="reference internal" href="getstarted.html#getstarted-resume"><span class="std std-ref">resume</span></a> option, any task executions that are already cached will be re-used. See the <a class="reference internal" href="cache-and-resume.html#cache-resume-page"><span class="std std-ref">Caching and resuming</span></a> page for more information about how the cache works.</p>
<p>The cache is enabled by default, but you can disable it for a specific process by setting the <code class="docutils literal notranslate"><span class="pre">cache</span></code> directive to <code class="docutils literal notranslate"><span class="pre">false</span></code>. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">noCacheThis</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">cache</span><span class="w"> </span><span class="kc">false</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">your</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">here</span><span class="o">&gt;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The following options are available:</p>
<dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">false</span></code></dt><dd><p>Disable caching.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">true</span></code> (default)</dt><dd><p>Enable caching. Input file metadata (name, size, last updated timestamp) are included in the cache keys.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'deep'</span></code></dt><dd><p>Enable caching. Input file content is included in the cache keys.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'lenient'</span></code></dt><dd><p>Enable caching. Minimal input file metadata (name and size only) are included in the cache keys.</p>
</dd>
<dd><p>This strategy provides a workaround for incorrect caching invalidation observed on shared file systems due to inconsistent file timestamps.</p>
</dd>
</dl>
</section>
<section id="clusteroptions">
<span id="process-clusteroptions"></span><h3>clusterOptions<a class="headerlink" href="#clusteroptions" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">clusterOptions</span></code> directive allows the usage of any native configuration option accepted by your cluster submit command. You can use it to request non-standard resources or use settings that are specific to your cluster and not supported out of the box by Nextflow.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This directive is only used by grid executors. Refer to the <a class="reference internal" href="executor.html#executor-page"><span class="std std-ref">Executors</span></a> page to see which executors support this directive.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>While you can use the <code class="docutils literal notranslate"><span class="pre">clusterOptions</span></code> directive to specify options that are supported as process directives (<code class="docutils literal notranslate"><span class="pre">queue</span></code>, <code class="docutils literal notranslate"><span class="pre">memory</span></code>, <code class="docutils literal notranslate"><span class="pre">time</span></code>, etc), you should not use both at the same time, as it will cause undefined behavior. Most HPC schedulers will either fail or simply ignore one or the other.</p>
</div>
</section>
<section id="conda">
<span id="process-conda"></span><h3>conda<a class="headerlink" href="#conda" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">conda</span></code> directive allows for the definition of the process dependencies using the <a class="reference external" href="https://conda.io">Conda</a> package manager.</p>
<p>Nextflow automatically sets up an environment for the given package names listed by in the <code class="docutils literal notranslate"><span class="pre">conda</span></code> directive. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">conda</span><span class="w"> </span><span class="s1">&#39;bwa=0.7.15&#39;</span>

<span class="w">  </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">  your_command --here</span>
<span class="s1">  &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Multiple packages can be specified separating them with a blank space e.g. <code class="docutils literal notranslate"><span class="pre">bwa=0.7.15</span> <span class="pre">fastqc=0.11.5</span></code>. The name of the channel from where a specific package needs to be downloaded can be specified using the usual Conda notation i.e. prefixing the package with the channel name as shown here <code class="docutils literal notranslate"><span class="pre">bioconda::bwa=0.7.15</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">conda</span></code> directive also allows the specification of a Conda environment file path or the path of an existing environment directory. See the <a class="reference internal" href="conda.html#conda-page"><span class="std std-ref">Conda environments</span></a> page for further details.</p>
</section>
<section id="container">
<span id="process-container"></span><h3>container<a class="headerlink" href="#container" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">container</span></code> directive allows you to execute the process script in a <a class="reference external" href="http://docker.io">Docker</a> container.</p>
<p>It requires the Docker daemon to be running in machine where the pipeline is executed, i.e. the local machine when using the <em>local</em> executor or the cluster nodes when the pipeline is deployed through a <em>grid</em> executor.</p>
<p>For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">runThisInDocker</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">container</span><span class="w"> </span><span class="s1">&#39;dockerbox:tag&#39;</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  &lt;your holy script here&gt;</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Simply replace in the above script <code class="docutils literal notranslate"><span class="pre">dockerbox:tag</span></code> with the name of the Docker image you want to use.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Containers are a very useful way to execute your scripts in a reproducible self-contained environment or to run your pipeline in the cloud.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This directive is ignored for processes that are <a class="reference internal" href="#process-native"><span class="std std-ref">executed natively</span></a>.</p>
</div>
</section>
<section id="containeroptions">
<span id="process-containeroptions"></span><h3>containerOptions<a class="headerlink" href="#containeroptions" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">containerOptions</span></code> directive allows you to specify any container execution option supported by the underlying container engine (ie. Docker, Singularity, etc). This can be useful to provide container settings only for a specific process e.g. mount a custom path:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">runThisWithDocker</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">container</span><span class="w"> </span><span class="s1">&#39;busybox:latest&#39;</span>
<span class="w">    </span><span class="n">containerOptions</span><span class="w"> </span><span class="s1">&#39;--volume /data/db:/db&#39;</span>

<span class="w">    </span><span class="nl">output:</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;output.txt&#39;</span>

<span class="w">    </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    your_command --data /db &gt; output.txt</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This feature is not supported by the <a class="reference internal" href="executor.html#k8s-executor"><span class="std std-ref">Kubernetes</span></a> and <a class="reference internal" href="executor.html#google-lifesciences-executor"><span class="std std-ref">Google Life Sciences</span></a> executors.</p>
</div>
</section>
<section id="cpus">
<span id="process-cpus"></span><h3>cpus<a class="headerlink" href="#cpus" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cpus</span></code> directive allows you to define the number of (logical) CPU required by the processâ task. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">big_job</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">cpus</span><span class="w"> </span><span class="mi">8</span>
<span class="w">  </span><span class="n">executor</span><span class="w"> </span><span class="s1">&#39;sge&#39;</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  blastp -query input_sequence -num_threads ${task.cpus}</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This directive is required for tasks that execute multi-process or multi-threaded commands/tools and it is meant to reserve enough CPUs when a pipeline task is executed through a cluster resource manager.</p>
<p>See also: <a class="reference internal" href="#penv"><span class="std std-doc">penv</span></a>, <a class="reference internal" href="#memory"><span class="std std-doc">memory</span></a>, <a class="reference internal" href="#time"><span class="std std-doc">time</span></a>, <a class="reference internal" href="#queue"><span class="std std-doc">queue</span></a>, <a class="reference internal" href="#maxforks"><span class="std std-doc">maxForks</span></a></p>
</section>
<section id="debug">
<span id="process-debug"></span><h3>debug<a class="headerlink" href="#debug" title="Permalink to this heading">ï</a></h3>
<p>By default the <code class="docutils literal notranslate"><span class="pre">stdout</span></code> produced by the commands executed in all processes is ignored. By setting the <code class="docutils literal notranslate"><span class="pre">debug</span></code> directive to <code class="docutils literal notranslate"><span class="pre">true</span></code>, you can forward the process <code class="docutils literal notranslate"><span class="pre">stdout</span></code> to the current top running process <code class="docutils literal notranslate"><span class="pre">stdout</span></code> file, showing it in the shell terminal.</p>
<p>For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">sayHello</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">debug</span><span class="w"> </span><span class="kc">true</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="s2">&quot;echo Hello&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hello</span>
</pre></div>
</div>
<p>Without specifying <code class="docutils literal notranslate"><span class="pre">debug</span> <span class="pre">true</span></code>, you wonât see the <code class="docutils literal notranslate"><span class="pre">Hello</span></code> string printed out when executing the above example.</p>
</section>
<section id="disk">
<span id="process-disk"></span><h3>disk<a class="headerlink" href="#disk" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">disk</span></code> directive allows you to define how much local disk storage the process is allowed to use. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">big_job</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">disk</span><span class="w"> </span><span class="s1">&#39;2 GB&#39;</span>
<span class="w">    </span><span class="n">executor</span><span class="w"> </span><span class="s1">&#39;cirrus&#39;</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    your task script here</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The following memory unit suffix can be used when specifying the disk value:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>B</p></td>
<td><p>Bytes</p></td>
</tr>
<tr class="row-odd"><td><p>KB</p></td>
<td><p>Kilobytes</p></td>
</tr>
<tr class="row-even"><td><p>MB</p></td>
<td><p>Megabytes</p></td>
</tr>
<tr class="row-odd"><td><p>GB</p></td>
<td><p>Gigabytes</p></td>
</tr>
<tr class="row-even"><td><p>TB</p></td>
<td><p>Terabytes</p></td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="script.html#implicit-classes-memoryunit"><span class="std std-ref">MemoryUnit</span></a> for more information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This directive is only used by certain executors. Refer to the <a class="reference internal" href="executor.html#executor-page"><span class="std std-ref">Executors</span></a> page to see which executors support this directive.</p>
</div>
<p>See also: <a class="reference internal" href="#cpus"><span class="std std-doc">cpus</span></a>, <a class="reference internal" href="#memory"><span class="std std-doc">memory</span></a> <a class="reference internal" href="#time"><span class="std std-doc">time</span></a>, <a class="reference internal" href="#queue"><span class="std std-doc">queue</span></a> and <a class="reference internal" href="#dynamic-computing-resources"><span class="std std-doc">Dynamic computing resources</span></a>.</p>
</section>
<section id="echo">
<span id="process-echo"></span><h3>echo<a class="headerlink" href="#echo" title="Permalink to this heading">ï</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 22.04.0: </span>Use <code class="docutils literal notranslate"><span class="pre">debug</span></code> instead</p>
</div>
</section>
<section id="errorstrategy">
<span id="process-error-strategy"></span><h3>errorStrategy<a class="headerlink" href="#errorstrategy" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">errorStrategy</span></code> directive allows you to define how an error condition is managed by the process. By default when an error status is returned by the executed script, the process stops immediately. This in turn forces the entire pipeline to terminate.</p>
<p>The following error strategies are available:</p>
<dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">terminate</span></code> (default)</dt><dd><p>Terminate the execution as soon as an error condition is reported. Pending jobs are killed.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">finish</span></code></dt><dd><p>Initiate an orderly pipeline shutdown when an error condition is raised, waiting for the completion of any submitted jobs.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ignore</span></code></dt><dd><p>Ignore process execution errors.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">retry</span></code></dt><dd><p>Re-submit any process that returns an error condition.</p>
</dd>
</dl>
<p>When setting the <code class="docutils literal notranslate"><span class="pre">errorStrategy</span></code> directive to <code class="docutils literal notranslate"><span class="pre">ignore</span></code> the process doesnât stop on an error condition, it just reports a message notifying you of the error event.</p>
<p>For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">ignoreAnyError</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">errorStrategy</span><span class="w"> </span><span class="s1">&#39;ignore&#39;</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">your</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">here</span><span class="o">&gt;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By definition, a command script fails when it ends with a non-zero exit status.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">retry</span></code> error strategy allows you to re-submit for execution a process returning an error condition. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">retryIfFail</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">errorStrategy</span><span class="w"> </span><span class="s1">&#39;retry&#39;</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">your</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">here</span><span class="o">&gt;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The number of times a failing process is re-executed is defined by the <a class="reference internal" href="#maxretries"><span class="std std-doc">maxRetries</span></a> and <a class="reference internal" href="#maxerrors"><span class="std std-doc">maxErrors</span></a> directives.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>More complex strategies depending on the task exit status or other parametric values can be defined using a dynamic <code class="docutils literal notranslate"><span class="pre">errorStrategy</span></code>. See the <a class="reference internal" href="#dynamic-directives"><span class="std std-doc">Dynamic directives</span></a> section for details.</p>
</div>
<p>See also: <a class="reference internal" href="#maxerrors"><span class="std std-doc">maxErrors</span></a>, <a class="reference internal" href="#maxretries"><span class="std std-doc">maxRetries</span></a> and <a class="reference internal" href="#dynamic-computing-resources"><span class="std std-doc">Dynamic computing resources</span></a>.</p>
</section>
<section id="executor">
<span id="process-executor"></span><h3>executor<a class="headerlink" href="#executor" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">executor</span></code> defines the underlying system where processes are executed. By default a process uses the executor defined globally in the <code class="docutils literal notranslate"><span class="pre">nextflow.config</span></code> file.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">executor</span></code> directive allows you to configure what executor has to be used by the process, overriding the default configuration.</p>
<p>The following executors are available:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Executor</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">awsbatch</span></code></p></td>
<td><p><a class="reference external" href="https://aws.amazon.com/batch/">AWS Batch</a> service</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">azurebatch</span></code></p></td>
<td><p><a class="reference external" href="https://azure.microsoft.com/en-us/services/batch/">Azure Batch</a> service</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">condor</span></code></p></td>
<td><p><a class="reference external" href="https://research.cs.wisc.edu/htcondor/">HTCondor</a> job scheduler</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">google-lifesciences</span></code></p></td>
<td><p><a class="reference external" href="https://cloud.google.com/life-sciences">Google Genomics Pipelines</a> service</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ignite</span></code></p></td>
<td><p><a class="reference external" href="https://ignite.apache.org/">Apache Ignite</a> cluster</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">k8s</span></code></p></td>
<td><p><a class="reference external" href="https://kubernetes.io/">Kubernetes</a> cluster</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">local</span></code></p></td>
<td><p>The computer where <code class="docutils literal notranslate"><span class="pre">Nextflow</span></code> is launched</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lsf</span></code></p></td>
<td><p><a class="reference external" href="http://en.wikipedia.org/wiki/Platform_LSF">Platform LSF</a> job scheduler</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">moab</span></code></p></td>
<td><p><a class="reference external" href="http://www.adaptivecomputing.com/moab-hpc-basic-edition/">Moab</a> job scheduler</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">nqsii</span></code></p></td>
<td><p><a class="reference external" href="https://www.rz.uni-kiel.de/en/our-portfolio/hiperf/nec-linux-cluster">NQSII</a> job scheduler</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">oge</span></code></p></td>
<td><p>Alias for the <code class="docutils literal notranslate"><span class="pre">sge</span></code> executor</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pbs</span></code></p></td>
<td><p><a class="reference external" href="http://en.wikipedia.org/wiki/Portable_Batch_System">PBS/Torque</a> job scheduler</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pbspro</span></code></p></td>
<td><p><a class="reference external" href="https://www.pbsworks.com/">PBS Pro</a> job scheduler</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sge</span></code></p></td>
<td><p>Sun Grid Engine / <a class="reference external" href="http://gridscheduler.sourceforge.net/">Open Grid Engine</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">slurm</span></code></p></td>
<td><p><a class="reference external" href="https://en.wikipedia.org/wiki/Slurm_Workload_Manager">SLURM</a> workload manager</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">tes</span></code></p></td>
<td><p><a class="reference external" href="https://github.com/ga4gh/task-execution-schemas">GA4GH TES</a> service</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">uge</span></code></p></td>
<td><p>Alias for the <code class="docutils literal notranslate"><span class="pre">sge</span></code> executor</p></td>
</tr>
</tbody>
</table>
<p>The following example shows how to set the processâs executor:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">doSomething</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">executor</span><span class="w"> </span><span class="s1">&#39;sge&#39;</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">your</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">here</span><span class="o">&gt;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Each executor supports additional directives and <code class="docutils literal notranslate"><span class="pre">executor</span></code> configuration options. Refer to the <a class="reference internal" href="executor.html#executor-page"><span class="std std-ref">Executors</span></a> page to see what each executor supports.</p>
</div>
</section>
<section id="ext">
<span id="process-ext"></span><h3>ext<a class="headerlink" href="#ext" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">ext</span></code> is a special directive used as <em>namespace</em> for user custom process directives. This can be useful for advanced configuration options. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">mapping</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">container</span><span class="w"> </span><span class="s2">&quot;biocontainers/star:${task.ext.version}&quot;</span>

<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="n">genome</span>
<span class="w">  </span><span class="n">tuple</span><span class="w"> </span><span class="n">val</span><span class="o">(</span><span class="n">sampleId</span><span class="o">),</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="n">reads</span><span class="o">)</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  STAR --genomeDir $genome --readFilesIn $reads ${task.ext.args ?: &#39;&#39;}</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, the process container version is controlled by <code class="docutils literal notranslate"><span class="pre">ext.version</span></code>, and the script supports additional command line arguments through <code class="docutils literal notranslate"><span class="pre">ext.args</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ext</span></code> directive can be set in the process definition:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">mapping</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">ext</span><span class="w"> </span><span class="nl">version:</span><span class="w"> </span><span class="s1">&#39;2.5.3&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">args:</span><span class="w"> </span><span class="s1">&#39;--foo --bar&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Or in the Nextflow configuration:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="o">.</span><span class="na">ext</span><span class="o">.</span><span class="na">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;2.5.3&#39;</span>
<span class="n">process</span><span class="o">.</span><span class="na">ext</span><span class="o">.</span><span class="na">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;--foo --bar&#39;</span>
</pre></div>
</div>
</section>
<section id="fair">
<span id="process-fair"></span><h3>fair<a class="headerlink" href="#fair" title="Permalink to this heading">ï</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 22.12.0-edge.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">fair</span></code> directive, when enabled, guarantees that process outputs will be emitted in the order in which they were received. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">fair</span><span class="w"> </span><span class="kc">true</span>

<span class="w">    </span><span class="nl">input:</span>
<span class="w">    </span><span class="n">val</span><span class="w"> </span><span class="n">x</span>
<span class="w">    </span><span class="nl">output:</span>
<span class="w">    </span><span class="n">tuple</span><span class="w"> </span><span class="n">val</span><span class="o">(</span><span class="n">task</span><span class="o">.</span><span class="na">index</span><span class="o">),</span><span class="w"> </span><span class="n">val</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>

<span class="w">    </span><span class="nl">script:</span>
<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    sleep \$((RANDOM % 3))</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">channel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s1">&#39;A&#39;</span><span class="o">,</span><span class="s1">&#39;B&#39;</span><span class="o">,</span><span class="s1">&#39;C&#39;</span><span class="o">,</span><span class="s1">&#39;D&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">view</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The above example produces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">A</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">B</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="n">C</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="n">D</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="label">
<span id="process-label"></span><h3>label<a class="headerlink" href="#label" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">label</span></code> directive allows the annotation of processes with mnemonic identifier of your choice. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">bigTask</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">label</span><span class="w"> </span><span class="s1">&#39;big_mem&#39;</span>

<span class="w">  </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">  &lt;task script&gt;</span>
<span class="s1">  &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The same label can be applied to more than a process and multiple labels can be applied to the same process using the <code class="docutils literal notranslate"><span class="pre">label</span></code> directive more than one time.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A label must consist of alphanumeric characters or <code class="docutils literal notranslate"><span class="pre">_</span></code>, must start with an alphabetic character and must end with an alphanumeric character.</p>
</div>
<p>Labels are useful to organise workflow processes in separate groups which can be referenced in the configuration file to select and configure subset of processes having similar computing requirements. See the <a class="reference internal" href="config.html#config-process-selectors"><span class="std std-ref">Process selectors</span></a> documentation for details.</p>
<p>See also: <a class="reference internal" href="#resourcelabels"><span class="std std-doc">resourceLabels</span></a></p>
</section>
<section id="machinetype">
<span id="process-machinetype"></span><h3>machineType<a class="headerlink" href="#machinetype" title="Permalink to this heading">ï</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 19.07.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">machineType</span></code> can be used to specify a predefined Google Compute Platform <a class="reference external" href="https://cloud.google.com/compute/docs/machine-types">machine type</a> when running using the <a class="reference internal" href="executor.html#google-lifesciences-executor"><span class="std std-ref">Google Life Sciences</span></a> executor.</p>
<p>This directive is optional and if specified overrides the cpus and memory directives:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">machineType</span><span class="w"> </span><span class="s1">&#39;n1-highmem-8&#39;</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  &lt;your script here&gt;</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>See also: <a class="reference internal" href="#cpus"><span class="std std-doc">cpus</span></a> and <a class="reference internal" href="#memory"><span class="std std-doc">memory</span></a>.</p>
</section>
<section id="maxsubmitawait-experimental">
<span id="process-maxsubmitawait"></span><h3>maxSubmitAwait (experimental)<a class="headerlink" href="#maxsubmitawait-experimental" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">maxSubmitAwait</span></code> directives allows you to specify how long a task can remain in submission queue without being executed.
Elapsed this time the task execution will fail.</p>
<p>When used along with <code class="docutils literal notranslate"><span class="pre">retry</span></code> error strategy, it can be useful to re-schedule the task to a difference queue or
resource requirement. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">errorStrategy</span><span class="w"> </span><span class="s1">&#39;retry&#39;</span>
<span class="w">  </span><span class="n">maxSubmitAwait</span><span class="w"> </span><span class="s1">&#39;10 mins&#39;</span>
<span class="w">  </span><span class="n">maxRetries</span><span class="w"> </span><span class="mi">3</span>
<span class="w">  </span><span class="n">queue</span><span class="w"> </span><span class="s2">&quot;${task.submitAttempt==1 : &#39;spot-compute&#39; : &#39;on-demand-compute&#39;}&quot;</span>
<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">  your_job --here</span>
<span class="s1">  &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example the task is submitted to the <code class="docutils literal notranslate"><span class="pre">spot-compute</span></code> on the first attempt (<code class="docutils literal notranslate"><span class="pre">task.submitAttempt==1</span></code>). If the
task execution does not start in the 10 minutes, a failure is reported and a new submission is attempted using the
queue named <code class="docutils literal notranslate"><span class="pre">on-demand-compute</span></code>.</p>
</section>
<section id="maxerrors">
<span id="process-maxerrors"></span><h3>maxErrors<a class="headerlink" href="#maxerrors" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">maxErrors</span></code> directive allows you to specify the maximum number of times a process can fail when using the <code class="docutils literal notranslate"><span class="pre">retry</span></code> error strategy. By default this directive is disabled, you can set it as shown in the example below:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">retryIfFail</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">errorStrategy</span><span class="w"> </span><span class="s1">&#39;retry&#39;</span>
<span class="w">  </span><span class="n">maxErrors</span><span class="w"> </span><span class="mi">5</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  echo &#39;do this as that .. &#39;</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This setting considers the <strong>total</strong> errors accumulated for a given process, across all instances. If you want to control the number of times a process <strong>instance</strong> (aka task) can fail, use <code class="docutils literal notranslate"><span class="pre">maxRetries</span></code>.</p>
</div>
<p>See also: <a class="reference internal" href="#errorstrategy"><span class="std std-doc">errorStrategy</span></a> and <a class="reference internal" href="#maxretries"><span class="std std-doc">maxRetries</span></a>.</p>
</section>
<section id="maxforks">
<span id="process-maxforks"></span><h3>maxForks<a class="headerlink" href="#maxforks" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">maxForks</span></code> directive allows you to define the maximum number of process instances that can be executed in parallel. By default this value is equals to the number of CPU cores available minus 1.</p>
<p>If you want to execute a process in a sequential manner, set this directive to one. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">doNotParallelizeIt</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">maxForks</span><span class="w"> </span><span class="mi">1</span>

<span class="w">  </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">  &lt;your script here&gt;</span>
<span class="s1">  &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="maxretries">
<span id="process-maxretries"></span><h3>maxRetries<a class="headerlink" href="#maxretries" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">maxRetries</span></code> directive allows you to define the maximum number of times a process instance can be re-submitted in case of failure. This value is applied only when using the <code class="docutils literal notranslate"><span class="pre">retry</span></code> error strategy. By default only one retry is allowed, you can increase this value as shown below:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">retryIfFail</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">errorStrategy</span><span class="w"> </span><span class="s1">&#39;retry&#39;</span>
<span class="w">    </span><span class="n">maxRetries</span><span class="w"> </span><span class="mi">3</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    echo &#39;do this as that .. &#39;</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a subtle but important difference between <code class="docutils literal notranslate"><span class="pre">maxRetries</span></code> and the <code class="docutils literal notranslate"><span class="pre">maxErrors</span></code> directive. The latter defines the total number of errors that are allowed during the process execution (the same process can launch different execution instances), while the <code class="docutils literal notranslate"><span class="pre">maxRetries</span></code> defines the maximum number of times the same process execution can be retried in case of an error.</p>
</div>
<p>See also: <a class="reference internal" href="#errorstrategy"><span class="std std-doc">errorStrategy</span></a> and <a class="reference internal" href="#maxerrors"><span class="std std-doc">maxErrors</span></a>.</p>
</section>
<section id="memory">
<span id="process-memory"></span><h3>memory<a class="headerlink" href="#memory" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">memory</span></code> directive allows you to define how much memory the process is allowed to use. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">big_job</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">memory</span><span class="w"> </span><span class="s1">&#39;2 GB&#39;</span>
<span class="w">    </span><span class="n">executor</span><span class="w"> </span><span class="s1">&#39;sge&#39;</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    your task script here</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The following memory unit suffix can be used when specifying the memory value:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>B</p></td>
<td><p>Bytes</p></td>
</tr>
<tr class="row-odd"><td><p>KB</p></td>
<td><p>Kilobytes</p></td>
</tr>
<tr class="row-even"><td><p>MB</p></td>
<td><p>Megabytes</p></td>
</tr>
<tr class="row-odd"><td><p>GB</p></td>
<td><p>Gigabytes</p></td>
</tr>
<tr class="row-even"><td><p>TB</p></td>
<td><p>Terabytes</p></td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="script.html#implicit-classes-memoryunit"><span class="std std-ref">MemoryUnit</span></a> for more information.</p>
<p>See also: <a class="reference internal" href="#cpus"><span class="std std-doc">cpus</span></a>, <a class="reference internal" href="#time"><span class="std std-doc">time</span></a>, <a class="reference internal" href="#queue"><span class="std std-doc">queue</span></a> and <a class="reference internal" href="#dynamic-computing-resources"><span class="std std-doc">Dynamic computing resources</span></a>.</p>
</section>
<section id="module">
<span id="process-module"></span><h3>module<a class="headerlink" href="#module" title="Permalink to this heading">ï</a></h3>
<p><a class="reference external" href="http://modules.sourceforge.net/">Environment Modules</a> is a package manager that allows you to dynamically configure your execution environment and easily switch between multiple versions of the same software tool.</p>
<p>If it is available in your system you can use it with Nextflow in order to configure the processes execution environment in your pipeline.</p>
<p>In a process definition you can use the <code class="docutils literal notranslate"><span class="pre">module</span></code> directive to load a specific module version to be used in the process execution environment. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">basicExample</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">module</span><span class="w"> </span><span class="s1">&#39;ncbi-blast/2.2.27&#39;</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  blastp -query &lt;etc..&gt;</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>You can repeat the <code class="docutils literal notranslate"><span class="pre">module</span></code> directive for each module you need to load. Alternatively multiple modules can be specified in a single <code class="docutils literal notranslate"><span class="pre">module</span></code> directive by separating all the module names by using a <code class="docutils literal notranslate"><span class="pre">:</span></code> (colon) character as shown below:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">manyModules</span><span class="w"> </span><span class="o">{</span>

<span class="w">   </span><span class="n">module</span><span class="w"> </span><span class="s1">&#39;ncbi-blast/2.2.27:t_coffee/10.0:clustalw/2.1&#39;</span>

<span class="w">   </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">   blastp -query &lt;etc..&gt;</span>
<span class="s2">   &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="penv">
<span id="process-penv"></span><h3>penv<a class="headerlink" href="#penv" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">penv</span></code> directive allows you to define the parallel environment to be used when submitting a parallel task to the <a class="reference internal" href="executor.html#sge-executor"><span class="std std-ref">SGE</span></a> resource manager. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">big_job</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">cpus</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="n">penv</span><span class="w"> </span><span class="s1">&#39;smp&#39;</span>
<span class="w">  </span><span class="n">executor</span><span class="w"> </span><span class="s1">&#39;sge&#39;</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  blastp -query input_sequence -num_threads ${task.cpus}</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This configuration depends on the parallel environment provided by your grid engine installation. Refer to your cluster documentation or contact your admin to learn more about this.</p>
<p>See also: <a class="reference internal" href="#cpus"><span class="std std-doc">cpus</span></a>, <a class="reference internal" href="#memory"><span class="std std-doc">memory</span></a>, <a class="reference internal" href="#time"><span class="std std-doc">time</span></a></p>
</section>
<section id="pod">
<span id="process-pod"></span><h3>pod<a class="headerlink" href="#pod" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">pod</span></code> directive allows the definition of pod specific settings, such as environment variables, secrets, and config maps, when using the <a class="reference internal" href="executor.html#k8s-executor"><span class="std std-ref">Kubernetes</span></a> executor.</p>
<p>For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">your_task</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">pod</span><span class="w"> </span><span class="nl">env:</span><span class="w"> </span><span class="s1">&#39;FOO&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">value:</span><span class="w"> </span><span class="s1">&#39;bar&#39;</span>

<span class="w">  </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">  echo $FOO</span>
<span class="s1">  &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The above snippet defines an environment variable named <code class="docutils literal notranslate"><span class="pre">FOO</span></code> whose value is <code class="docutils literal notranslate"><span class="pre">bar</span></code>.</p>
<p>When defined in the Nextflow configuration file, a pod setting can be defined as a map:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">pod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="nl">env:</span><span class="w"> </span><span class="s1">&#39;FOO&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">value:</span><span class="w"> </span><span class="s1">&#39;bar&#39;</span><span class="o">]</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Or as a list of maps:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">pod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>
<span class="w">    </span><span class="o">[</span><span class="nl">env:</span><span class="w"> </span><span class="s1">&#39;FOO&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">value:</span><span class="w"> </span><span class="s1">&#39;bar&#39;</span><span class="o">],</span>
<span class="w">    </span><span class="o">[</span><span class="nl">secret:</span><span class="w"> </span><span class="s1">&#39;my-secret/key1&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">mountPath:</span><span class="w"> </span><span class="s1">&#39;/etc/file.txt&#39;</span><span class="o">]</span>
<span class="w">  </span><span class="o">]</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The following options are available:</p>
<dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">affinity:</span> <span class="pre">&lt;config&gt;</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 22.01.0-edge.</span></p>
</div>
</dd>
<dd><p>Specifies the pod <a class="reference external" href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity">affinity</a> with the given configuration.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">annotation:</span> <span class="pre">'&lt;name&gt;',</span> <span class="pre">value:</span> <span class="pre">'&lt;value&gt;'</span></code></dt><dd><p><em>Can be specified multiple times</em></p>
</dd>
<dd><p>Defines a pod <a class="reference external" href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/">annotation</a> with the given name and value.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">automountServiceAccountToken:</span> <span class="pre">true</span> <span class="pre">|</span> <span class="pre">false</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 22.01.0-edge.</span></p>
</div>
</dd>
<dd><p>Specifies whether to <a class="reference external" href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#opt-out-of-api-credential-automounting">automount service account token</a> into the pod (default: <code class="docutils literal notranslate"><span class="pre">true</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">config:</span> <span class="pre">'&lt;configMap&gt;/&lt;key&gt;',</span> <span class="pre">mountPath:</span> <span class="pre">'&lt;/absolute/path&gt;'</span></code></dt><dd><p><em>Can be specified multiple times</em></p>
</dd>
<dd><p>Mounts a <a class="reference external" href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/">ConfigMap</a> with name and optional key to the given path. If the key is omitted, the path is interpreted as a directory and all entries in the <code class="docutils literal notranslate"><span class="pre">ConfigMap</span></code> are exposed in that path.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">csi:</span> <span class="pre">'&lt;name&gt;',</span> <span class="pre">mountPath:</span> <span class="pre">'&lt;/absolute/path&gt;'</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 22.11.0-edge.</span></p>
</div>
</dd>
<dd><p><em>Can be specified multiple times</em></p>
</dd>
<dd><p>Mounts a <a class="reference external" href="https://kubernetes.io/docs/concepts/storage/ephemeral-volumes/#csi-ephemeral-volumes">CSI ephemeral volume</a> by name to the given path.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">emptyDir:</span> <span class="pre">&lt;config&gt;,</span> <span class="pre">mountPath:</span> <span class="pre">'&lt;/absolute/path&gt;'</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 22.11.0-edge.</span></p>
</div>
</dd>
<dd><p><em>Can be specified multiple times</em></p>
</dd>
<dd><p>Mounts an <a class="reference external" href="https://kubernetes.io/docs/concepts/storage/volumes/#emptydir">emptyDir</a> with the given configuration to the given path.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">env:</span> <span class="pre">'&lt;name&gt;',</span> <span class="pre">config:</span> <span class="pre">'&lt;configMap&gt;/&lt;key&gt;'</span></code></dt><dd><p><em>Can be specified multiple times</em></p>
</dd>
<dd><p>Defines an environment variable whose value is defined by the given <a class="reference external" href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/">ConfigMap</a> and key.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">env:</span> <span class="pre">'&lt;name&gt;',</span> <span class="pre">fieldPath:</span> <span class="pre">'&lt;fieldPath&gt;'</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 21.09.1-edge.</span></p>
</div>
</dd>
<dd><p><em>Can be specified multiple times</em></p>
</dd>
<dd><p>Defines an environment variable whose value is defined by the given <a class="reference external" href="https://kubernetes.io/docs/tasks/inject-data-application/environment-variable-expose-pod-information/#use-pod-fields-as-values-for-environment-variables">field path</a> value.</p>
</dd>
<dd><p>For example, the following pod option:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">pod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="nl">env:</span><span class="w"> </span><span class="s1">&#39;MY_NODE_NAME&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">fieldPath:</span><span class="w"> </span><span class="s1">&#39;spec.nodeName&#39;</span><span class="o">]</span>
</pre></div>
</div>
<p>Maps to the following pod spec:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">env</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MY_NODE_NAME</span>
<span class="w">    </span><span class="nt">valueFrom</span><span class="p">:</span>
<span class="w">      </span><span class="nt">fieldRef</span><span class="p">:</span>
<span class="w">        </span><span class="nt">fieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spec.nodeName</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">env:</span> <span class="pre">'&lt;name&gt;',</span> <span class="pre">secret:</span> <span class="pre">'&lt;secret&gt;/&lt;key&gt;'</span></code></dt><dd><p><em>Can be specified multiple times</em></p>
</dd>
<dd><p>Defines an environment variable whose value is defined by the given <a class="reference external" href="https://kubernetes.io/docs/concepts/configuration/secret/">Secret</a> and key.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">env:</span> <span class="pre">'&lt;name&gt;',</span> <span class="pre">value:</span> <span class="pre">'&lt;value&gt;'</span></code></dt><dd><p><em>Can be specified multiple times</em></p>
</dd>
<dd><p>Defines an environment variable with the given name and value.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">hostPath:</span> <span class="pre">'/host/absolute/path',</span> <span class="pre">mountPath:</span> <span class="pre">'&lt;/pod/absolute/path&gt;'</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 23.10.0.</span></p>
</div>
</dd>
<dd><p><em>Can be specified multiple times</em></p>
</dd>
<dd><p>Allows creating <a class="reference external" href="https://kubernetes.io/docs/concepts/storage/volumes/#hostpath">hostPath</a> volume and access it with the specified <code class="docutils literal notranslate"><span class="pre">mountPath</span></code> in the pod.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">imagePullPolicy:</span> <span class="pre">'IfNotPresent'</span> <span class="pre">|</span> <span class="pre">'Always'</span> <span class="pre">|</span> <span class="pre">'Never'</span></code></dt><dd><p>Specifies the <a class="reference external" href="https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy">image pull policy</a> used by the pod to pull the container image.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">imagePullSecret:</span> <span class="pre">'&lt;name&gt;'</span></code></dt><dd><p>Specifies the <a class="reference external" href="https://kubernetes.io/docs/concepts/containers/images/#specifying-imagepullsecrets-on-a-pod">image pull secret</a> used to access a private container image registry.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">label:</span> <span class="pre">'&lt;name&gt;',</span> <span class="pre">value:</span> <span class="pre">'&lt;value&gt;'</span></code></dt><dd><p><em>Can be specified multiple times</em></p>
</dd>
<dd><p>Defines a pod <a class="reference external" href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/">label</a> with the given name and value.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nodeSelector:</span> <span class="pre">&lt;config&gt;</span></code></dt><dd><p>Specifies the <a class="reference external" href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector">node selector</a> with the given configuration.</p>
</dd>
<dd><p>The configuration can be a map or a string:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="c1">// map</span>
<span class="n">pod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="nl">nodeSelector:</span><span class="w"> </span><span class="o">[</span><span class="nl">disktype:</span><span class="w"> </span><span class="s1">&#39;ssd&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">cpu:</span><span class="w"> </span><span class="s1">&#39;intel&#39;</span><span class="o">]]</span>

<span class="c1">// string</span>
<span class="n">pod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="nl">nodeSelector:</span><span class="w"> </span><span class="s1">&#39;disktype=ssd,cpu=intel&#39;</span><span class="o">]</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">priorityClassName:</span> <span class="pre">'&lt;name&gt;'</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 22.01.0-edge.</span></p>
</div>
</dd>
<dd><p>Specifies the <a class="reference external" href="https://kubernetes.io/docs/concepts/scheduling-eviction/pod-priority-preemption/">priority class name</a> for pods.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">privileged:</span> <span class="pre">true</span> <span class="pre">|</span> <span class="pre">false</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 22.05.0-edge.</span></p>
</div>
</dd>
<dd><p>Specifies whether the pod should run as a <em>privileged</em> container (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">runAsUser:</span> <span class="pre">'&lt;uid&gt;'</span></code></dt><dd><p>Specifies the user ID with which to run the container. Shortcut for the <code class="docutils literal notranslate"><span class="pre">securityContext</span></code> option.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">schedulerName:</span> <span class="pre">'&lt;name&gt;'</span></code></dt><dd><p>Specifies which <a class="reference external" href="https://kubernetes.io/docs/tasks/extend-kubernetes/configure-multiple-schedulers/#specify-schedulers-for-pods">scheduler</a> is used to schedule the container.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">secret:</span> <span class="pre">'&lt;secret&gt;/&lt;key&gt;',</span> <span class="pre">mountPath:</span> <span class="pre">'&lt;/absolute/path&gt;'</span></code></dt><dd><p><em>Can be specified multiple times</em></p>
</dd>
<dd><p>Mounts a <a class="reference external" href="https://kubernetes.io/docs/concepts/configuration/secret/">Secret</a> with name and optional key to the given path. If the key is omitted, the path is interpreted as a directory and all entries in the <code class="docutils literal notranslate"><span class="pre">Secret</span></code> are exposed in that path.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">securityContext:</span> <span class="pre">&lt;config&gt;</span></code></dt><dd><p>Specifies the pod <a class="reference external" href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/">security context</a> with the given configuration.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">toleration:</span> <span class="pre">&lt;config&gt;</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 22.04.0.</span></p>
</div>
</dd>
<dd><p><em>Can be specified multiple times</em></p>
</dd>
<dd><p>Specifies the pod <a class="reference external" href="https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/">toleration</a> with the given configuration.</p>
</dd>
<dd><p>The configuration should be a map corresponding to a single toleration rule. For example, the following pod options:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">pod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>
<span class="w">    </span><span class="o">[</span><span class="nl">toleration:</span><span class="w"> </span><span class="o">[</span><span class="nl">key:</span><span class="w"> </span><span class="s1">&#39;key1&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">operator:</span><span class="w"> </span><span class="s1">&#39;Equal&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">value:</span><span class="w"> </span><span class="s1">&#39;value1&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">effect:</span><span class="w"> </span><span class="s1">&#39;NoSchedule&#39;</span><span class="o">]],</span>
<span class="w">    </span><span class="o">[</span><span class="nl">toleration:</span><span class="w"> </span><span class="o">[</span><span class="nl">key:</span><span class="w"> </span><span class="s1">&#39;key1&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">operator:</span><span class="w"> </span><span class="s1">&#39;Exists&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">effect:</span><span class="w"> </span><span class="s1">&#39;NoSchedule&#39;</span><span class="o">]],</span>
<span class="o">]</span>
</pre></div>
</div>
<p>Maps to the following pod spec:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tolerations</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;key1&quot;</span>
<span class="w">    </span><span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Equal&quot;</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value1&quot;</span>
<span class="w">    </span><span class="nt">effect</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NoSchedule&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;key1&quot;</span>
<span class="w">    </span><span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Exists&quot;</span>
<span class="w">    </span><span class="nt">effect</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NoSchedule&quot;</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">volumeClaim:</span> <span class="pre">'&lt;name&gt;',</span> <span class="pre">mountPath:</span> <span class="pre">'&lt;/absolute/path&gt;'</span> <span class="pre">[,</span> <span class="pre">subPath:</span> <span class="pre">'&lt;path&gt;',</span> <span class="pre">readOnly:</span> <span class="pre">true</span> <span class="pre">|</span> <span class="pre">false]</span></code></dt><dd><p><em>Can be specified multiple times</em></p>
</dd>
<dd><p>Mounts a <a class="reference external" href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">Persistent volume claim</a> with the given name to the given path.</p>
</dd>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">subPath</span></code> option can be used to mount a sub-directory of the volume instead of its root.</p>
</dd>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">readOnly</span></code> option can be used to mount the volume as read-only (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>)</p>
</dd>
</dl>
</section>
<section id="publishdir">
<span id="process-publishdir"></span><h3>publishDir<a class="headerlink" href="#publishdir" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">publishDir</span></code> directive allows you to publish the process output files to a specified folder. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">publishDir</span><span class="w"> </span><span class="s1">&#39;/data/chunks&#39;</span>

<span class="w">    </span><span class="nl">output:</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;chunk_*&#39;</span>

<span class="w">    </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    printf &#39;Hola&#39; | split -b 1 - chunk_</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The above example splits the string <code class="docutils literal notranslate"><span class="pre">Hola</span></code> into file chunks of a single byte. When complete the <code class="docutils literal notranslate"><span class="pre">chunk_*</span></code> output files are published into the <code class="docutils literal notranslate"><span class="pre">/data/chunks</span></code> folder.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only files that match the declaration in the <code class="docutils literal notranslate"><span class="pre">output</span></code> block are published, not all the outputs of the process.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <code class="docutils literal notranslate"><span class="pre">publishDir</span></code> directive can be specified more than once in order to publish output files to different target directories based on different rules.</p>
</div>
<p>By default files are published to the target folder creating a <em>symbolic link</em> for each process output that links the file produced into the process working directory. This behavior can be modified using the <code class="docutils literal notranslate"><span class="pre">mode</span></code> option, for example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">publishDir</span><span class="w"> </span><span class="s1">&#39;/data/chunks&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">mode:</span><span class="w"> </span><span class="s1">&#39;copy&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">overwrite:</span><span class="w"> </span><span class="kc">false</span>

<span class="w">    </span><span class="nl">output:</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;chunk_*&#39;</span>

<span class="w">    </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    printf &#39;Hola&#39; | split -b 1 - chunk_</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Files are copied into the specified directory in an <em>asynchronous</em> manner, so they may not be immediately available in the publish directory at the end of the process execution. For this reason, downstream processes should not try to access output files through the publish directory, but through channels.</p>
</div>
<p>Available options:</p>
<dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">contentType</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 22.10.0.</span></p>
</div>
</dd>
<dd><p><em>Experimental: currently only supported for S3.</em></p>
</dd>
<dd><p>Allow specifying the media content type of the published file a.k.a. <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_Types">MIME type</a>. If set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, the content type is inferred from the file extension (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">enabled</span></code></dt><dd><p>Enable or disable the publish rule depending on the boolean value specified (default: <code class="docutils literal notranslate"><span class="pre">true</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">failOnError</span></code></dt><dd><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> abort the execution if some file canât be published to the specified target directory or bucket for any cause (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">mode</span></code></dt><dd><p>The file publishing method. Can be one of the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'copy'</span></code>: Copies the output files into the publish directory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'copyNoFollow'</span></code>: Copies the output files into the publish directory without following symlinks ie. copies the links themselves.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'link'</span></code>: Creates a hard link in the publish directory for each output file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'move'</span></code>: Moves the output files into the publish directory. <strong>Note</strong>: this is only supposed to be used for a <em>terminal</em> process i.e. a process whose output is not consumed by any other downstream process.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rellink'</span></code>: Creates a relative symbolic link in the publish directory for each output file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'symlink'</span></code>: Creates an absolute symbolic link in the publish directory for each output file (default).</p></li>
</ul>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">overwrite</span></code></dt><dd><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> any existing file in the specified folder will be overridden (default: <code class="docutils literal notranslate"><span class="pre">true</span></code> during normal pipeline execution and <code class="docutils literal notranslate"><span class="pre">false</span></code> when pipeline execution is <code class="docutils literal notranslate"><span class="pre">resumed</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">path</span></code></dt><dd><p>Specifies the directory where files need to be published. <strong>Note</strong>: the syntax <code class="docutils literal notranslate"><span class="pre">publishDir</span> <span class="pre">'/some/dir'</span></code> is a shortcut for <code class="docutils literal notranslate"><span class="pre">publishDir</span> <span class="pre">path:</span> <span class="pre">'/some/dir'</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pattern</span></code></dt><dd><p>Specifies a <a class="reference external" href="http://docs.oracle.com/javase/tutorial/essential/io/fileOps.html#glob">glob</a> file pattern that selects which files to publish from the overall set of output files.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">saveAs</span></code></dt><dd><p>A closure which, given the name of the file being published, returns the actual file name or a full path where the file is required to be stored. This can be used to rename or change the destination directory of the published files dynamically by using a custom strategy. Return the value <code class="docutils literal notranslate"><span class="pre">null</span></code> from the closure to <em>not</em> publish a file. This is useful when the process has multiple output files, but you want to publish only some of them.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">storageClass</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 22.12.0-edge.</span></p>
</div>
</dd>
<dd><p><em>Experimental: currently only supported for S3.</em></p>
</dd>
<dd><p>Allow specifying the storage class to be used for the published file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">tags</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 21.12.0-edge.</span></p>
</div>
</dd>
<dd><p><em>Experimental: currently only supported for S3.</em></p>
</dd>
<dd><p>Allow the association of arbitrary tags with the published file e.g. <code class="docutils literal notranslate"><span class="pre">tags:</span> <span class="pre">[FOO:</span> <span class="pre">'Hello</span> <span class="pre">world']</span></code>.</p>
</dd>
</dl>
</section>
<section id="queue">
<span id="process-queue"></span><h3>queue<a class="headerlink" href="#queue" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">queue</span></code> directive allows you to set the <code class="docutils literal notranslate"><span class="pre">queue</span></code> where jobs are scheduled when using a grid based executor in your pipeline. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">grid_job</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">queue</span><span class="w"> </span><span class="s1">&#39;long&#39;</span>
<span class="w">    </span><span class="n">executor</span><span class="w"> </span><span class="s1">&#39;sge&#39;</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    your task script here</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Multiple queues can be specified by separating their names with a comma for example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">grid_job</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">queue</span><span class="w"> </span><span class="s1">&#39;short,long,cn-el6&#39;</span>
<span class="w">    </span><span class="n">executor</span><span class="w"> </span><span class="s1">&#39;sge&#39;</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    your task script here</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This directive is only used by certain executors. Refer to the <a class="reference internal" href="executor.html#executor-page"><span class="std std-ref">Executors</span></a> page to see which executors support this directive.</p>
</div>
</section>
<section id="resourcelabels">
<span id="process-resourcelabels"></span><h3>resourceLabels<a class="headerlink" href="#resourcelabels" title="Permalink to this heading">ï</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 22.09.1-edge.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">resourceLabels</span></code> directive allows you to specify custom name-value pairs that Nextflow applies to the computing resource used to carry out the process execution. Resource labels can be specified using the syntax shown below:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">my_task</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">resourceLabels</span><span class="w"> </span><span class="nl">region:</span><span class="w"> </span><span class="s1">&#39;some-region&#39;</span><span class="o">,</span><span class="w"> </span><span class="nl">user:</span><span class="w"> </span><span class="s1">&#39;some-username&#39;</span>

<span class="w">    </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    &lt;task script&gt;</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The limits and the syntax of the corresponding cloud provider should be taken into consideration when using resource labels.</p>
<p>Resource labels are currently supported by the following executors:</p>
<ul class="simple">
<li><p><a class="reference internal" href="executor.html#awsbatch-executor"><span class="std std-ref">AWS Batch</span></a></p></li>
<li><p><a class="reference internal" href="executor.html#azurebatch-executor"><span class="std std-ref">Azure Batch</span></a></p></li>
<li><p><a class="reference internal" href="executor.html#google-batch-executor"><span class="std std-ref">Google Cloud Batch</span></a></p></li>
<li><p><a class="reference internal" href="executor.html#google-lifesciences-executor"><span class="std std-ref">Google Life Sciences</span></a></p></li>
<li><p><a class="reference internal" href="executor.html#k8s-executor"><span class="std std-ref">Kubernetes</span></a></p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version 23.09.0-edge: </span>Resource labels are supported for Azure Batch when using automatic pool creation.</p>
<p>Resource labels in Azure are added to pools, rather than jobs, in order to facilitate cost analysis. A new pool will be created for each new set of resource labels, therefore it is recommended to also set <code class="docutils literal notranslate"><span class="pre">azure.batch.deletePoolsOnCompletion</span> <span class="pre">=</span> <span class="pre">true</span></code> when using process-specific resource labels.</p>
</div>
<p>See also: <a class="reference internal" href="#label"><span class="std std-doc">label</span></a></p>
</section>
<section id="scratch">
<span id="process-scratch"></span><h3>scratch<a class="headerlink" href="#scratch" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">scratch</span></code> directive allows you to execute the process in a temporary folder that is local to the execution node.</p>
<p>This is useful when your pipeline is launched by using a grid executor, because it allows you to decrease the NFS overhead by running the pipeline processes in a temporary directory in the local disk of the actual execution node. Only the files declared as output in the process definition will be copied in the pipeline working area.</p>
<p>In its basic form simply specify <code class="docutils literal notranslate"><span class="pre">true</span></code> at the directive value, as shown below:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">simpleTask</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">scratch</span><span class="w"> </span><span class="kc">true</span>

<span class="w">  </span><span class="nl">output:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;data_out&#39;</span>

<span class="w">  </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">  &lt;task script&gt;</span>
<span class="s1">  &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>By doing this, it tries to execute the script in the directory defined by the variable <code class="docutils literal notranslate"><span class="pre">$TMPDIR</span></code> in the execution node. If this variable does not exist, it will create a new temporary directory by using the Linux command <code class="docutils literal notranslate"><span class="pre">mktemp</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Cloud-based executors use <code class="docutils literal notranslate"><span class="pre">scratch</span> <span class="pre">=</span> <span class="pre">true</span></code> by default, since the work directory resides in object storage.</p>
</div>
<p>The following values are supported:</p>
<dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">false</span></code></dt><dd><p>Do not use a scratch directory.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">true</span></code></dt><dd><p>Create a scratch directory in the directory defined by the <code class="docutils literal notranslate"><span class="pre">$TMPDIR</span></code> environment variable, or <code class="docutils literal notranslate"><span class="pre">$(mktemp</span> <span class="pre">/tmp)</span></code> if <code class="docutils literal notranslate"><span class="pre">$TMPDIR</span></code> is not set.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'$YOUR_VAR'</span></code></dt><dd><p>Create a scratch directory in the directory defined by the given environment variable, or <code class="docutils literal notranslate"><span class="pre">$(mktemp</span> <span class="pre">/tmp)</span></code> if that variable is not set. The value must use single quotes, otherwise the environment variable will be evaluated in the pipeline script context.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'/my/tmp/path'</span></code></dt><dd><p>Create a scratch directory in the specified directory.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'ram-disk'</span></code></dt><dd><p>Create a scratch directory in the RAM disk <code class="docutils literal notranslate"><span class="pre">/dev/shm/</span></code>.</p>
</dd>
</dl>
</section>
<section id="process-directive-shell">
<span id="id1"></span><h3>shell<a class="headerlink" href="#process-directive-shell" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">shell</span></code> directive allows you to define a custom shell command for process scripts. By default, script blocks are executed with <code class="docutils literal notranslate"><span class="pre">/bin/bash</span> <span class="pre">-ue</span></code>.</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">doMoreThings</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">shell</span><span class="w"> </span><span class="s1">&#39;/bin/bash&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;-euo&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;pipefail&#39;</span>

<span class="w">    </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    your_command_here</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The same directive could be specified in your Nextflow configuration as follows:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="o">.</span><span class="na">shell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;/bin/bash&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;-euo&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;pipefail&#39;</span><span class="o">]</span>
</pre></div>
</div>
</section>
<section id="spack">
<span id="process-spack"></span><h3>spack<a class="headerlink" href="#spack" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">spack</span></code> directive allows for the definition of the process dependencies using the <a class="reference external" href="https://spack.io">Spack</a> package manager.</p>
<p>Nextflow automatically sets up an environment for the given package names listed by in the <code class="docutils literal notranslate"><span class="pre">spack</span></code> directive. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">spack</span><span class="w"> </span><span class="s1">&#39;bwa@0.7.15&#39;</span>

<span class="w">    </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    your_command --here</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Multiple packages can be specified separating them with a blank space, e.g. <code class="docutils literal notranslate"><span class="pre">bwa&#64;0.7.15</span> <span class="pre">fastqc&#64;0.11.5</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">spack</span></code> directive also allows the specification of a Spack environment file path or the path of an existing environment directory. See the <a class="reference internal" href="spack.html#spack-page"><span class="std std-ref">Spack environments</span></a> page for further details.</p>
</section>
<section id="stageinmode">
<span id="process-stageinmode"></span><h3>stageInMode<a class="headerlink" href="#stageinmode" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">stageInMode</span></code> directive defines how input files are staged into the process work directory. The following values are allowed:</p>
<dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">'copy'</span></code></dt><dd><p>Input files are staged in the process work directory by creating a copy.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'link'</span></code></dt><dd><p>Input files are staged in the process work directory by creating a hard link for each of them.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'rellink'</span></code></dt><dd><p>Input files are staged in the process work directory by creating a symbolic link with a relative path for each of them.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'symlink'</span></code></dt><dd><p>Input files are staged in the process work directory by creating a symbolic link with an absolute path for each of them (default).</p>
</dd>
</dl>
</section>
<section id="stageoutmode">
<span id="process-stageoutmode"></span><h3>stageOutMode<a class="headerlink" href="#stageoutmode" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">stageOutMode</span></code> directive defines how output files are staged out from the scratch directory to the process work directory. The following values are allowed:</p>
<dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">'copy'</span></code></dt><dd><p>Output files are copied from the scratch directory to the work directory.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'fcp'</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 23.02.0-edge.</span></p>
</div>
</dd>
<dd><p>Output files are copied from the scratch directory to the work directory by using the <a class="reference external" href="https://github.com/Svetlitski/fcp">fcp</a> utility (note: it must be available in your cluster computing nodes).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'move'</span></code></dt><dd><p>Output files are moved from the scratch directory to the work directory.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'rclone'</span></code></dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 23.01.0-edge.</span></p>
</div>
</dd>
<dd><p>Output files are copied from the scratch directory to the work directory by using the <a class="reference external" href="https://rclone.org">rclone</a> utility (note: it must be available in your cluster computing nodes).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'rsync'</span></code></dt><dd><p>Output files are copied from the scratch directory to the work directory by using the <code class="docutils literal notranslate"><span class="pre">rsync</span></code> utility.</p>
</dd>
</dl>
<p>See also: <a class="reference internal" href="#scratch"><span class="std std-doc">scratch</span></a>.</p>
</section>
<section id="storedir">
<span id="process-storedir"></span><h3>storeDir<a class="headerlink" href="#storedir" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">storeDir</span></code> directive allows you to define a directory that is used as a <em>permanent</em> cache for your process results.</p>
<p>In more detail, it affects the process execution in two main ways:</p>
<ol class="arabic simple">
<li><p>The process is executed only if the files declared in the <code class="docutils literal notranslate"><span class="pre">output</span></code> block do not exist in the directory specified by the <code class="docutils literal notranslate"><span class="pre">storeDir</span></code> directive. When the files exist the process execution is skipped and these files are used as the actual process result.</p></li>
<li><p>Whenever a process is successfully completed the files listed in the <code class="docutils literal notranslate"><span class="pre">output</span></code> block are moved into the directory specified by the <code class="docutils literal notranslate"><span class="pre">storeDir</span></code> directive.</p></li>
</ol>
<p>The following example shows how to use the <code class="docutils literal notranslate"><span class="pre">storeDir</span></code> directive to create a directory containing a BLAST database for each species specified by an input parameter:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">formatBlastDatabases</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">storeDir</span><span class="w"> </span><span class="s1">&#39;/db/genomes&#39;</span>

<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="n">species</span>

<span class="w">  </span><span class="nl">output:</span>
<span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="s2">&quot;${dbName}.*&quot;</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="n">dbName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">species</span><span class="o">.</span><span class="na">baseName</span>
<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  makeblastdb -dbtype nucl -in ${species} -out ${dbName}</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">storeDir</span></code> directive is meant for long-term process caching and should not be used to publish output files or organize outputs into a semantic directory structure. In those cases, use the <a class="reference internal" href="#publishdir"><span class="std std-doc">publishDir</span></a> directive instead.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The use of AWS S3 paths is supported, however it requires the installation of the <a class="reference external" href="https://aws.amazon.com/cli/">AWS CLI</a> (i.e. <code class="docutils literal notranslate"><span class="pre">aws</span></code>) in the target compute node.</p>
</div>
</section>
<section id="tag">
<span id="process-tag"></span><h3>tag<a class="headerlink" href="#tag" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">tag</span></code> directive allows you to associate each process execution with a custom label, so that it will be easier to identify them in the log file or in the trace execution report. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">tag</span><span class="w"> </span><span class="s2">&quot;$code&quot;</span>

<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">code</span>

<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  echo $code</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>

<span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">Channel</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s1">&#39;alpha&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;gamma&#39;</span><span class="o">,</span><span class="w"> </span><span class="s1">&#39;omega&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">foo</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The above snippet will print a log similar to the following one, where process names contain the tag value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">6</span><span class="n">e</span><span class="o">/</span><span class="mi">28919</span><span class="n">b</span><span class="p">]</span> <span class="n">Submitted</span> <span class="n">process</span> <span class="o">&gt;</span> <span class="n">foo</span> <span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
<span class="p">[</span><span class="n">d2</span><span class="o">/</span><span class="mi">1</span><span class="n">c6175</span><span class="p">]</span> <span class="n">Submitted</span> <span class="n">process</span> <span class="o">&gt;</span> <span class="n">foo</span> <span class="p">(</span><span class="n">gamma</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="n">c</span><span class="o">/</span><span class="mi">3</span><span class="n">ef220</span><span class="p">]</span> <span class="n">Submitted</span> <span class="n">process</span> <span class="o">&gt;</span> <span class="n">foo</span> <span class="p">(</span><span class="n">omega</span><span class="p">)</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="tracing.html#trace-report"><span class="std std-ref">Trace execution report</span></a></p>
</section>
<section id="time">
<span id="process-time"></span><h3>time<a class="headerlink" href="#time" title="Permalink to this heading">ï</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">time</span></code> directive allows you to define how long a process is allowed to run. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">big_job</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">time</span><span class="w"> </span><span class="s1">&#39;1h&#39;</span>

<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    your task script here</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The following time unit suffixes can be used when specifying the duration value:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms</span></code>, <code class="docutils literal notranslate"><span class="pre">milli</span></code>, <code class="docutils literal notranslate"><span class="pre">millis</span></code></p></td>
<td><p>Milliseconds</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">s</span></code>, <code class="docutils literal notranslate"><span class="pre">sec</span></code>, <code class="docutils literal notranslate"><span class="pre">second</span></code>, <code class="docutils literal notranslate"><span class="pre">seconds</span></code></p></td>
<td><p>Seconds</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">m</span></code>, <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">minute</span></code>, <code class="docutils literal notranslate"><span class="pre">minutes</span></code></p></td>
<td><p>Minutes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">h</span></code>, <code class="docutils literal notranslate"><span class="pre">hour</span></code>, <code class="docutils literal notranslate"><span class="pre">hours</span></code></p></td>
<td><p>Hours</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">day</span></code>, <code class="docutils literal notranslate"><span class="pre">days</span></code></p></td>
<td><p>Days</p></td>
</tr>
</tbody>
</table>
<p>Multiple units can be used in a single declaration, for example: <code class="docutils literal notranslate"><span class="pre">'1day</span> <span class="pre">6hours</span> <span class="pre">3minutes</span> <span class="pre">30seconds'</span></code></p>
<p>See <a class="reference internal" href="script.html#implicit-classes-duration"><span class="std std-ref">Duration</span></a> for more information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This directive is only used by certain executors. Refer to the <a class="reference internal" href="executor.html#executor-page"><span class="std std-ref">Executors</span></a> page to see which executors support this directive.</p>
</div>
<p>See also: <a class="reference internal" href="#cpus"><span class="std std-doc">cpus</span></a>, <a class="reference internal" href="#memory"><span class="std std-doc">memory</span></a>, <a class="reference internal" href="#queue"><span class="std std-doc">queue</span></a> and <a class="reference internal" href="#dynamic-computing-resources"><span class="std std-doc">Dynamic computing resources</span></a>.</p>
</section>
<section id="dynamic-directives">
<h3>Dynamic directives<a class="headerlink" href="#dynamic-directives" title="Permalink to this heading">ï</a></h3>
<p>A directive can be assigned <em>dynamically</em>, during the process execution, so that its actual value can be evaluated based on the process inputs.</p>
<p>In order to be defined in a dynamic manner, the directiveâs value needs to be expressed using a <a class="reference internal" href="script.html#script-closure"><span class="std std-ref">closure</span></a>, as in the following example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">executor</span><span class="w"> </span><span class="s1">&#39;sge&#39;</span>
<span class="w">  </span><span class="n">queue</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;long&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;short&#39;</span><span class="w"> </span><span class="o">}</span>

<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">tuple</span><span class="w"> </span><span class="n">val</span><span class="o">(</span><span class="n">entries</span><span class="o">),</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="s1">&#39;data.txt&#39;</span><span class="o">)</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  &lt; your job here &gt;</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, the <a class="reference internal" href="#queue"><span class="std std-doc">queue</span></a> directive is evaluated dynamically, depending on the input value <code class="docutils literal notranslate"><span class="pre">entries</span></code>. When it is larger than 100, jobs will be submitted to the <code class="docutils literal notranslate"><span class="pre">long</span></code> queue, otherwise the <code class="docutils literal notranslate"><span class="pre">short</span></code> queue will be used.</p>
<p>All directives can be assigned a dynamic value except the following:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#executor"><span class="std std-doc">executor</span></a></p></li>
<li><p><a class="reference internal" href="#label"><span class="std std-doc">label</span></a></p></li>
<li><p><a class="reference internal" href="#maxforks"><span class="std std-doc">maxForks</span></a></p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Assigning a string value with one or more variables is always resolved in a dynamic manner, and therefore is equivalent to the above syntax. For example, the above directive can also be written as:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">queue</span><span class="w"> </span><span class="s2">&quot;${ entries &gt; 100 ? &#39;long&#39; : &#39;short&#39; }&quot;</span>
</pre></div>
</div>
<p>Note, however, that the latter syntax can be used both for a directiveâs main argument (as in the above example) and for a directiveâs optional named attributes, whereas the closure syntax is only resolved dynamically for a directiveâs main argument.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can retrieve the current value of a dynamic directive in the process script by using the implicit variable <code class="docutils literal notranslate"><span class="pre">task</span></code>, which holds the directive values defined in the current task. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">queue</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;long&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;short&#39;</span><span class="w"> </span><span class="o">}</span>

<span class="w">  </span><span class="nl">input:</span>
<span class="w">  </span><span class="n">tuple</span><span class="w"> </span><span class="n">val</span><span class="o">(</span><span class="n">entries</span><span class="o">),</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="s1">&#39;data.txt&#39;</span><span class="o">)</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  echo Current queue: ${task.queue}</span>
<span class="s2">  &quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</section>
<section id="dynamic-computing-resources">
<h3>Dynamic computing resources<a class="headerlink" href="#dynamic-computing-resources" title="Permalink to this heading">ï</a></h3>
<p>Itâs a very common scenario that different instances of the same process may have very different needs in terms of computing resources. In such situations requesting, for example, an amount of memory too low will cause some tasks to fail. Instead, using a higher limit that fits all the tasks in your execution could significantly decrease the execution priority of your jobs.</p>
<p>The <a class="reference internal" href="#dynamic-directives"><span class="std std-doc">Dynamic directives</span></a> evaluation feature can be used to modify the amount of computing resources requested in case of a process failure and try to re-execute it using a higher limit. For example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">memory</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="mi">2</span><span class="o">.</span><span class="na">GB</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">task</span><span class="o">.</span><span class="na">attempt</span><span class="w"> </span><span class="o">}</span>
<span class="w">    </span><span class="n">time</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="na">hour</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">task</span><span class="o">.</span><span class="na">attempt</span><span class="w"> </span><span class="o">}</span>

<span class="w">    </span><span class="n">errorStrategy</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">task</span><span class="o">.</span><span class="na">exitStatus</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">137</span><span class="o">..</span><span class="mi">140</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;retry&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;terminate&#39;</span><span class="w"> </span><span class="o">}</span>
<span class="w">    </span><span class="n">maxRetries</span><span class="w"> </span><span class="mi">3</span>

<span class="w">    </span><span class="nl">script:</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">your</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="n">here</span><span class="o">&gt;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example the <a class="reference internal" href="#memory"><span class="std std-doc">memory</span></a> and execution <a class="reference internal" href="#time"><span class="std std-doc">time</span></a> limits are defined dynamically. The first time the process is executed the <code class="docutils literal notranslate"><span class="pre">task.attempt</span></code> is set to <code class="docutils literal notranslate"><span class="pre">1</span></code>, thus it will request a two GB of memory and one hour of maximum execution time.</p>
<p>If the task execution fail reporting an exit status in the range between 137 and 140, the task is re-submitted (otherwise terminates immediately). This time the value of <code class="docutils literal notranslate"><span class="pre">task.attempt</span></code> is <code class="docutils literal notranslate"><span class="pre">2</span></code>, thus increasing the amount of the memory to four GB and the time to 2 hours, and so on.</p>
<p>The directive <a class="reference internal" href="#maxretries"><span class="std std-doc">maxRetries</span></a> set the maximum number of time the same task can be re-executed.</p>
</section>
<section id="dynamic-retry-with-backoff">
<h3>Dynamic Retry with backoff<a class="headerlink" href="#dynamic-retry-with-backoff" title="Permalink to this heading">ï</a></h3>
<p>There are cases in which the required execution resources may be temporary unavailable e.g. network congestion. In these cases immediately re-executing the task will likely result in the identical error. A retry with an exponential backoff delay can better recover these error conditions:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="n">errorStrategy</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">sleep</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">pow</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="n">task</span><span class="o">.</span><span class="na">attempt</span><span class="o">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">long</span><span class="o">);</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;retry&#39;</span><span class="w"> </span><span class="o">}</span>
<span class="w">  </span><span class="n">maxRetries</span><span class="w"> </span><span class="mi">5</span>

<span class="w">  </span><span class="nl">script:</span>
<span class="w">  </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">  your_command --here</span>
<span class="s1">  &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="script.html" class="btn btn-neutral float-left" title="Scripts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="channel.html" class="btn btn-neutral float-right" title="Channels" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Seqera Labs, S.L.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
     
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TNCXSWG"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->


</body>
</html>